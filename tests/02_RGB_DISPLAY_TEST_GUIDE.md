# RGB 디스플레이 테스트 가이드

> **⚠️ 중요**: 이 가이드는 작업자가 단계별로 따라할 수 있도록 작성되었습니다. 각 단계를 순서대로 진행하세요.

## 📋 목차
1. [준비사항 확인](#준비사항-확인)
2. [하드웨어 연결](#하드웨어-연결)
3. [테스트 파일 업로드](#테스트-파일-업로드)
4. [테스트 실행](#테스트-실행)
5. [문제 해결](#문제-해결)
6. [완료 체크리스트](#완료-체크리스트)

---

## 🎯 준비사항 확인

### ✅ 필요한 하드웨어
- [ ] ESP32-C6 기반 PCB
- [ ] ST7735S 디스플레이 연결된 PCB
- [ ] USB 케이블
- [ ] 컴퓨터 (Windows 10/11)

### ✅ 필요한 소프트웨어
- [ ] Python 3.8 이상
- [ ] esptool, ampy 설치 완료
- [ ] PuTTY 설치 완료
- [ ] 최신 펌웨어 업로드 완료

### 📦 테스트 대상
- **ST7735S 디스플레이**: 128x160 픽셀 RGB 디스플레이
- **SPI 통신**: ESP32-C6와 디스플레이 간 통신
- **RGB 컬러 표시**: 다양한 색상으로 텍스트 표시
- **백라이트 제어**: 디스플레이 백라이트 켜기/끄기

---

## 🔌 하드웨어 연결

### 1단계: 연결 확인

1. **PCB 연결 상태 확인**
   - ESP32-C6와 ST7735S 디스플레이가 올바르게 연결되어 있는지 확인
   - 백라이트가 켜져 있는지 확인

2. **디스플레이 핀맵**
   - **CS**: GPIO 23
   - **SCL**: GPIO 22 (SPI Clock)
   - **SDA**: GPIO 21 (SPI MOSI)
   - **RES**: GPIO 20 (Reset)
   - **DC**: GPIO 19 (Data/Command)
   - **BLK**: GPIO 13 (Backlight) - **항상 HIGH로 설정**

3. **중요 사항**
   - BLK 핀은 테스트용으로만 GPIO를 사용하며, 실제 제품에서는 3.3V 전원에 직접 연결할 예정입니다.
   - SPI ID: 1
   - 디스플레이 크기: 128x160 픽셀

---

## 📤 테스트 파일 업로드

### 1단계: 테스트 파일 업로드

1. **명령 프롬프트 열기**
   - Windows 키 + R → `cmd` 입력 → Enter

2. **프로젝트 폴더로 이동**
   ```cmd
   cd C:\Users\outrobot\OneDrive\사업\아웃로봇\신성테크\소스코드_전달\pillBox
   ```

3. **테스트 파일 업로드**
   ```cmd
   ampy -p COM3 put .\tests\test_display_rgb_hello.py
   ```

   **⚠️ 중요**: `COM3`을 실제 COM 포트 번호로 변경하세요!

---

## 🧪 테스트 실행

### 1단계: PuTTY 연결

1. **PuTTY 실행**
   - PuTTY 실행 → Load → Open

2. **연결 확인**
   - MicroPython 프롬프트(`>>>`)가 나타나면 성공

### 2단계: 테스트 실행

1. **테스트 모듈 임포트 및 실행**
   ```python
   from test_display_rgb_hello import main
   main()
   ```

## RGB 컬러 정의

테스트에서 사용되는 RGB 컬러:
1. **빨강**: (255, 0, 0)
2. **초록**: (0, 255, 0)
3. **파랑**: (0, 0, 255)
4. **노랑**: (255, 255, 0)
5. **마젠타**: (255, 0, 255)
6. **시안**: (0, 255, 255)
7. **주황**: (255, 165, 0)
8. **보라**: (128, 0, 128)
9. **분홍**: (255, 192, 203)
10. **다크 그린**: (0, 128, 0)

## 테스트 기능

### 1. 글자별 색상 테스트
- "HELLO"의 각 글자를 순차적으로 다른 색으로 표시
- H → 빨강, E → 초록, L → 파랑, L → 노랑, O → 마젠타

### 2. 전체 색상 순환 테스트
- 전체 "HELLO" 텍스트가 모든 색상을 순환하며 표시
- 각 색상당 1초씩 표시

## 실행 방법

### MicroPython 환경에서
```python
# 간단한 테스트 실행
exec(open('simple_rgb_hello_test.py').read())

# 또는 고급 테스트 실행
exec(open('test_display_rgb_hello.py').read())
```

### 실행 스크립트 사용
```python
exec(open('run_rgb_test.py').read())
```

## 디스플레이 초기화 과정

1. **핀 설정**: CS, DC, RES, BLK 핀을 출력으로 설정
2. **SPI 설정**: 40MHz 속도로 SPI 통신 설정
3. **BLK 핀 HIGH**: 백라이트 항상 켜짐
4. **리셋**: RES 핀으로 디스플레이 리셋
5. **컬러 모드**: RGB565 모드 설정
6. **디스플레이 방향**: 세로 방향 설정
7. **주소 설정**: 컬럼/로우 주소 범위 설정
8. **디스플레이 켜기**: 디스플레이 활성화

## 폰트 정의

간단한 5x5 비트맵 폰트로 H, E, L, O 글자를 정의:
- 각 글자는 5x5 픽셀 크기
- 1은 픽셀 켜짐, 0은 픽셀 꺼짐
- 글자 간격은 1픽셀

## RGB565 컬러 변환

RGB888 (24비트) → RGB565 (16비트) 변환:
- Red: 8비트 → 5비트 (>> 3)
- Green: 8비트 → 6비트 (>> 2)
- Blue: 8비트 → 5비트 (>> 3)

## 문제 해결

### 디스플레이가 켜지지 않는 경우
1. BLK 핀이 HIGH로 설정되었는지 확인
2. 전원 연결 확인
3. SPI 핀 연결 확인

### 색상이 이상한 경우
1. RGB565 변환 함수 확인
2. 디스플레이 방향 설정 확인
3. 컬러 모드 설정 확인

### 글자가 보이지 않는 경우
1. 폰트 정의 확인
2. 좌표 설정 확인
3. 글자 크기 설정 확인

## 성능 최적화

- SPI 속도: 40MHz로 설정하여 빠른 화면 업데이트
- 픽셀 데이터 일괄 전송으로 효율성 향상
- 불필요한 화면 지우기 최소화

## 확장 가능성

- 더 많은 글자 추가 가능
- 애니메이션 효과 추가 가능
- 다양한 폰트 크기 지원 가능
- 그라데이션 효과 추가 가능



