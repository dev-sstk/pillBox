# PillBox í•˜ë“œì›¨ì–´ ì‚¬ì–‘ ë° í•€ë§µ

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [ESP32-C6 í•€ë§µ](#esp32-c6-í•€ë§µ)
3. [í•˜ë“œì›¨ì–´ ëª¨ë“ˆ](#í•˜ë“œì›¨ì–´-ëª¨ë“ˆ)
4. [í†µì‹  í”„ë¡œí† ì½œ](#í†µì‹ -í”„ë¡œí† ì½œ)
5. [ì „ì› ê´€ë¦¬](#ì „ì›-ê´€ë¦¬)
6. [íšŒë¡œ ì—°ê²°ë„](#íšŒë¡œ-ì—°ê²°ë„)
7. [í•˜ë“œì›¨ì–´ í…ŒìŠ¤íŠ¸](#í•˜ë“œì›¨ì–´-í…ŒìŠ¤íŠ¸)
8. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

---

## ê°œìš”

PillBoxëŠ” ESP32-C6 ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ ê¸°ë°˜ì˜ ìŠ¤ë§ˆíŠ¸ ì•Œì•½ ê³µê¸‰ê¸°ë¡œ, ë‹¤ìŒê³¼ ê°™ì€ í•˜ë“œì›¨ì–´ êµ¬ì„±ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

### ì£¼ìš” ì‚¬ì–‘
- **MCU**: ESP32-C6 (RISC-V, 160MHz, 512KB SRAM, 4MB Flash)
- **ë¬´ì„  í†µì‹ **: Wi-Fi 6 (802.11ax), Bluetooth 5.0 LE
- **ë””ìŠ¤í”Œë ˆì´**: ST7735S 1.8" TFT LCD (160Ã—128, RGB565)
- **ì…ë ¥**: 74HC165 ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„° (4ê°œ ë²„íŠ¼ + 4ê°œ ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜)
- **ëª¨í„°**: 28BYJ-48 ìŠ¤í…Œí¼ ëª¨í„° 4ê°œ (ULN2003A ë“œë¼ì´ë²„)
- **ì˜¤ë””ì˜¤**: MAX98357A I2S ì•°í”„
- **ì „ì›**: USB Type-C / Li-ion ë°°í„°ë¦¬ (MCP73831 ì¶©ì „ ê´€ë¦¬)

---

## ESP32-C6 í•€ë§µ

### ì „ì²´ í•€ í• ë‹¹í‘œ

| GPIO | ê¸°ëŠ¥ | ë°©í–¥ | ì—°ê²° ëŒ€ìƒ | í”„ë¡œí† ì½œ | ì„¤ëª… |
|------|------|------|-----------|----------|------|
| **ì…ì¶œë ¥ ì œì–´** |
| IO0 | DI | OUT | 74HC595D Data Input | GPIO | ëª¨í„° ì œì–´ìš© ë°ì´í„° ì…ë ¥ |
| IO1 | LED_PWR | OUT | Power LED | PWM | ì „ì› í‘œì‹œ LED |
| IO2 | SER (DI) | OUT | 74HC595D Serial Data | GPIO | ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„° ë°ì´í„° |
| IO3 | SH_CP / CLK | OUT | 74HC595/74HC165 ê³µìš© | GPIO | ì‹œí”„íŠ¸ í´ëŸ­ (ê³µìœ ) |
| **ì˜¤ë””ì˜¤ (I2S)** |
| IO5 | DIN | OUT | MAX98357A Data In | I2S | I2S ì˜¤ë””ì˜¤ ë°ì´í„° |
| IO6 | BCLK | OUT | MAX98357A Bit Clock | I2S | I2S ë¹„íŠ¸ í´ëŸ­ |
| IO7 | LRCLK | OUT | MAX98357A L/R Clock | I2S | I2S ì›Œë“œ ì…€ë ‰íŠ¸ |
| **ì…ë ¥** |
| IO9 | BOOT | IN | Boot Button | GPIO | ë¶€íŠ¸ ëª¨ë“œ ì„ íƒ |
| IO10 | DATA_OUT | IN | 74HC165 Q7 Output | GPIO | ë²„íŠ¼/ì„¼ì„œ ë°ì´í„° ì…ë ¥ |
| IO11 | PHOTO_OUT | IN | Photo Sensor | GPIO | í¬í†  ì„¼ì„œ ì…ë ¥ |
| **ì„œë³´ ëª¨í„°** |
| IO12 | SERVO1 | OUT | Servo Motor 1 | PWM | ì„œë³´ ëª¨í„° ì œì–´ 1 |
| IO13 | SERVO2 | OUT | Servo Motor 2 | PWM | ì„œë³´ ëª¨í„° ì œì–´ 2 |
| **ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„°** |
| IO15 | ST_CP / PL | OUT | 74HC595/74HC165 ê³µìš© | GPIO | ìŠ¤í† ë¦¬ì§€ í´ëŸ­/ë³‘ë ¬ ë¡œë“œ |
| **ê¸°íƒ€** |
| IO4 | BAT_AD | IN | Battery ADC | ADC | ë°°í„°ë¦¬ ì „ì•• ëª¨ë‹ˆí„°ë§ |
| IO8 | GPIO | I/O | General Purpose | GPIO | ë²”ìš© GPIO |
| IO18 | SOUND | OUT | Buzzer | PWM | ë¶€ì € ì¶œë ¥ |
| **ë””ìŠ¤í”Œë ˆì´ (SPI)** |
| IO14 | LCD_RES | OUT | ST7735S Reset | GPIO | ë””ìŠ¤í”Œë ˆì´ ë¦¬ì…‹ (ë¯¸ì‚¬ìš©) |
| IO19 | LCD_DC | OUT | ST7735S D/C | GPIO | ë°ì´í„°/ì»¤ë§¨ë“œ ì„ íƒ |
| IO20 | LCD_RES | OUT | ST7735S Reset | GPIO | ë””ìŠ¤í”Œë ˆì´ ë¦¬ì…‹ (ì‹¤ì œ ì‚¬ìš©) |
| IO21 | LCD_SDA (MOSI) | OUT | ST7735S SPI Data | SPI | SPI MOSI |
| IO22 | LCD_SCL (SCK) | OUT | ST7735S SPI Clock | SPI | SPI Clock |
| IO23 | LCD_CS | OUT | ST7735S Chip Select | GPIO | SPI ì¹© ì„ íƒ |
| **ì „ì› ë° ì ‘ì§€** |
| 3V3 | Power | - | 3.3V Power Supply | - | ì‹œìŠ¤í…œ ì „ì› |
| GND | Ground | - | Ground (Pin 1, 28, 29) | - | ì ‘ì§€ |
| EN | Enable | IN | Reset Control | - | ë¦¬ì…‹/ì¸ì—ì´ë¸” í•€ |

### í•€ ë°°ì¹˜ë„

```
ESP32-C6 DevKit C-1 (30 Pin)

     USB Type-C
         ||
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚              â”‚
1 â”‚ GND      GND â”‚ 30
2 â”‚ 3V3      GND â”‚ 29
3 â”‚ EN       GND â”‚ 28
4 â”‚ IO4      IO7 â”‚ 27  â† LRCLK
5 â”‚ IO5      IO6 â”‚ 26  â† BCLK
6 â”‚ NC       IO5 â”‚ 25  â† DIN
7 â”‚ NC       IO4 â”‚ 24  â† BAT_AD
8 â”‚ NC       IO3 â”‚ 23  â† SH_CP/CLK
9 â”‚ NC       IO2 â”‚ 22  â† DI
10â”‚ NC       IO1 â”‚ 21  â† LED_PWR
11â”‚ IO8      IO0 â”‚ 20  â† DI
12â”‚ IO9      IO15â”‚ 19  â† ST_CP/PL
13â”‚ IO10     IO18â”‚ 18  â† SOUND
14â”‚ IO11     NC  â”‚ 17
15â”‚ IO12     IO23â”‚ 16  â† LCD_CS
  â”‚              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¶”ê°€ í•€ (ì˜¤ë¥¸ìª½ í•˜ë‹¨ë¶€):
IO13, IO14, IO19, IO20, IO21, IO22
```

---

## í•˜ë“œì›¨ì–´ ëª¨ë“ˆ

### 1. ë””ìŠ¤í”Œë ˆì´ (ST7735S)

**ì‚¬ì–‘:**
- í¬ê¸°: 1.8ì¸ì¹˜ TFT LCD
- í•´ìƒë„: 160Ã—128 í”½ì…€
- ìƒ‰ìƒ: 65K (RGB565)
- ì¸í„°í˜ì´ìŠ¤: SPI
- ëª¨ë¸: MSP1804 (blacktab)

**í•€ ì—°ê²°:**
```
ST7735S        ESP32-C6      ì„¤ëª…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VCC            3.3V          ì „ì›
GND            GND           ì ‘ì§€
CS             IO23          ì¹© ì„ íƒ (Active LOW)
RST            IO20          ë¦¬ì…‹ (Active LOW)
DC             IO19          ë°ì´í„°/ì»¤ë§¨ë“œ (HIGH=Data, LOW=Command)
SDA (MOSI)     IO21          SPI ë°ì´í„°
SCL (SCK)      IO22          SPI í´ëŸ­
LED            3.3V          ë°±ë¼ì´íŠ¸ (PWM ê°€ëŠ¥)
```

**SPI ì„¤ì •:**
- ë²„ìŠ¤: SPI1
- ì†ë„: 40MHz
- ëª¨ë“œ: CPOL=0, CPHA=0 (Mode 0)
- ë¹„íŠ¸ ìˆœì„œ: MSB First
- íšŒì „: 3 (180ë„)
- ì˜¤í”„ì…‹: X=1, Y=2

**ì†Œí”„íŠ¸ì›¨ì–´ ë“œë¼ì´ë²„:**
- íŒŒì¼: `st77xx.py`
- í´ë˜ìŠ¤: `St7735`
- LVGL í†µí•©: ìë™ í”ŒëŸ¬ì‹œ ì½œë°±

### 2. ë²„íŠ¼ ì…ë ¥ (74HC165)

**ì‚¬ì–‘:**
- IC: SN74HC165 (8ë¹„íŠ¸ ë³‘ë ¬ â†’ ì§ë ¬ ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„°)
- ì…ë ¥: 8ê°œ ë””ì§€í„¸ ì…ë ¥ (Active LOW)
- ì¶œë ¥: ì§ë ¬ ë°ì´í„° (Q7)
- Pull-up: ë‚´ë¶€ 10kÎ©

**í•€ ì—°ê²°:**
```
74HC165        ESP32-C6      ì„¤ëª…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VCC            3.3V          ì „ì›
GND            GND           ì ‘ì§€
CLK            IO3           ì‹œí”„íŠ¸ í´ëŸ­ (74HC595ì™€ ê³µìœ )
PL (SH/LD)     IO15          ë³‘ë ¬ ë¡œë“œ (Active LOW)
Q7             IO10          ì§ë ¬ ë°ì´í„° ì¶œë ¥
```

**ì…ë ¥ ë§¤í•‘:**
```
74HC165 í•€    ì…ë ¥ ì¥ì¹˜           ë…¼ë¦¬ ë²„íŠ¼    ì—­í• 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
D0 (Pin 11)   SW1 (Menu)          Button C     ë©”ë‰´/ë’¤ë¡œê°€ê¸°
D1 (Pin 12)   SW2 (Select)        Button D     ì„ íƒ/ë‹¤ìŒ
D2 (Pin 13)   SW3 (Up)            Button A     ìœ„/ì¦ê°€
D3 (Pin 14)   SW4 (Down)          Button B     ì•„ë˜/ê°ì†Œ
D4 (Pin 3)    LIMIT SW3           -            ëª¨í„° 2 ì›ì  (ì—­ìˆœ)
D5 (Pin 4)    LIMIT SW2           -            ëª¨í„° 1 ì›ì 
D6 (Pin 5)    LIMIT SW1           -            ëª¨í„° 0 ì›ì  (ì—­ìˆœ)
D7 (Pin 6)    LIMIT SW4           -            ëª¨í„° 3 ì›ì 
```

**ë™ì‘ ì›ë¦¬:**
1. PLì„ LOWë¡œ ì„¤ì • â†’ 8ê°œ ë³‘ë ¬ ì…ë ¥ ë˜ì¹˜
2. PLì„ HIGHë¡œ ë³µêµ¬
3. CLK ìƒìŠ¹ ì—£ì§€ë§ˆë‹¤ 1ë¹„íŠ¸ì”© Q7ìœ¼ë¡œ ì¶œë ¥
4. 8ë²ˆ í´ëŸ­ â†’ 8ë¹„íŠ¸ ë°ì´í„° ì™„ì „ ì½ê¸°

**ì†Œí”„íŠ¸ì›¨ì–´ ë“œë¼ì´ë²„:**
- íŒŒì¼: `button_interface.py`
- í´ë˜ìŠ¤: `ButtonInterface`
- í´ë§ ì£¼ê¸°: 10ms
- ë””ë°”ìš´ì‹±: 50ms

### 3. ëª¨í„° ì œì–´ (74HC595 + ULN2003A)

**êµ¬ì„±:**
- ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„°: SN74HC595D Ã— 2ê°œ (ì§ë ¬ â†’ ë³‘ë ¬)
- ëª¨í„° ë“œë¼ì´ë²„: ULN2003A Ã— 4ê°œ
- ìŠ¤í…Œí¼ ëª¨í„°: 28BYJ-48 Ã— 4ê°œ

**74HC595D í•€ ì—°ê²°:**
```
74HC595 #1     ESP32-C6      ì„¤ëª…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VCC            3.3V          ì „ì›
GND            GND           ì ‘ì§€
SER (DS)       IO2           ì§ë ¬ ë°ì´í„° ì…ë ¥
SRCLK (SHCP)   IO3           ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„° í´ëŸ­ (74HC165ì™€ ê³µìœ )
RCLK (STCP)    IO15          ìŠ¤í† ë¦¬ì§€ ë ˆì§€ìŠ¤í„° í´ëŸ­ (ë˜ì¹˜)
OE             GND           ì¶œë ¥ ì¸ì—ì´ë¸” (Always ON)
SRCLR          3.3V          ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„° í´ë¦¬ì–´ (Always HIGH)
Q7'            SER of #2     ë‹¤ìŒ ì¹©ìœ¼ë¡œ ìºìŠ¤ì¼€ì´ë“œ
Q0-Q3          Motor 0       ëª¨í„° 0 ì œì–´ ì‹ í˜¸ (1B,2B,3B,4B)
Q4-Q7          Motor 1       ëª¨í„° 1 ì œì–´ ì‹ í˜¸ (1B,2B,3B,4B)

74HC595 #2     ì—°ê²°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SER (DS)       Q7' of #1     ì´ì „ ì¹©ì—ì„œ ìºìŠ¤ì¼€ì´ë“œ
SRCLK (SHCP)   IO3           ê³µìœ 
RCLK (STCP)    IO15          ê³µìœ 
Q0-Q3          Motor 2       ëª¨í„° 2 ì œì–´ ì‹ í˜¸ (1B,2B,3B,4B)
Q4-Q7          Motor 3       ëª¨í„° 3 ì œì–´ ì‹ í˜¸ (1B,2B,3B,4B)
```

**ULN2003A ì—°ê²°:**
```
ê° ëª¨í„°ë‹¹ 1ê°œì˜ ULN2003A ì‚¬ìš©

74HC595 â†’ ULN2003A â†’ 28BYJ-48
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Qx (Bit 0)  â†’ 1B â†’ 1C â†’ Coil A (Orange)
Qx (Bit 1)  â†’ 2B â†’ 2C â†’ Coil B (Yellow)
Qx (Bit 2)  â†’ 3B â†’ 3C â†’ Coil C (Pink)
Qx (Bit 3)  â†’ 4B â†’ 4C â†’ Coil D (Blue)

28BYJ-48 5í•€ ì»¤ë„¥í„°:
Pin 1: Coil A (Orange)
Pin 2: Coil B (Yellow)
Pin 3: VCC (Red) - 5V
Pin 4: Coil C (Pink)
Pin 5: Coil D (Blue)
```

**28BYJ-48 ìŠ¤í…Œí¼ ëª¨í„° ì‚¬ì–‘:**
- íƒ€ì…: ìœ ë‹ˆí´ë¼ ìŠ¤í…Œí¼ ëª¨í„°
- ì „ì••: 5V DC
- ìŠ¤í… ê°ë„: 5.625Â° (ê¸°ì–´ë¹„ ì „)
- ê¸°ì–´ë¹„: 1:64
- ì‹¤ì œ ìŠ¤í… ê°ë„: 0.087890625Â° (5.625Â° Ã· 64)
- í•œ ë°”í€´ ìŠ¤í… ìˆ˜: 4096 ìŠ¤í… (ì •í™•: 4095.9)
- ìŠ¤í… ëª¨ë“œ: 8ìŠ¤í… Half Step (ë” ë¶€ë“œëŸ¬ìš´ ë™ì‘)
- í† í¬: ~300 gfÂ·cm
- RPM: ~15 (ìµœëŒ€ ì†ë„)

**ìŠ¤í… ì‹œí€€ìŠ¤ (8 Half Step):**
```
Step  |  A  B  C  D  | Hex  | Binary
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  0   |  1  0  0  0  | 0x08 | 00001000
  1   |  1  1  0  0  | 0x0C | 00001100
  2   |  0  1  0  0  | 0x04 | 00000100
  3   |  0  1  1  0  | 0x06 | 00000110
  4   |  0  0  1  0  | 0x02 | 00000010
  5   |  0  0  1  1  | 0x03 | 00000011
  6   |  0  0  0  1  | 0x01 | 00000001
  7   |  1  0  0  1  | 0x09 | 00001001
```

**ëª¨í„° í• ë‹¹:**
- **ëª¨í„° 0, 1, 2**: ì•Œì•½ ë””ìŠ¤í¬ íšŒì „ (15ì¹¸, ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜)
- **ëª¨í„° 3**: ë°°ì¶œêµ¬ ìŠ¬ë¼ì´ë“œ ì œì–´ (0Â°~360Â°)

**ì†Œí”„íŠ¸ì›¨ì–´ ë“œë¼ì´ë²„:**
- íŒŒì¼: `motor_control.py`
- í´ë˜ìŠ¤: `StepperMotorController`, `PillBoxMotorSystem`
- ì†ë„: 1ms/step (ìµœê³ ì†)
- ì œì–´ ë°©ì‹: ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜ ìœ„ì¹˜ ì¶”ì 

### 4. ì˜¤ë””ì˜¤ ì¶œë ¥ (MAX98357A)

**ì‚¬ì–‘:**
- IC: MAX98357A (I2S D-Class ì•°í”„)
- ì¶œë ¥: 3.2W @ 4Î©, 1.8W @ 8Î©
- ì¸í„°í˜ì´ìŠ¤: I2S
- ìƒ˜í”Œë ˆì´íŠ¸: 8kHz ~ 96kHz
- ë¹„íŠ¸ ìˆ˜: 16bit, 24bit, 32bit
- ì±„ë„: Mono / Stereo (Left ë˜ëŠ” Right ì„ íƒ ê°€ëŠ¥)

**í•€ ì—°ê²°:**
```
MAX98357A      ESP32-C6      ì„¤ëª…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VCC            5V            ì „ì› (ì¶©ì „ ì‹œ USB 5V)
GND            GND           ì ‘ì§€
DIN            IO5           I2S ë°ì´í„° ì…ë ¥
BCLK           IO6           I2S ë¹„íŠ¸ í´ëŸ­
LRCLK (LRC)    IO7           I2S L/R í´ëŸ­ (Word Select)
SD             GND           ì…§ë‹¤ìš´ (GND=í™œì„±í™”)
GAIN           GND           ê²Œì¸ ì„¤ì • (GND=9dB)
OUT+           Speaker+      ìŠ¤í”¼ì»¤ ì¶œë ¥ +
OUT-           Speaker-      ìŠ¤í”¼ì»¤ ì¶œë ¥ -
```

**I2S ì„¤ì •:**
- ë²„ìŠ¤: I2S0
- ëª¨ë“œ: TX (ì†¡ì‹  ì „ìš©)
- í¬ë§·: Mono
- ë¹„íŠ¸: 16bit
- ìƒ˜í”Œë ˆì´íŠ¸: 16kHz
- ë²„í¼ í¬ê¸°: 2048 bytes

**ê²Œì¸ ì„¤ì • (GAIN í•€):**
- GND: 9dB
- VCC: 15dB
- 100kÎ© to GND: 12dB

**ì†Œí”„íŠ¸ì›¨ì–´ ë“œë¼ì´ë²„:**
- íŒŒì¼: `audio_system.py`
- í´ë˜ìŠ¤: `AudioSystem`
- í¬ë§·: WAV íŒŒì¼ (16kHz, 16bit, Mono)
- ì¬ìƒ ëª¨ë“œ: ë¸”ë¡œí‚¹/ë¹„ë¸”ë¡œí‚¹

### 5. ì „ì› ê´€ë¦¬

**USB-UART ë¸Œë¦¬ì§€:**
- IC: CP2102N-A01
- ì¸í„°í˜ì´ìŠ¤: USB Type-C
- ì†ë„: ìµœëŒ€ 921600 baud
- ê¸°ëŠ¥: í”„ë¡œê·¸ë˜ë° + ì‹œë¦¬ì–¼ í†µì‹  + ìë™ ë¦¬ì…‹

**ë°°í„°ë¦¬ ì¶©ì „ê¸°:**
- IC: MCP73831T-2ACI/OT
- ì…ë ¥: USB 5V
- ë°°í„°ë¦¬: Li-ion 1S (3.7V ~ 4.2V)
- ì¶©ì „ ì „ë¥˜: 500mA
- ì¶©ì „ ì¢…ë£Œ ì „ì••: 4.2V
- ìƒíƒœ LED: ì¶©ì „ ì¤‘ (Red), ì™„ë£Œ (Off)

**ì „ì•• ë ˆê·¤ë ˆì´í„°:**
- IC: AP2112K-3.3TRG1 (LDO)
- ì…ë ¥: 5V (USB) ë˜ëŠ” 3.7V (Battery)
- ì¶œë ¥: 3.3V
- ìµœëŒ€ ì „ë¥˜: 600mA
- íš¨ìœ¨: ~80%

**ë°°í„°ë¦¬ ëª¨ë‹ˆí„°ë§:**
- GPIO: IO4 (BAT_AD)
- íšŒë¡œ: ì „ì•• ë¶„ë°°ê¸° (R1=100kÎ©, R2=100kÎ©)
- ADC ë²”ìœ„: 0V ~ 3.3V (ì‹¤ì œ ë°°í„°ë¦¬ ì „ì••: 0V ~ 6.6V)
- ë¶„í•´ëŠ¥: 12bit (0 ~ 4095)

**ì „ë ¥ ì†Œë¹„ (ì¶”ì •):**
- ESP32-C6: ~100mA (Wi-Fi í™œì„±)
- ST7735S: ~30mA (ë°±ë¼ì´íŠ¸ í¬í•¨)
- MAX98357A: ~20mA (ëŒ€ê¸°), ~500mA (ìµœëŒ€ ì¶œë ¥)
- ìŠ¤í…Œí¼ ëª¨í„° (Ã—4): ~200mA (1ê°œ ë™ì‘ ì‹œ)
- **ì´ ì†Œë¹„**: ~350mA (ì¼ë°˜), ~850mA (ëª¨í„° ë™ì‘ ì‹œ)

### 6. ê¸°íƒ€ í•˜ë“œì›¨ì–´

**ë¶€ì € (BZ1):**
- íƒ€ì…: íŒ¨ì‹œë¸Œ ë¶€ì €
- ì „ì••: 3.3V
- ì£¼íŒŒìˆ˜: 2kHz ~ 5kHz (PWM)
- GPIO: IO18

**ì„œë³´ ëª¨í„° (SERVO1, SERVO2):**
- íƒ€ì…: SG90 í˜¸í™˜ ì„œë³´ ëª¨í„°
- ì „ì••: 5V
- ê°ë„: 0Â° ~ 180Â°
- PWM: 50Hz, 1ms~2ms í„ìŠ¤ í­
- GPIO: IO12, IO13

**í¬í†  ì„¼ì„œ (PHOTO):**
- íƒ€ì…: í¬í† íŠ¸ëœì§€ìŠ¤í„° (NPN)
- ì „ì••: 3.3V
- ì¶œë ¥: ë””ì§€í„¸ (HIGH=ë¹› ê°ì§€)
- GPIO: IO11

**RGB LED (D3):**
- íƒ€ì…: LMRGB5050-B4 (Common Anode)
- ì „ì••: 3.3V
- ì œì–´: PWM (3ì±„ë„)
- GPIO: (ë¯¸í• ë‹¹ - ì¶”í›„ ì¶”ê°€)

---

## í†µì‹  í”„ë¡œí† ì½œ

### SPI (ë””ìŠ¤í”Œë ˆì´)

**í•˜ë“œì›¨ì–´ ì„¤ì •:**
```python
SPI(
    1,                    # SPI Bus 1
    baudrate=40000000,    # 40 MHz
    polarity=0,           # CPOL=0 (í´ëŸ­ ê¸°ë³¸ LOW)
    phase=0,              # CPHA=0 (ì²« ì—£ì§€ì—ì„œ ìƒ˜í”Œë§)
    sck=Pin(22),          # Clock
    mosi=Pin(21),         # Master Out Slave In
    miso=None             # ì‚¬ìš© ì•ˆ í•¨ (ë””ìŠ¤í”Œë ˆì´ëŠ” ë‹¨ë°©í–¥)
)
```

**íƒ€ì´ë°:**
- í´ëŸ­ ì£¼íŒŒìˆ˜: 40MHz
- ë¹„íŠ¸ ì „ì†¡ ì‹œê°„: 25ns/bit
- í”„ë ˆì„ ì „ì†¡ ì‹œê°„: ~10ms (160Ã—128Ã—16bit @ 40MHz)

### I2S (ì˜¤ë””ì˜¤)

**í•˜ë“œì›¨ì–´ ì„¤ì •:**
```python
I2S(
    0,                    # I2S Bus 0
    sck=Pin(6),           # Bit Clock (BCLK)
    ws=Pin(7),            # Word Select (LRCLK)
    sd=Pin(5),            # Serial Data (DIN)
    mode=I2S.TX,          # Transmit Only
    bits=16,              # 16bit ìƒ˜í”Œ
    format=I2S.MONO,      # Mono Audio
    rate=16000,           # 16kHz ìƒ˜í”Œë ˆì´íŠ¸
    ibuf=2048             # 2KB ë‚´ë¶€ ë²„í¼
)
```

**íƒ€ì´ë°:**
- ìƒ˜í”Œë ˆì´íŠ¸: 16kHz
- ë¹„íŠ¸ í´ëŸ­: 512kHz (16kHz Ã— 16bit Ã— 2ì±„ë„)
- ì›Œë“œ í´ëŸ­: 16kHz
- ë²„í¼ ì§€ì† ì‹œê°„: 64ms (2048 bytes Ã· 16kHz Ã· 2 bytes)

### GPIO (ì‹œí”„íŠ¸ ë ˆì§€ìŠ¤í„°)

**74HC165 ì½ê¸° íƒ€ì´ë°:**
```
      â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â”
CLK:  â”‚  â””â”€â”˜  â””â”€â”˜  â””â”€â”˜  â””â”€
      
PL:   â”€â”€â”             â”Œâ”€â”€â”€
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘ 5Âµs
        
Q7:   â”€â”€Xâ”€â”€D0â”€Xâ”€â”€D1â”€Xâ”€â”€D2â”€
```

- PL í„ìŠ¤ í­: 5Âµs (ë³‘ë ¬ ë¡œë“œ)
- CLK í„ìŠ¤ í­: 5Âµs (ì‹œí”„íŠ¸)
- ì´ ì½ê¸° ì‹œê°„: ~80Âµs (8ë¹„íŠ¸)

**74HC595 ì“°ê¸° íƒ€ì´ë°:**
```
         â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â”
SH_CP:   â”‚  â””â”€â”˜  â””â”€â”˜  â””â”€â”˜  â””â”€
         
SER:  â”€â”€Xâ”€â”€D0â”€Xâ”€â”€D1â”€Xâ”€â”€D2â”€X
      
ST_CP: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€
                     â””â”€â”€â”˜
                     â†‘ ë˜ì¹˜
```

- SH_CP í„ìŠ¤ í­: 1Âµs (ì‹œí”„íŠ¸)
- ST_CP í„ìŠ¤ í­: 1Âµs (ë˜ì¹˜)
- ì´ ì“°ê¸° ì‹œê°„: ~20Âµs (16ë¹„íŠ¸, 2ê°œ ì¹©)

---

## íšŒë¡œ ì—°ê²°ë„

### ì‹œìŠ¤í…œ ë¸”ë¡ ë‹¤ì´ì–´ê·¸ë¨

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ESP32-C6      â”‚
                    â”‚   DevKit C-1    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚ Display â”‚         â”‚ Audio   â”‚        â”‚ Motor   â”‚
   â”‚ ST7735S â”‚         â”‚MAX98357Aâ”‚        â”‚ Control â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚                   â”‚                   â”‚
   â”‚ SPI               â”‚ I2S               â”‚ GPIO
   â”‚ 40MHz             â”‚ 16kHz             â”‚ Shift Register
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                 â”‚
         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
         â”‚ Buttons â”‚       â”‚ WiFi    â”‚
         â”‚ 74HC165 â”‚       â”‚ 2.4GHz  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì „ì› ë¶„ë°°ë„

```
USB Type-C (5V)
    â”‚
    â”œâ”€â†’ MCP73831 â”€â”€â†’ Li-ion Battery (3.7V~4.2V)
    â”‚      â”‚
    â”‚      â””â”€â†’ Status LED (Red)
    â”‚
    â”œâ”€â†’ AP2112K â”€â”€â†’ 3.3V Rail
    â”‚      â”‚           â”‚
    â”‚      â”‚           â”œâ”€â†’ ESP32-C6
    â”‚      â”‚           â”œâ”€â†’ ST7735S
    â”‚      â”‚           â”œâ”€â†’ 74HC165
    â”‚      â”‚           â”œâ”€â†’ 74HC595
    â”‚      â”‚           â””â”€â†’ Sensors
    â”‚
    â””â”€â†’ 5V Rail
           â”‚
           â”œâ”€â†’ MAX98357A
           â”œâ”€â†’ ULN2003A (Ã—4)
           â””â”€â†’ Servo Motors
```

### ëª¨í„° ì œì–´ íšŒë¡œ

```
ESP32-C6 GPIO2 (DI) â”€â”€â”€â”€â”
ESP32-C6 GPIO3 (SH_CP) â”€â”¼â”€â”
ESP32-C6 GPIO15 (ST_CP) â”¼â”€â”¼â”€â”
                        â”‚ â”‚ â”‚
                     â”Œâ”€â”€â–¼â”€â–¼â”€â–¼â”€â”€â”€â”
                     â”‚ 74HC595#1â”‚
                     â”‚ Q0-Q3    â”‚â”€â”€â†’ ULN2003A#1 â”€â”€â†’ Motor 0
                     â”‚ Q4-Q7    â”‚â”€â”€â†’ ULN2003A#2 â”€â”€â†’ Motor 1
                     â”‚ Q7'      â”‚â”€â”€â”
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                   â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â””â”€â”¤74HC595#2â”‚
                       â”‚ Q0-Q3   â”‚â”€â”€â†’ ULN2003A#3 â”€â”€â†’ Motor 2
                       â”‚ Q4-Q7   â”‚â”€â”€â†’ ULN2003A#4 â”€â”€â†’ Motor 3
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í•˜ë“œì›¨ì–´ í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ ìˆœì„œ

1. **ì „ì› í…ŒìŠ¤íŠ¸**: LED ì ë“± í™•ì¸
2. **ë””ìŠ¤í”Œë ˆì´ í…ŒìŠ¤íŠ¸**: `tests/02_RGB_DISPLAY_TEST_GUIDE.md`
3. **ë²„íŠ¼ í…ŒìŠ¤íŠ¸**: `tests/01_74HC165_TEST_GUIDE.md`
4. **ì˜¤ë””ì˜¤ í…ŒìŠ¤íŠ¸**: `tests/03_WAV_PLAYER_TEST_GUIDE.md`
5. **ëª¨í„° í…ŒìŠ¤íŠ¸**: `tests/04_74HC595_STEPPER_TEST_GUIDE.md`
6. **WiFi í…ŒìŠ¤íŠ¸**: `tests/05_WIFI_TEST_GUIDE.md`

### ê¸°ë³¸ í•˜ë“œì›¨ì–´ ì²´í¬ë¦¬ìŠ¤íŠ¸

```python
# ESP32-C6 ê¸°ë³¸ í™•ì¸
import machine
import time

# 1. GPIO í…ŒìŠ¤íŠ¸
led = machine.Pin(1, machine.Pin.OUT)
led.value(1)  # LED ì¼œê¸°
time.sleep(1)
led.value(0)  # LED ë„ê¸°

# 2. SPI í…ŒìŠ¤íŠ¸
spi = machine.SPI(1, baudrate=40000000, sck=machine.Pin(22), mosi=machine.Pin(21))
print(spi)

# 3. I2S í…ŒìŠ¤íŠ¸
i2s = machine.I2S(0, sck=machine.Pin(6), ws=machine.Pin(7), sd=machine.Pin(5), 
                  mode=machine.I2S.TX, bits=16, format=machine.I2S.MONO, rate=16000)
print(i2s)

# 4. WiFi í…ŒìŠ¤íŠ¸
import network
wlan = network.WLAN(network.STA_IF)
wlan.active(True)
print(wlan.scan())

# 5. ë©”ëª¨ë¦¬ í™•ì¸
import gc
gc.collect()
print(f"Free memory: {gc.mem_free()} bytes")
```

---

## ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œ

**1. ë””ìŠ¤í”Œë ˆì´ê°€ ì‘ë™í•˜ì§€ ì•ŠìŒ**
- SPI ì—°ê²° í™•ì¸ (MOSI, SCK, CS, DC, RST)
- ì „ì› ì „ì•• í™•ì¸ (3.3V)
- ì˜¤í”„ì…‹ ì„¤ì • í™•ì¸ (X=1, Y=2)
- ë°±ë¼ì´íŠ¸ ì—°ê²° í™•ì¸

**2. ì˜¤ë””ì˜¤ê°€ ì¬ìƒë˜ì§€ ì•ŠìŒ**
- I2S í•€ ì—°ê²° í™•ì¸ (BCLK, LRCLK, DIN)
- MAX98357A ì „ì› í™•ì¸ (5V)
- SD í•€ì´ GNDì¸ì§€ í™•ì¸ (ì…§ë‹¤ìš´ ë°©ì§€)
- ìƒ˜í”Œë ˆì´íŠ¸ ë° í¬ë§· í™•ì¸ (16kHz, 16bit, Mono)

**3. ë²„íŠ¼ ì…ë ¥ì´ ë°˜ì‘í•˜ì§€ ì•ŠìŒ**
- 74HC165 ì—°ê²° í™•ì¸ (CLK, PL, Q7)
- Pull-up ì €í•­ í™•ì¸ (10kÎ©)
- ë²„íŠ¼ì´ GNDë¡œ ì—°ê²°ë˜ëŠ”ì§€ í™•ì¸ (Active LOW)

**4. ëª¨í„°ê°€ íšŒì „í•˜ì§€ ì•ŠìŒ**
- 74HC595 ì—°ê²° í™•ì¸ (DI, SH_CP, ST_CP)
- ULN2003A ì „ì› í™•ì¸ (5V)
- ëª¨í„° ì—°ê²° ìˆœì„œ í™•ì¸ (A, B, C, D)
- ìŠ¤í… ì‹œí€€ìŠ¤ í™•ì¸

**5. WiFi ì—°ê²° ì‹¤íŒ¨**
- ì•ˆí…Œë‚˜ ì—°ê²° í™•ì¸
- 2.4GHz ëŒ€ì—­ í™•ì¸ (5GHz ì§€ì› ì•ˆ í•¨)
- SSID ë° ë¹„ë°€ë²ˆí˜¸ í™•ì¸
- ì‹ í˜¸ ì„¸ê¸° í™•ì¸ (RSSI > -70dBm)

### ë””ë²„ê¹… ë„êµ¬

**ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°:**
```bash
# Windows (esptool ì‚¬ìš©)
python -m esptool --port COM3 read_flash 0 0x400000 flash_dump.bin

# Linux/Mac (screen ì‚¬ìš©)
screen /dev/ttyUSB0 115200

# PuTTY (Windows)
# COM í¬íŠ¸, 115200 baud, 8N1
```

**ì „ì•• ì¸¡ì •:**
- 3.3V ë ˆì¼: 3.2V ~ 3.4V
- 5V ë ˆì¼: 4.8V ~ 5.2V
- ë°°í„°ë¦¬: 3.0V ~ 4.2V

**ì „ë¥˜ ì¸¡ì •:**
- USB ì…ë ¥: 100mA ~ 1A (ë™ì‘ ìƒíƒœì— ë”°ë¼)
- ë°°í„°ë¦¬ ì¶©ì „: ~500mA (ì¶©ì „ ì¤‘)

---

## ì°¸ê³  ìë£Œ

### ë°ì´í„°ì‹œíŠ¸
- [ESP32-C6 Datasheet](../docs/esp32-c6_datasheet_en.pdf)
- [ST7735S Datasheet](../docs/ST7735S.pdf)
- [SN74HC165 Datasheet](../docs/sn54hc165-sn74hc165.pdf)
- [SN74HC595 Datasheet](../docs/sn74hc595n.pdf)
- [ESP32-C6 DevKit C-1 Schematics](../docs/esp32-c6-devkitc-1-schematics_v1.4.pdf)

### ê´€ë ¨ ë¬¸ì„œ
- [ARCHITECTURE.md](ARCHITECTURE.md): ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…ì²˜
- [README.md](README.md): í”„ë¡œì íŠ¸ ê°œìš”
- [tests/](../tests/): í•˜ë“œì›¨ì–´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

### ì™¸ë¶€ ë§í¬
- [ESP32-C6 ê³µì‹ ë¬¸ì„œ](https://docs.espressif.com/projects/esp-idf/en/latest/esp32c6/)
- [MicroPython ê³µì‹ ë¬¸ì„œ](https://docs.micropython.org/)
- [LVGL ê³µì‹ ë¬¸ì„œ](https://docs.lvgl.io/)

---

**ì‘ì„±ì¼**: 2025-10-10  
**ë²„ì „**: 1.0.0  
**ì‘ì„±ì**: PillBox Development Team


