# Wi-Fi 스캔 화면 테스트 가이드

> **WifiScanScreen 테스트 및 사용법**

## 📋 개요

Wi-Fi 스캔 화면은 사용 가능한 Wi-Fi 네트워크를 스캔하고 선택할 수 있는 화면입니다. 보안 네트워크와 오픈 네트워크를 구분하여 처리합니다.

## 🎯 주요 기능

- **Wi-Fi 네트워크 스캔** 및 목록 표시
- **네트워크 선택** (A/B 버튼으로 이동, D 버튼으로 선택)
- **보안/오픈 네트워크 구분** 처리
- **자동 연결** (오픈 네트워크의 경우)
- **Modern UI 스타일** 적용

## 🚀 테스트 방법

### 1. 개별 화면 테스트
```bash
# main.py 실행 후 메뉴에서 2번 선택
선택 (1-11): 2
```

### 2. 테스트 시나리오
1. **Wi-Fi 스캔 확인**
   - 화면 로드 시 자동으로 네트워크 스캔
   - 터미널에 스캔 결과 출력
   - 발견된 네트워크 목록 표시

2. **네트워크 선택 테스트**
   - **A/B 버튼**: 네트워크 목록에서 위/아래 이동
   - **D 버튼**: 선택한 네트워크 연결 시도
   - **C 버튼**: 뒤로가기 (스타트업 화면으로)

3. **연결 결과 확인**
   - **보안 네트워크**: Wi-Fi 비밀번호 화면으로 전환
   - **오픈 네트워크**: 복용 횟수 설정 화면으로 직접 전환

## 🔧 화면 구성 요소

### UI 요소
- **제목**: "Wi-Fi 네트워크 선택"
- **네트워크 목록**: LVGL 리스트 위젯으로 표시
- **스캔 상태**: "네트워크 스캔 중..." 또는 "X개 네트워크 발견"
- **버튼 힌트**: "A/B: 선택, D: 연결, C: 뒤로가기"

### 네트워크 정보 표시
- **SSID**: 네트워크 이름
- **신호 강도**: 시각적 표시
- **보안 상태**: 자물쇠 아이콘 (보안 네트워크)

## 📱 화면 전환

### 보안 네트워크 선택 시
- **조건**: 보안이 활성화된 네트워크 선택
- **대상**: Wi-Fi 비밀번호 화면 (`wifi_password`)
- **방법**: `_connect_to_secure_network()` 호출

### 오픈 네트워크 선택 시
- **조건**: 보안이 없는 네트워크 선택
- **대상**: 복용 횟수 설정 화면 (`dose_count`)
- **방법**: `_connect_to_open_network()` 호출

### 뒤로가기
- **조건**: C 버튼 누름
- **대상**: 스타트업 화면 (`startup`)
- **방법**: `_go_back()` 호출

## 🔧 버튼 조작

### A 버튼
- **기능**: 네트워크 목록에서 위로 이동
- **동작**: 이전 네트워크 선택

### B 버튼
- **기능**: 네트워크 목록에서 아래로 이동
- **동작**: 다음 네트워크 선택

### C 버튼
- **기능**: 뒤로가기
- **동작**: 스타트업 화면으로 돌아가기

### D 버튼
- **기능**: 네트워크 연결
- **동작**: 선택한 네트워크에 연결 시도

## 🌐 Wi-Fi 스캔 로직

### 스캔 과정
1. **스캔 시작**: `wifi_manager.scan_networks()` 호출
2. **결과 처리**: 발견된 네트워크 목록 정리
3. **UI 업데이트**: 리스트 위젯에 네트워크 추가
4. **상태 표시**: 스캔 완료 메시지

### 네트워크 정보
- **SSID**: 네트워크 이름
- **RSSI**: 신호 강도
- **Security**: 보안 설정 (WPA2, WPA3, Open)
- **Channel**: 채널 번호


## 📊 성능 최적화

### 메모리 관리
- **동적 리스트 생성**: 필요한 만큼만 아이템 생성
- **리소스 정리**: 화면 전환 시 메모리 해제
- **가비지 컬렉션**: 스캔 완료 후 메모리 정리

### 스캔 최적화
- **비동기 스캔**: UI 블로킹 방지
- **결과 캐싱**: 중복 스캔 방지
- **타임아웃 설정**: 무한 대기 방지

## 🔗 관련 파일

- **`screens/wifi_scan_screen.py`**: Wi-Fi 스캔 화면 구현
- **`wifi_manager.py`**: Wi-Fi 연결 관리
- **`main.py`**: 테스트 시스템
- **`screen_manager.py`**: 화면 전환 관리

## 📝 개발 노트

### 최근 변경사항
- **동적 화면 생성**: 필요 시에만 화면 생성
- **메모리 최적화**: 리소스 정리 개선
- **연결 로직 개선**: 보안/오픈 네트워크 구분 처리

### 향후 개선 계획
- **네트워크 필터링**: 신호 강도별 정렬
- **자동 재연결**: 연결 실패 시 재시도
- **네트워크 히스토리**: 이전 연결 기록 저장
