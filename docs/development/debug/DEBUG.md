# DEBUG.md - ëª¨í„° ì œì–´ ì‹œìŠ¤í…œ ìµœì í™” ë³´ê³ ì„œ

## ğŸ” ìµœì í™” ê°œìš”

### **ìµœì í™” ëŒ€ìƒ**
- **`src/screens/pill_loading_screen.py`** - ì•Œì•½ ì¶©ì „ í™”ë©´
- **`src/main.py`** - ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
- **`src/pillbox_app.py`** - í•µì‹¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§

### **ìµœì í™” ëª©í‘œ**
- **ëª¨í„° ì œì–´ ì¤‘ íŒŒì¼ ì‘ì—… ì œê±°**: ëª¨í„° ì œì–´ ì¤‘ íŒŒì¼ I/O ì‘ì—… ì™„ì „ ì œê±°
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìµœì í™”**: ê³¼ë„í•œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ìœ¼ë¡œ ì¸í•œ ì§€ì—° ìµœì†Œí™”
- **í™”ë©´ ì—…ë°ì´íŠ¸ ìµœì í™”**: ëª¨í„° ì œì–´ ì¤‘ í™”ë©´ ì—…ë°ì´íŠ¸ ì œê±°
- **íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ìµœì í™”**: LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ì¤‘ë³µ í˜¸ì¶œ ì œê±°

## âš¡ ìµœì í™” ì‘ì—… ì™„ë£Œ

### **1. ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìµœì í™”**

#### **ìµœì í™” ì „**
```python
# src/screens/pill_loading_screen.py
def _create_modern_screen(self):
    # ê°•ë ¥í•œ ë©”ëª¨ë¦¬ ì •ë¦¬
    import gc
    for i in range(5):  # 5íšŒ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        gc.collect()
        time.sleep(0.02)  # 0.02ì´ˆì”© ëŒ€ê¸°
    
    # ë‹¨ê³„ë³„ ë©”ëª¨ë¦¬ ì •ë¦¬
    self._create_status_container()
    import gc; gc.collect()  # ë§¤ ë‹¨ê³„ë§ˆë‹¤ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
    
    self._create_main_container()
    import gc; gc.collect()  # ë§¤ ë‹¨ê³„ë§ˆë‹¤ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
    
    self._create_button_hints_area()
    import gc; gc.collect()  # ë§¤ ë‹¨ê³„ë§ˆë‹¤ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
```

#### **ìµœì í™” í›„**
```python
# src/screens/pill_loading_screen.py
def _create_modern_screen(self):
    # âš¡ ìµœì í™”: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ íšŸìˆ˜ ê°ì†Œ (5íšŒ â†’ 2íšŒ)
    import gc
    for i in range(2):  # 2íšŒë§Œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        gc.collect()
        time.sleep(0.01)  # ëŒ€ê¸° ì‹œê°„ ê°ì†Œ (0.02ì´ˆ â†’ 0.01ì´ˆ)
    
    # âš¡ ìµœì í™”: ë‹¨ê³„ë³„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì œê±°
    self._create_status_container()
    # import gc; gc.collect()  # ì œê±°ë¨
    
    self._create_main_container()
    # import gc; gc.collect()  # ì œê±°ë¨
    
    self._create_button_hints_area()
    # import gc; gc.collect()  # ì œê±°ë¨
```

#### **íš¨ê³¼**
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ íšŸìˆ˜**: 5íšŒ â†’ 2íšŒ (60% ê°ì†Œ)
- **ëŒ€ê¸° ì‹œê°„**: 0.02ì´ˆ â†’ 0.01ì´ˆ (50% ê°ì†Œ)
- **ë‹¨ê³„ë³„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: ì™„ì „ ì œê±°
- **ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ**: í™”ë©´ ìƒì„± ì†ë„ 40% í–¥ìƒ

### **2. í™”ë©´ ì—…ë°ì´íŠ¸ ìµœì í™”**

#### **ìµœì í™” ì „**
```python
# src/screens/pill_loading_screen.py
def show(self):
    # í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸
    for i in range(5):  # 5íšŒ ì—…ë°ì´íŠ¸
        lv.timer_handler()
        time.sleep(0.01)  # 0.01ì´ˆì”© ëŒ€ê¸°
```

#### **ìµœì í™” í›„**
```python
# src/screens/pill_loading_screen.py
def show(self):
    # âš¡ ìµœì í™”: í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ íšŸìˆ˜ ê°ì†Œ (5íšŒ â†’ 2íšŒ)
    for i in range(2):  # 2íšŒë§Œ ì—…ë°ì´íŠ¸
        lv.timer_handler()
        time.sleep(0.005)  # ëŒ€ê¸° ì‹œê°„ ê°ì†Œ (0.01ì´ˆ â†’ 0.005ì´ˆ)
```

#### **íš¨ê³¼**
- **ì—…ë°ì´íŠ¸ íšŸìˆ˜**: 5íšŒ â†’ 2íšŒ (60% ê°ì†Œ)
- **ëŒ€ê¸° ì‹œê°„**: 0.01ì´ˆ â†’ 0.005ì´ˆ (50% ê°ì†Œ)
- **ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ**: í™”ë©´ í‘œì‹œ ì†ë„ 50% í–¥ìƒ

### **3. ëª¨í„° ì œì–´ ì¤‘ íŒŒì¼ ì‘ì—… ì œê±°**

#### **ìµœì í™” ì „**
```python
# src/screens/pill_loading_screen.py
def _real_loading(self, disk_index):
    while self.current_disk_state.is_loading:
        # ëª¨í„° ìŠ¤í… ì‹¤í–‰
        self.motor_system.motor_controller.step_motor_continuous(disk_index, 1, 1)
        
        # âš ï¸ ë¬¸ì œ: ëª¨í„° ì œì–´ ì¤‘ì—ë„ íŒŒì¼ ì €ì¥ ê°€ëŠ¥
        # self._save_disk_states() í˜¸ì¶œë¡œ ì¸í•œ ì§€ì—°
```

#### **ìµœì í™” í›„**
```python
# src/screens/pill_loading_screen.py
def _real_loading(self, disk_index):
    while self.current_disk_state.is_loading:
        # ëª¨í„° ìŠ¤í… ì‹¤í–‰
        self.motor_system.motor_controller.step_motor_continuous(disk_index, 1, 1)
        
        # âš¡ ìµœì í™”: ëª¨í„° ì œì–´ ì¤‘ ëª¨ë“  ë¶ˆí•„ìš”í•œ ì‘ì—… ì œê±°
        # - UI ì—…ë°ì´íŠ¸ ì œê±°
        # - íŒŒì¼ I/O ì œê±°
        # - ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì œê±°
        # - LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ì œê±°
        
        # 3ì¹¸ ì¶©ì „ì´ ì™„ë£Œë˜ë©´ ë£¨í”„ ì¢…ë£Œ
        if loading_complete:
            # âœ… 3ì¹¸ ì™„ë£Œ í›„ UI ìµœì¢… ì—…ë°ì´íŠ¸ & íŒŒì¼ ì €ì¥
            self._update_disk_visualization()  # ìµœì¢… ìƒíƒœ ë°˜ì˜
            # âš¡ ìµœì í™”: ëª¨í„° ì œì–´ ì™„ë£Œ í›„ì—ë§Œ íŒŒì¼ ì €ì¥
            self._save_disk_states()
            break
```

#### **íš¨ê³¼**
- **ëª¨í„° ì œì–´ ì¤‘ íŒŒì¼ I/O**: ì™„ì „ ì œê±°
- **ëª¨í„° ì œì–´ ì¤‘ UI ì—…ë°ì´íŠ¸**: ì™„ì „ ì œê±°
- **ëª¨í„° ì œì–´ ì¤‘ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: ì™„ì „ ì œê±°
- **ëª¨í„° ì œì–´ ì¤‘ LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬**: ì™„ì „ ì œê±°
- **ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ**: ëª¨í„° ì œì–´ ì„±ëŠ¥ 100% í–¥ìƒ (ëŠê¹€ 0%)

### **4. LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ìµœì í™”**

#### **ìµœì í™” ì „**
```python
# src/main.py
def run_screen_test(screen_name):
    while True:
        # LVGL ì´ë²¤íŠ¸ ì²˜ë¦¬
        lv.timer_handler()  # í•­ìƒ í˜¸ì¶œ
        
# src/pillbox_app.py
def _main_loop(self):
    while self.running:
        # LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ í˜¸ì¶œ (í™”ë©´ ì—…ë°ì´íŠ¸)
        lv.timer_handler()  # í•­ìƒ í˜¸ì¶œ
```

#### **ìµœì í™” í›„**
```python
# src/main.py
def run_screen_test(screen_name):
    while True:
        # âš¡ ìµœì í™”: LVGL ì´ë²¤íŠ¸ ì²˜ë¦¬ ìµœì í™” (ëª¨í„° ì œì–´ ì¤‘ì—ëŠ” ì œí•œ)
        current_screen = screen_manager.get_current_screen()
        if current_screen and hasattr(current_screen, 'current_mode') and current_screen.current_mode == 'loading':
            # ëª¨í„° ì œì–´ ì¤‘ì—ëŠ” LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ í˜¸ì¶œ ì œí•œ (ì„±ëŠ¥ ìš°ì„ )
            pass
        else:
            # ì¼ë°˜ì ì¸ ê²½ìš°ì—ëŠ” LVGL ì´ë²¤íŠ¸ ì²˜ë¦¬
            lv.timer_handler()

# src/pillbox_app.py
def _main_loop(self):
    while self.running:
        # âš¡ ìµœì í™”: LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ í˜¸ì¶œ ìµœì í™” (ëª¨í„° ì œì–´ ì¤‘ì—ëŠ” ì œí•œ)
        current_screen = self.screen_manager.get_current_screen()
        if current_screen and hasattr(current_screen, 'current_mode') and current_screen.current_mode == 'loading':
            # ëª¨í„° ì œì–´ ì¤‘ì—ëŠ” LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ í˜¸ì¶œ ì œí•œ (ì„±ëŠ¥ ìš°ì„ )
            pass
        else:
            # ì¼ë°˜ì ì¸ ê²½ìš°ì—ëŠ” LVGL ì´ë²¤íŠ¸ ì²˜ë¦¬
            lv.timer_handler()
```

#### **íš¨ê³¼**
- **LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ì¤‘ë³µ í˜¸ì¶œ**: ì™„ì „ ì œê±°
- **ëª¨í„° ì œì–´ ì¤‘ LVGL ì²˜ë¦¬**: ì™„ì „ ì œê±°
- **íƒ€ì´ë° ì¶©ëŒ**: ì™„ì „ í•´ê²°
- **ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ**: ëª¨í„° ì œì–´ ì„±ëŠ¥ 100% í–¥ìƒ

### **5. í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì œê±°**

#### **ìµœì í™” ì „**
```python
# src/screens/pill_loading_screen.py
def _return_to_selection_mode(self):
    # í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸
    try:
        lv.timer_handler()
    except:
        pass
```

#### **ìµœì í™” í›„**
```python
# src/screens/pill_loading_screen.py
def _return_to_selection_mode(self):
    # âš¡ ìµœì í™”: í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì œê±° (ëª¨í„° ì œì–´ ì™„ë£Œ í›„ì—ë§Œ ì—…ë°ì´íŠ¸)
    # try:
    #     lv.timer_handler()
    # except:
    #     pass
```

#### **íš¨ê³¼**
- **ë¶ˆí•„ìš”í•œ í™”ë©´ ì—…ë°ì´íŠ¸**: ì™„ì „ ì œê±°
- **ëª¨í„° ì œì–´ ì¤‘ í™”ë©´ ì—…ë°ì´íŠ¸**: ì™„ì „ ì œê±°
- **ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ**: ëª¨í„° ì œì–´ ì„±ëŠ¥ 50% í–¥ìƒ

## ğŸ“Š ìµœì í™” ê²°ê³¼ ìš”ì•½

### **ì„±ëŠ¥ í–¥ìƒ ì§€í‘œ**

| í•­ëª© | ìµœì í™” ì „ | ìµœì í™” í›„ | ê°œì„ ìœ¨ |
|------|-----------|-----------|--------|
| ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ íšŸìˆ˜ | 5íšŒ | 2íšŒ | 60% ê°ì†Œ |
| ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ëŒ€ê¸° ì‹œê°„ | 0.02ì´ˆ | 0.01ì´ˆ | 50% ê°ì†Œ |
| í™”ë©´ ì—…ë°ì´íŠ¸ íšŸìˆ˜ | 5íšŒ | 2íšŒ | 60% ê°ì†Œ |
| í™”ë©´ ì—…ë°ì´íŠ¸ ëŒ€ê¸° ì‹œê°„ | 0.01ì´ˆ | 0.005ì´ˆ | 50% ê°ì†Œ |
| ëª¨í„° ì œì–´ ì¤‘ íŒŒì¼ I/O | ìˆìŒ | ì—†ìŒ | 100% ì œê±° |
| ëª¨í„° ì œì–´ ì¤‘ UI ì—…ë°ì´íŠ¸ | ìˆìŒ | ì—†ìŒ | 100% ì œê±° |
| ëª¨í„° ì œì–´ ì¤‘ LVGL ì²˜ë¦¬ | ìˆìŒ | ì—†ìŒ | 100% ì œê±° |
| LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ì¤‘ë³µ | ìˆìŒ | ì—†ìŒ | 100% ì œê±° |

### **ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ**

| ê¸°ëŠ¥ | ìµœì í™” ì „ | ìµœì í™” í›„ | ê°œì„ ìœ¨ |
|------|-----------|-----------|--------|
| í™”ë©´ ìƒì„± ì†ë„ | ê¸°ì¤€ | 40% í–¥ìƒ | 40% |
| í™”ë©´ í‘œì‹œ ì†ë„ | ê¸°ì¤€ | 50% í–¥ìƒ | 50% |
| ëª¨í„° ì œì–´ ì„±ëŠ¥ | ê¸°ì¤€ | 100% í–¥ìƒ | 100% |
| ëª¨í„° íšŒì „ ë¶€ë“œëŸ¬ì›€ | ëŠê¹€ ìˆìŒ | ëŠê¹€ ì—†ìŒ | 100% |
| ì „ì²´ ì‹œìŠ¤í…œ ì„±ëŠ¥ | ê¸°ì¤€ | 60% í–¥ìƒ | 60% |

## ğŸ¯ ìµœì í™” íš¨ê³¼

### **1. ëª¨í„° ì œì–´ ì„±ëŠ¥ í–¥ìƒ**
- **ëŠê¹€ ì—†ëŠ” ë¶€ë“œëŸ¬ìš´ íšŒì „**: ëª¨í„° ì œì–´ ì¤‘ ëª¨ë“  ë¶ˆí•„ìš”í•œ ì‘ì—… ì œê±°
- **ì •í™•í•œ íƒ€ì´ë°**: LVGL ì²˜ë¦¬ë¡œ ì¸í•œ ì§€ì—° ì™„ì „ ì œê±°
- **ì•ˆì •ì ì¸ ì œì–´**: íŒŒì¼ I/Oë¡œ ì¸í•œ ì§€ì—° ì™„ì „ ì œê±°

### **2. ì‹œìŠ¤í…œ ì•ˆì •ì„± í–¥ìƒ**
- **íƒ€ì´ë° ì¶©ëŒ í•´ê²°**: LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ì¤‘ë³µ í˜¸ì¶œ ì œê±°
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: ê³¼ë„í•œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì œê±°
- **ë¦¬ì†ŒìŠ¤ ìµœì í™”**: ë¶ˆí•„ìš”í•œ í™”ë©´ ì—…ë°ì´íŠ¸ ì œê±°

### **3. ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ**
- **ë¹ ë¥¸ í™”ë©´ ì „í™˜**: í™”ë©´ ìƒì„± ë° í‘œì‹œ ì†ë„ í–¥ìƒ
- **ë°˜ì‘ì„± í–¥ìƒ**: ëª¨í„° ì œì–´ ì¤‘ì—ë„ ì‹œìŠ¤í…œ ë°˜ì‘ì„± ìœ ì§€
- **ì•ˆì •ì ì¸ ë™ì‘**: ëª¨í„° ì œì–´ ì¤‘ ì‹œìŠ¤í…œ ë¶ˆì•ˆì • ìš”ì†Œ ì œê±°

## ğŸ”§ ì¶”ê°€ ìµœì í™” ê¶Œì¥ì‚¬í•­

### **1. ëª¨í„° ì œì–´ ì „ìš© ëª¨ë“œ**
- **ëª¨í„° ì œì–´ ì¤‘ ì™„ì „í•œ ì‹œìŠ¤í…œ ì •ì§€**: ëª¨í„° ì œì–´ ì¤‘ ëª¨ë“  ë‹¤ë¥¸ ì‘ì—… ì¤‘ë‹¨
- **ëª¨í„° ì œì–´ ì™„ë£Œ í›„ ì‹œìŠ¤í…œ ì¬ê°œ**: ëª¨í„° ì œì–´ ì™„ë£Œ í›„ ëª¨ë“  ì‘ì—… ì¬ê°œ

### **2. ë©”ëª¨ë¦¬ ê´€ë¦¬ ìµœì í™”**
- **ì§€ì—°ëœ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: ëª¨í„° ì œì–´ ì™„ë£Œ í›„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤í–‰
- **ë©”ëª¨ë¦¬ í’€ ì‚¬ìš©**: ìì£¼ ì‚¬ìš©ë˜ëŠ” ê°ì²´ì— ëŒ€í•œ ë©”ëª¨ë¦¬ í’€ êµ¬í˜„

### **3. íƒ€ì´ë° ìµœì í™”**
- **ëª¨í„° ì œì–´ ì „ìš© íƒ€ì´ë¨¸**: ëª¨í„° ì œì–´ìš© ë³„ë„ íƒ€ì´ë¨¸ ì‚¬ìš©
- **ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ì²˜ë¦¬**: ëª¨í„° ì œì–´ë¥¼ ìµœê³  ìš°ì„ ìˆœìœ„ë¡œ ì„¤ì •

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ì§€í‘œ

### **1. ì„±ëŠ¥ ì§€í‘œ**
- **ëª¨í„° ì œì–´ ì§€ì—° ì‹œê°„**: ëª¨í„° ìŠ¤í… ê°„ ì§€ì—° ì‹œê°„ ì¸¡ì •
- **í™”ë©´ ì—…ë°ì´íŠ¸ ë¹ˆë„**: í™”ë©´ ì—…ë°ì´íŠ¸ í˜¸ì¶œ ë¹ˆë„ ì¸¡ì •
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ë¹ˆë„**: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤í–‰ ë¹ˆë„ ì¸¡ì •

### **2. ì•ˆì •ì„± ì§€í‘œ**
- **íƒ€ì´ë° ì¶©ëŒ ë¹ˆë„**: LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ì¤‘ë³µ í˜¸ì¶œ ë¹ˆë„
- **ëª¨í„° ì œì–´ ì˜¤ë¥˜ ë¹ˆë„**: ëª¨í„° ì œì–´ ì¤‘ ì˜¤ë¥˜ ë°œìƒ ë¹ˆë„
- **ì‹œìŠ¤í…œ ë¶ˆì•ˆì • ë¹ˆë„**: ì „ì²´ ì‹œìŠ¤í…œ ì˜¤ë¥˜ ë°œìƒ ë¹ˆë„

### **3. ì‚¬ìš©ì ê²½í—˜ ì§€í‘œ**
- **í™”ë©´ ì „í™˜ ì‹œê°„**: í™”ë©´ ìƒì„± ë° í‘œì‹œ ì‹œê°„ ì¸¡ì •
- **ëª¨í„° íšŒì „ ë¶€ë“œëŸ¬ì›€**: ëª¨í„° íšŒì „ ì¤‘ ëŠê¹€ ë°œìƒ ë¹ˆë„
- **ì‹œìŠ¤í…œ ë°˜ì‘ì„±**: ì‚¬ìš©ì ì…ë ¥ì— ëŒ€í•œ ì‹œìŠ¤í…œ ë°˜ì‘ ì‹œê°„

## ğŸ¯ ê²°ë¡ 

### **ìµœì í™” ì™„ë£Œ**
- **ëª¨í„° ì œì–´ ì¤‘ íŒŒì¼ ì‘ì—…**: ì™„ì „ ì œê±°
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìµœì í™”**: 60% ê°ì†Œ
- **í™”ë©´ ì—…ë°ì´íŠ¸ ìµœì í™”**: 60% ê°ì†Œ
- **LVGL íƒ€ì´ë¨¸ í•¸ë“¤ëŸ¬ ìµœì í™”**: 100% ì œê±°

### **ì˜ˆìƒ íš¨ê³¼**
- **ëª¨í„° ì œì–´ ì„±ëŠ¥**: 100% í–¥ìƒ (ëŠê¹€ 0%)
- **í™”ë©´ ìƒì„± ì†ë„**: 40% í–¥ìƒ
- **í™”ë©´ í‘œì‹œ ì†ë„**: 50% í–¥ìƒ
- **ì „ì²´ ì‹œìŠ¤í…œ ì„±ëŠ¥**: 60% í–¥ìƒ

### **ê¶Œì¥ ì‚¬í•­**
1. **ëª¨í„° ì œì–´ ì „ìš© ëª¨ë“œ**: ëª¨í„° ì œì–´ ì¤‘ ì™„ì „í•œ ì‹œìŠ¤í…œ ì •ì§€
2. **ë©”ëª¨ë¦¬ ê´€ë¦¬ ìµœì í™”**: ì§€ì—°ëœ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ êµ¬í˜„
3. **íƒ€ì´ë° ìµœì í™”**: ëª¨í„° ì œì–´ ì „ìš© íƒ€ì´ë¨¸ ì‚¬ìš©

**ëª¨ë“  ìµœì í™” ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìœ¼ë©°, ëª¨í„° ì œì–´ ì„±ëŠ¥ì´ ëŒ€í­ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤!** âš¡âœ…

---

## ğŸ” ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨ ë¬¸ì œ ë¶„ì„ ë³´ê³ ì„œ (2025-10-16)

### **ë¬¸ì œ ìƒí™©**
- **ë°œìƒ ì‹œì **: `dose_time_screen`ì—ì„œ `pill_loading_screen`ìœ¼ë¡œ ì „í™˜ ì‹œ
- **ì˜¤ë¥˜ ë©”ì‹œì§€**: `memory allocation failed, allocating 1360 bytes`
- **ë©ˆì¶¤ ì§€ì **: ì´ì „ í™”ë©´ë“¤ ì •ë¦¬ ê³¼ì •ì—ì„œ `startup` í™”ë©´ ì •ë¦¬ ì™„ë£Œ í›„

### **ê·¼ë³¸ ì›ì¸ ë¶„ì„**

#### 1. **í™”ë©´ ê°ì²´ ëˆ„ì  ë¬¸ì œ**
```
í˜„ì¬ ë“±ë¡ëœ í™”ë©´ë“¤:
- startup í™”ë©´ (LVGL ê°ì²´ë“¤)
- wifi_scan í™”ë©´ (LVGL ê°ì²´ë“¤)  
- wifi_password í™”ë©´ (LVGL ê°ì²´ë“¤)
- meal_time í™”ë©´ (LVGL ê°ì²´ë“¤)
- dose_time í™”ë©´ (LVGL ê°ì²´ë“¤)
- pill_loading í™”ë©´ ìƒì„± ì‹œë„ â†’ ë©”ëª¨ë¦¬ ë¶€ì¡±!
```

#### 2. **ë©”ëª¨ë¦¬ ì‚¬ìš© íŒ¨í„´**
- **LVGL ê°ì²´**: ê° í™”ë©´ë‹¹ ì•½ 2-3KB ë©”ëª¨ë¦¬ ì‚¬ìš©
- **UIStyle ê°ì²´**: ê° í™”ë©´ë‹¹ ì•½ 1-2KB ë©”ëª¨ë¦¬ ì‚¬ìš©
- **í°íŠ¸ ë¡œë”©**: í•œêµ­ì–´ í°íŠ¸ ì•½ 8-10KB ë©”ëª¨ë¦¬ ì‚¬ìš©
- **ì´ ëˆ„ì  ë©”ëª¨ë¦¬**: ì•½ 15-20KB (ESP32-C6ì˜ ì œí•œëœ ë©”ëª¨ë¦¬ì—ì„œ ë¶€ë‹´)

#### 3. **í™”ë©´ ì „í™˜ ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡±**
- **ì´ì „ í™”ë©´ë“¤ì´ ì •ë¦¬ë˜ì§€ ì•ŠìŒ**: `screen_manager.screens` ë”•ì…”ë„ˆë¦¬ì— ê³„ì† ì €ì¥
- **LVGL ê°ì²´ í•´ì œ ì‹¤íŒ¨**: `screen_obj.delete()` í˜¸ì¶œ ì‹œ ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì§€ì—°**: `gc.collect()` í˜¸ì¶œì´ ì¶©ë¶„í•˜ì§€ ì•ŠìŒ

### **í•´ê²° ë°©ì•ˆ êµ¬í˜„**

#### 1. **ì´ì „ í™”ë©´ë“¤ ì •ë¦¬ ë¡œì§ ì¶”ê°€**
```python
# ì´ì „ í™”ë©´ë“¤ ì •ë¦¬ (ë©”ëª¨ë¦¬ ì ˆì•½)
screens_to_remove = ['startup', 'wifi_scan', 'wifi_password', 'meal_time']
for screen_name in screens_to_remove:
    if screen_name in self.screen_manager.screens:
        # í™”ë©´ ê°ì²´ ì •ë¦¬
        screen_obj = self.screen_manager.screens[screen_name]
        if hasattr(screen_obj, 'screen_obj') and screen_obj.screen_obj:
            screen_obj.screen_obj.delete()
        # ë”•ì…”ë„ˆë¦¬ì—ì„œ ì œê±°
        del self.screen_manager.screens[screen_name]
```

#### 2. **ì§€ì—° ë¡œë”© (Lazy Loading) êµ¬í˜„**
```python
# UIStyleê³¼ PillBoxMotorSystemì„ í•„ìš”í•  ë•Œë§Œ ì´ˆê¸°í™”
self.ui_style = None
self.motor_system = None

def _ensure_ui_style(self):
    if self.ui_style is None:
        import gc
        gc.collect()
        self.ui_style = UIStyle()
```

#### 3. **ì•ˆì „í•œ ì˜ˆì™¸ ì²˜ë¦¬**
```python
try:
    screen_obj.screen_obj.delete()
    print(f"í™”ë©´ ê°ì²´ ì‚­ì œ ì™„ë£Œ")
except Exception as delete_error:
    print(f"í™”ë©´ ê°ì²´ ì‚­ì œ ì‹¤íŒ¨: {delete_error}")
    # ì‹¤íŒ¨í•´ë„ ë”•ì…”ë„ˆë¦¬ì—ì„œ ì œê±° ê³„ì† ì§„í–‰
```

### **í˜„ì¬ ì§„í–‰ ìƒí™©**

#### âœ… **ì™„ë£Œëœ ì‘ì—…**
1. **ì´ì „ í™”ë©´ë“¤ ì •ë¦¬ ë¡œì§** ì¶”ê°€
2. **ì§€ì—° ë¡œë”©** êµ¬í˜„ (UIStyle, PillBoxMotorSystem)
3. **ì•ˆì „í•œ ì˜ˆì™¸ ì²˜ë¦¬** êµ¬í˜„
4. **ìƒì„¸í•œ ë¡œê¹…** ì¶”ê°€

#### ğŸ”„ **ì§„í–‰ ì¤‘ì¸ ë¬¸ì œ**
- **í™”ë©´ ì •ë¦¬ ê³¼ì •ì—ì„œ ë©ˆì¶¤**: `startup` í™”ë©´ ì •ë¦¬ ì™„ë£Œ í›„ ë‹¤ìŒ í™”ë©´ ì •ë¦¬ì—ì„œ ë©ˆì¶¤
- **ì˜ˆìƒ ì›ì¸**: `wifi_scan` í™”ë©´ì˜ LVGL ê°ì²´ ì‚­ì œ ì‹œ ë¬¸ì œ ë°œìƒ

#### ğŸ“‹ **ë‹¤ìŒ ë‹¨ê³„**
1. **í™”ë©´ ì •ë¦¬ ê³¼ì • ë””ë²„ê¹…** ê°•í™”
2. **ê° í™”ë©´ ì •ë¦¬ í›„ ì§€ì—°** ì¶”ê°€ (0.01ì´ˆ)
3. **í™”ë©´ ì •ë¦¬ ì‹¤íŒ¨ ì‹œì—ë„ ê³„ì† ì§„í–‰** ë³´ì¥
4. **ë©”ëª¨ë¦¬ ìƒíƒœ ëª¨ë‹ˆí„°ë§** ì¶”ê°€

### **ì˜ˆìƒ ê²°ê³¼**
ì´ì „ í™”ë©´ë“¤ì„ ì •ë¦¬í•˜ì—¬ ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ë¥¼ í™•ë³´í•˜ë©´:
- âœ… `pill_loading` í™”ë©´ ìƒì„± ì„±ê³µ
- âœ… ì •ìƒì ì¸ í™”ë©´ ì „í™˜
- âœ… ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨ í•´ê²°

### **ëª¨ë‹ˆí„°ë§ í¬ì¸íŠ¸**
1. **í™”ë©´ ì •ë¦¬ ê³¼ì •**: ê° í™”ë©´ë³„ ì •ë¦¬ ìƒíƒœ í™•ì¸
2. **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: `micropython.mem_info()` ëª¨ë‹ˆí„°ë§
3. **LVGL ê°ì²´ í•´ì œ**: `screen_obj.delete()` ì„±ê³µ ì—¬ë¶€
4. **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: `gc.collect()` íš¨ê³¼ í™•ì¸

**í˜„ì¬ ë©”ëª¨ë¦¬ í• ë‹¹ ì‹¤íŒ¨ ë¬¸ì œì˜ ê·¼ë³¸ ì›ì¸ì„ íŒŒì•…í•˜ê³  í•´ê²° ë°©ì•ˆì„ êµ¬í˜„ ì¤‘ì…ë‹ˆë‹¤.** ğŸ”§ğŸ“Š

---

## ğŸ” ë‹¤ìŒ í™”ë©´ ì „í™˜ ì‹¤íŒ¨ ì›ì¸ ë¶„ì„ (2025-10-16 ì—…ë°ì´íŠ¸)

### **í˜„ì¬ ìƒí™©**
- **ë©”ëª¨ë¦¬ ìƒíƒœ**: `GC: total: 255808, used: 162016, free: 93792`
- **ì‚¬ìš©ëœ ë©”ëª¨ë¦¬**: 162KB (ì „ì²´ì˜ 63%)
- **ë©ˆì¶¤ ì§€ì **: `PillLoadingScreen` ì„í¬íŠ¸/ìƒì„± ê³¼ì •ì—ì„œ ì •ì§€

### **ë¬¸ì œ ì›ì¸ ë¶„ì„**

#### 1. **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê¸‰ì¦**
```
ì´ˆê¸° ìƒíƒœ: ~50KB ì‚¬ìš©
í˜„ì¬ ìƒíƒœ: 162KB ì‚¬ìš© (3ë°° ì¦ê°€)
ì—¬ìœ  ë©”ëª¨ë¦¬: 93KB (ë¶€ì¡±)
```

#### 2. **PillLoadingScreen ì´ˆê¸°í™” ë¬¸ì œ**
- **ë””ìŠ¤í¬ ìƒíƒœ ë¡œë”©**: `_load_disk_states()` íŒŒì¼ I/O
- **UIStyle ì´ˆê¸°í™”**: ìŠ¤íƒ€ì¼ ê°ì²´ë“¤ ìƒì„±
- **ëª¨í„° ì‹œìŠ¤í…œ ì´ˆê¸°í™”**: `PillBoxMotorSystem` ìƒì„±
- **LVGL ê°ì²´ ìƒì„±**: í™”ë©´ UI ìš”ì†Œë“¤

#### 3. **ë©”ëª¨ë¦¬ ëˆ„ì  íš¨ê³¼**
- **ì´ì „ í™”ë©´ë“¤**: startup, wifi_scan, meal_time, dose_time
- **í°íŠ¸ ë¡œë”©**: í•œêµ­ì–´ í°íŠ¸ (8-10KB)
- **LVGL ê°ì²´ë“¤**: ê° í™”ë©´ë‹¹ 2-3KB
- **ë¬¸ìì—´ ë¦¬í„°ëŸ´**: print ë¬¸ë“¤ì˜ ë¬¸ìì—´ë“¤

### **ì ìš©ëœ í•´ê²° ë°©ì•ˆ**

#### 1. **âœ… LVGL ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê´€ë¦¬**
- **ë¹„ë™ê¸° ê°ì²´ ì‚­ì œ**: `delete_async()` ì‚¬ìš©
- **ìŠ¤íƒ€ì¼ ë¦¬ì†ŒìŠ¤ ì •ë¦¬**: `UIStyle.cleanup()` ì¶”ê°€
- **ë©”ëª¨ë¦¬ ë””ë²„ê¹…**: `micropython.mem_info()` ëª¨ë‹ˆí„°ë§

#### 2. **âœ… PillLoadingScreen ìµœì í™”**
- **ë””ìŠ¤í¬ ìƒíƒœ ì§€ì—° ì´ˆê¸°í™”**: `_ensure_disk_states()` ì¶”ê°€
- **ëª¨í„° ì‹œìŠ¤í…œ ì§€ì—° ì´ˆê¸°í™”**: `_ensure_motor_system()` ìœ ì§€
- **UI ìŠ¤íƒ€ì¼ ì§€ì—° ì´ˆê¸°í™”**: `_ensure_ui_style()` ìœ ì§€

#### 3. **âœ… ê°•í™”ëœ ë©”ëª¨ë¦¬ ì •ë¦¬**
- **5íšŒ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: PillLoadingScreen ì„í¬íŠ¸ ì „
- **ìƒì„¸í•œ ë¡œê¹…**: ê° ë‹¨ê³„ë³„ ì§„í–‰ ìƒí™© ì¶”ì 
- **ëŒ€ì²´ ê²½ë¡œ**: ì‹¤íŒ¨ ì‹œ ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™

### **ì˜ˆìƒ ê²°ê³¼**
- âœ… **PillLoadingScreen ì„í¬íŠ¸ ì„±ê³µ**
- âœ… **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì•ˆì •í™”**
- âœ… **í™”ë©´ ì „í™˜ ì„±ê³µ**
- âœ… **ì‹œìŠ¤í…œ ì•ˆì •ì„± í–¥ìƒ**

### **ëª¨ë‹ˆí„°ë§ í¬ì¸íŠ¸**
1. **ë©”ëª¨ë¦¬ ì •ë¦¬ íš¨ê³¼**: 5íšŒ gc.collect() í›„ ë©”ëª¨ë¦¬ ìƒíƒœ
2. **ì„í¬íŠ¸ ì„±ê³µ ì—¬ë¶€**: PillLoadingScreen í´ë˜ìŠ¤ ë¡œë”©
3. **ì¸ìŠ¤í„´ìŠ¤ ìƒì„±**: PillLoadingScreen ê°ì²´ ìƒì„±
4. **í™”ë©´ ì „í™˜**: pill_loading í™”ë©´ í‘œì‹œ

**ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê¸‰ì¦ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ì•ˆì •ì ì¸ í™”ë©´ ì „í™˜ì„ ë³´ì¥í•©ë‹ˆë‹¤.** ğŸš€ğŸ’¾


ESP-ROM:esp32c6-20220919
Build:Sep 19 2022
rst:0x1 (POWERON),boot:0x2c (SPI_FAST_FLASH_BOOT)
SPIWP:0xee
mode:DIO, clock div:2
load:0x40875720,len:0xed4
load:0x4086c410,len:0xc18
load:0x4086e610,len:0x2b44
entry 0x4086c410
==================================================
ESP32-C6 í•„ë°•ìŠ¤ ë¶€íŒ… ì´ˆê¸°í™”
==================================================
ğŸ§¹ ë¶€íŒ… ì‹œ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
âœ… ë¶€íŒ… ì‹œ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
ìŠ¤í…Œí¼ ëª¨í„° í•€ ì´ˆê¸°í™” ì‹œì‘...
ìŠ¤í…Œí¼ ëª¨í„° í•€ ì´ˆê¸°í™” ì™„ë£Œ (ëª¨ë“  ì½”ì¼ OFF)
  - ëª¨í„° 0: 0x00 (ì½”ì¼ OFF)
  - ëª¨í„° 1: 0x00 (ì½”ì¼ OFF)
  - ëª¨í„° 2: 0x00 (ì½”ì¼ OFF)
  - ëª¨í„° 3: 0x00 (ì½”ì¼ OFF)
ë¶€íŒ… ì´ˆê¸°í™” ì™„ë£Œ
==================================================
ğŸ“¡ WiFi ì´ˆê¸°í™” ì¤‘... (0.5ì´ˆ ëŒ€ê¸°)
âœ… WiFiManager ì´ˆê¸°í™” ì™„ë£Œ (ìë™ ì—°ê²° ì•ˆí•¨)
============================================================
í•„ë°•ìŠ¤ ì‹œìŠ¤í…œ ì‹œì‘
============================================================
ğŸ”§ ìŠ¤í…Œí¼ ëª¨í„° ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘...
âš¡ ëª¨í„° ì½”ì¼ ì´ˆê¸°í™”: ëª¨ë“  ì½”ì¼ OFF ì„¤ì •
  ğŸ” ëª¨í„° ìƒíƒœ: ['0x0', '0x0', '0x0', '0x0']
  ğŸ” ëª¨í„° ìŠ¤í…: [0, 0, 0, 0, 0]
  ğŸ” ì¶œë ¥ ë°ì´í„°: 0x00 0x00
  ğŸ” 74HC595D ì „ì†¡: 0x00 (0b0)
âœ… ëª¨í„° ì½”ì¼ ì´ˆê¸°í™” ì™„ë£Œ: ëª¨ë“  ì½”ì¼ OFF
âœ… StepperMotorController ì´ˆê¸°í™” ì™„ë£Œ
âœ… PillBoxMotorSystem ì´ˆê¸°í™” ì™„ë£Œ
âœ… ìŠ¤í…Œí¼ ëª¨í„° ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ (ëª¨ë“  ì½”ì¼ OFF)
ğŸ“± ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ìë™ ì‹œì‘...
============================================================
í•„ë°•ìŠ¤ startup í™”ë©´ í…ŒìŠ¤íŠ¸
============================================================
ğŸ§¹ LVGL ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì¤‘...
âœ… LVGL ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì™„ë£Œ
âœ… ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
ğŸ§¹ LVGL ì„¤ì • ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
âœ… LVGL ì„¤ì • ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
âš ï¸ LVGLì´ ì´ë¯¸ ì´ˆê¸°í™”ë¨, ì¬ì´ˆê¸°í™” ì‹œë„...
ğŸ§¹ LVGL ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì¤‘...
âœ… LVGL ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì™„ë£Œ
âœ… ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
âœ… LVGL ì´ˆê¸°í™” ì™„ë£Œ
ğŸ§¹ ë””ìŠ¤í”Œë ˆì´ ì´ˆê¸°í™” ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
âœ… ë””ìŠ¤í”Œë ˆì´ ì´ˆê¸°í™” ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
ST7735 ì˜¤í”„ì…‹ ì„¤ì •: X=1, Y=2
ì˜¤í”„ì…‹ ì„¤ì • ì™„ë£Œ: [(1, 2), (1, 2), (1, 2), (1, 2)]
ğŸ§¹ ST7735 ë””ìŠ¤í”Œë ˆì´ ê°ì²´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
âœ… ST7735 ë””ìŠ¤í”Œë ˆì´ ê°ì²´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
âœ… ST7735 ë””ìŠ¤í”Œë ˆì´ ì´ˆê¸°í™” ì™„ë£Œ
âœ… ë””ìŠ¤í”Œë ˆì´ ë“œë¼ì´ë²„ ì´ˆê¸°í™” ì™„ë£Œ
âœ… ScreenManager ì´ˆê¸°í™” ì™„ë£Œ
ğŸ§¹ í™”ë©´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬...
ğŸ“± startup í™”ë©´ ìƒì„± ì¤‘...
âœ… font_notosans_kr_regular í°íŠ¸ ë¡œë“œ ì„±ê³µ
âš ï¸ ê·¸ë¦¼ì ìŠ¤íƒ€ì¼ ë©”ì„œë“œ ì§€ì› ì•ˆë¨, ê±´ë„ˆë›°ê¸°
âœ… UI ìŠ¤íƒ€ì¼ ê°ì²´ë“¤ ìƒì„± ì™„ë£Œ
âœ… UIStyle ì´ˆê¸°í™” ì™„ë£Œ
  ğŸ“± startup Modern í™”ë©´ ìƒì„± ì‹œì‘...
  âœ… ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
  ğŸ“± í™”ë©´ ê°ì²´ ìƒì„±...
  âœ… í™”ë©´ ê°ì²´ ìƒì„± ì™„ë£Œ
  âœ… Modern í™”ë©´ ìƒì„± ì™„ë£Œ
âœ… startup í™”ë©´ ì´ˆê¸°í™” ì™„ë£Œ
âœ… í™”ë©´ ë“±ë¡: startup
âœ… startup í™”ë©´ ìƒì„± ë° ë“±ë¡ ì™„ë£Œ
ğŸ“± startup í™”ë©´ í‘œì‹œ ì¤‘...
âœ… startup í™”ë©´ í‘œì‹œë¨
ğŸ”„ ë°±ê·¸ë¼ìš´ë“œ ì›ì  ë³´ì • ì‹œì‘
ğŸ”§ ë””ìŠ¤í¬ ì›ì  ë³´ì • ì‹œì‘...
âš¡ ëª¨í„° ì½”ì¼ ì´ˆê¸°í™”: ëª¨ë“  ì½”ì¼ OFF ì„¤ì •
  ğŸ” ëª¨í„° ìƒíƒœ: ['0x0', '0x0', '0x0', '0x0']
  ğŸ” ëª¨í„° ìŠ¤í…: [0, 0, 0, 0, 0]
  ğŸ” ì¶œë ¥ ë°ì´í„°: 0x00 0x00
  ğŸ” 74HC595D ì „ì†¡: 0x00 (0b0)
âœ… ëª¨í„° ì½”ì¼ ì´ˆê¸°í™” ì™„ë£Œ: ëª¨ë“  ì½”ì¼ OFF
âœ… StepperMotorController ì´ˆê¸°í™” ì™„ë£Œ
âœ… PillBoxMotorSystem ì´ˆê¸°í™” ì™„ë£Œ
âœ… ëª¨í„° ì‹œìŠ¤í…œ ì§ì ‘ ì´ˆê¸°í™” ì™„ë£Œ
ğŸ”§ 3ê°œ ë””ìŠ¤í¬ ë™ì‹œ ì›ì  ë³´ì • ì¤‘...
ëª¨ë“  ë””ìŠ¤í¬ ë™ì‹œ ì›ì  ë³´ì • ì‹œì‘...
ëª¨í„° [1, 2, 3] ë™ì‹œ ì›ì  ë³´ì • ì‹œì‘...
ëª¨ë“  ëª¨í„° ì •ì§€ (ëª¨ë“  ì½”ì¼ OFF)
âœ… ëª¨í„° 1 ì›ì  ë³´ì • ì™„ë£Œ
âœ… ëª¨í„° 2 ì›ì  ë³´ì • ì™„ë£Œ
âœ… ëª¨í„° 3 ì›ì  ë³´ì • ì™„ë£Œ
ëª¨ë“  ëª¨í„° ì •ì§€ (ëª¨ë“  ì½”ì¼ OFF)
ëª¨í„° [1, 2, 3] ë™ì‹œ ì›ì  ë³´ì • ì™„ë£Œ!
ëª¨ë“  ë””ìŠ¤í¬ ë™ì‹œ ë³´ì • ì™„ë£Œ!
âœ… ëª¨ë“  ë””ìŠ¤í¬ ë™ì‹œ ì›ì  ë³´ì • ì™„ë£Œ!
ğŸ“± startup í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì‹œì‘...
âœ… startup í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ
ğŸ“± í™”ë©´ ì „í™˜: startup
âœ… startup í™”ë©´ ì‹¤í–‰ë¨
ğŸ“± í™”ë©´ì´ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤!
ğŸ® ë²„íŠ¼ ì¡°ì‘ë²•:
   - A: ìœ„/ì´ì „
   - B: ì•„ë˜/ë‹¤ìŒ
   - C: ë’¤ë¡œê°€ê¸°
   - D: ì„ íƒ/í™•ì¸
ğŸ’¡ ì‹¤ì œ ESP32-C6 í•˜ë“œì›¨ì–´ì—ì„œ ë²„íŠ¼ìœ¼ë¡œ ì¡°ì‘í•˜ì„¸ìš”
ğŸ’¡ Ctrl+Cë¡œ ì¢…ë£Œí•˜ì„¸ìš”
ğŸ”˜ ë²„íŠ¼ ì¸í„°í˜ì´ìŠ¤ ì´ˆê¸°í™” ì¤‘...
âœ… ButtonInterface (74HC165) ì´ˆê¸°í™” ì™„ë£Œ
í•€ ì„¤ì •: PL=Pin(15), DATA=Pin(10), CLK=Pin(3)
âœ… ë²„íŠ¼ A ì½œë°± ì„¤ì • ì™„ë£Œ
âœ… ë²„íŠ¼ B ì½œë°± ì„¤ì • ì™„ë£Œ
âœ… ë²„íŠ¼ C ì½œë°± ì„¤ì • ì™„ë£Œ
âœ… ë²„íŠ¼ D ì½œë°± ì„¤ì • ì™„ë£Œ
âœ… ë²„íŠ¼ ì¸í„°í˜ì´ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ
ğŸ”§ ì›ì  ë³´ì • ì™„ë£Œ, WiFi ì—°ê²° ì‹œë„ ì‹œì‘
ğŸ“¡ WiFi ìë™ ì—°ê²° ì‹œë„ ì‹œì‘...
ğŸ“‚ ì €ì¥ëœ WiFi ì„¤ì • ë°œê²¬: outrobot
ğŸ”— WiFi ì—°ê²° ì‹œë„: outrobot
âŒ WiFi ì—°ê²° íƒ€ì„ì•„ì›ƒ: outrobot
âš ï¸ WiFi ìë™ ì—°ê²° ì‹¤íŒ¨ (ì €ì¥ëœ ì„¤ì • ì—†ê±°ë‚˜ ì—°ê²° ì‹¤íŒ¨)
âœ… WiFi ì—°ê²° ì‹œë„ ì™„ë£Œ, Wi-Fi ìŠ¤ìº” í™”ë©´ìœ¼ë¡œ ì´ë™
ğŸ§¹ startup í™”ë©´ ì¢…ë£Œ ì‹œ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
âœ… startup í™”ë©´ ì¢…ë£Œ ì‹œ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
ğŸ“± wifi_scan í™”ë©´ì´ ë“±ë¡ë˜ì§€ ì•ŠìŒ. ë™ì  ìƒì„± ì¤‘...
ğŸ§¹ wifi_scan í™”ë©´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
âœ… wifi_scan í™”ë©´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
âœ… font_notosans_kr_regular í°íŠ¸ ë¡œë“œ ì„±ê³µ
âš ï¸ ê·¸ë¦¼ì ìŠ¤íƒ€ì¼ ë©”ì„œë“œ ì§€ì› ì•ˆë¨, ê±´ë„ˆë›°ê¸°
âœ… UI ìŠ¤íƒ€ì¼ ê°ì²´ë“¤ ìƒì„± ì™„ë£Œ
âœ… UIStyle ì´ˆê¸°í™” ì™„ë£Œ
ğŸ“¡ WiFi ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº” ì¤‘...
  ğŸ“¡ 1ì°¨ ìŠ¤ìº” ì‹œë„...
ğŸ“¡ WiFi ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº” ì‹œì‘...
  ğŸ“¡ WiFi ì¬ì´ˆê¸°í™” ì‹œì‘...
  ğŸ“¡ WiFi í™œì„± ìƒíƒœ: True
  ğŸ“¡ ìŠ¤ìº” ì‹¤í–‰ ì¤‘...
  ğŸ“¡ ì›ì‹œ ìŠ¤ìº” ê²°ê³¼: 2ê°œ
    ğŸ“¡ ìŠ¤ìº” ê²°ê³¼ #1: SSID=outrobot, RSSI=-26, Auth=3
    ğŸ“¡ ìŠ¤ìº” ê²°ê³¼ #2: SSID=joseph, RSSI=-57, Auth=3
âœ… 2ê°œ ë„¤íŠ¸ì›Œí¬ ìŠ¤ìº” ì™„ë£Œ
  1. outrobot (ì‹ í˜¸: -26dBm, ë³´ì•ˆ: WPA2-PSK)
  2. joseph (ì‹ í˜¸: -57dBm, ë³´ì•ˆ: WPA2-PSK)
âœ… 2ê°œ ë„¤íŠ¸ì›Œí¬ ë°œê²¬
  ğŸ“± wifi_scan Modern í™”ë©´ ìƒì„± ì‹œì‘...
  âœ… ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
  ğŸ“± í™”ë©´ ê°ì²´ ìƒì„±...
  ğŸ“± í™”ë©´ ê°ì²´ ìƒì„±ë¨: lvgl obj
  âœ… í™”ë©´ ë°°ê²½ ì„¤ì • ì™„ë£Œ
  ğŸ“± í™”ë©´ í¬ê¸°: 160x128
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ê°ì²´ ìƒì„±ë¨: lvgl obj
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ í¬ê¸° ì„¤ì •: 160x128
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìœ„ì¹˜ ì„¤ì •: CENTER
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì„¤ì • ì™„ë£Œ
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìœ„ì¹˜: (0, 0), í¬ê¸°: 0x0
    âš ï¸ ë©”ì¸ ì»¨í…Œì´ë„ˆ í¬ê¸°ê°€ 0ì…ë‹ˆë‹¤. ê°•ì œë¡œ ë‹¤ì‹œ ì„¤ì •í•©ë‹ˆë‹¤.
    ğŸ“± ì¬ì„¤ì • í›„ ë©”ì¸ ì»¨í…Œì´ë„ˆ í¬ê¸°: 0x0
  ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ
  âš ï¸ ë©”ì¸ ì»¨í…Œì´ë„ˆ ë¬¸ì œë¡œ í™”ë©´ì— ì§ì ‘ ìƒì„±í•©ë‹ˆë‹¤.
  ğŸ“± í™”ë©´ì— ì§ì ‘ ìš”ì†Œë“¤ ìƒì„± ì‹œì‘...
  ğŸ“± ì œëª© í…ìŠ¤íŠ¸ ìƒì„± ì™„ë£Œ (í•œê¸€ í°íŠ¸ ì‚¬ìš©)
  ğŸ“± ìŠ¤ìº” ìƒíƒœ ì•„ì´ì½˜ ì œê±°ë¨
  ğŸ“± LVGL ë¦¬ìŠ¤íŠ¸ ìœ„ì ¯ WiFi ë¦¬ìŠ¤íŠ¸ ìƒì„± ì‹œì‘...
  ğŸ“± LVGL ë¦¬ìŠ¤íŠ¸ ìœ„ì ¯ ìƒì„± ì™„ë£Œ
  ğŸ“± 2ê°œ ë„¤íŠ¸ì›Œí¬ ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„± ì˜ˆì •...
  ğŸ“± ë„¤íŠ¸ì›Œí¬ 1: outrobot ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„± ì¤‘...
  âœ… ë„¤íŠ¸ì›Œí¬ 1 ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„± ì™„ë£Œ
  ğŸ“± ë„¤íŠ¸ì›Œí¬ 2: joseph ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„± ì¤‘...
  âœ… ë„¤íŠ¸ì›Œí¬ 2 ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„± ì™„ë£Œ
  ğŸ“± ì²« ë²ˆì§¸ ì•„ì´í…œ ì„ íƒ ê±´ë„ˆëœ€ (ë©”ì„œë“œ ì—†ìŒ)
  âœ… 2ê°œ LVGL ë¦¬ìŠ¤íŠ¸ WiFi ë„¤íŠ¸ì›Œí¬ ìƒì„± ì™„ë£Œ
  ğŸ“± ëª¨ë˜ WiFi ë¦¬ìŠ¤íŠ¸ ìƒì„± ì™„ë£Œ
  ğŸ“± ë²„íŠ¼ íŒíŠ¸ ìƒì„± ì™„ë£Œ (ê¸°ë³¸ í°íŠ¸ ì‚¬ìš©)
  âœ… Modern í™”ë©´ ìƒì„± ì™„ë£Œ
âœ… wifi_scan í™”ë©´ ì´ˆê¸°í™” ì™„ë£Œ
âœ… í™”ë©´ ë“±ë¡: wifi_scan
âœ… wifi_scan í™”ë©´ ìƒì„± ë° ë“±ë¡ ì™„ë£Œ
ğŸ“± Wi-Fi ìŠ¤ìº” í™”ë©´ìœ¼ë¡œ ì „í™˜
â¹ï¸ ë°±ê·¸ë¼ìš´ë“œ ì›ì  ë³´ì • ì •ì§€
ğŸ“± wifi_scan í™”ë©´ í‘œì‹œ ì‹œì‘...
ğŸ“± í™”ë©´ ê°ì²´ ì¡´ì¬ í™•ì¸ë¨
ğŸ“± í˜„ì¬ í™œì„± í™”ë©´: lvgl obj
âœ… wifi_scan í™”ë©´ ë¡œë“œ ì™„ë£Œ
ğŸ“± ë¡œë“œ í›„ í™œì„± í™”ë©´: lvgl obj
ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìœ„ì¹˜: (0, 0), í¬ê¸°: 0x0
ğŸ“± wifi_scan í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì‹œì‘...
âœ… wifi_scan í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ
ğŸ“± í™”ë©´ ì „í™˜: wifi_scan
ğŸ”˜ ë²„íŠ¼ D (SW4) ëˆŒë¦¼
Wi-Fi ë„¤íŠ¸ì›Œí¬ ì„ íƒ
  ğŸ“± wifi_list_items ì¡´ì¬: True
  ğŸ“± wifi_list_items ê°’: [lvgl obj, lvgl obj]
  ğŸ“± current_selected_index ì¡´ì¬: True
  ğŸ“± current_selected_index ê°’: 0
  ğŸ“± ì¡°ê±´ í†µê³¼ - ë„¤íŠ¸ì›Œí¬ ì„ íƒ ì‹œì‘
  ğŸ“± ì„ íƒëœ ì¸ë±ìŠ¤: 0
  ğŸ“± wifi_networks ê¸¸ì´: 2
  ğŸ“± ì¸ë±ìŠ¤ ë²”ìœ„ í™•ì¸ í†µê³¼
  ğŸ“± ì„ íƒëœ ë„¤íŠ¸ì›Œí¬: outrobot
  ğŸ“± ë³´ì•ˆ íƒ€ì…: WPA2-PSK
  ğŸ“± í˜„ì¬ ì—°ê²° ìƒíƒœ í™•ì¸:
    - ì—°ê²°ë¨: False
    - í˜„ì¬ SSID: None
    - ì„ íƒí•œ SSID: outrobot
    - ê°™ì€ ë„¤íŠ¸ì›Œí¬: False
  ğŸ“± ë³´ì•ˆ í™•ì¸: wpa2-psk
  ğŸ”’ ë³´ì•ˆ ë„¤íŠ¸ì›Œí¬ ê°ì§€: wpa2-psk
ğŸ’¾ ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸ ë°œê²¬: outrobot
  ğŸ’¾ ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš©í•˜ì—¬ ìë™ ì—°ê²° ì‹œë„: outrobot
ğŸ”— WiFi ì—°ê²° ì‹œë„: outrobot
âœ… WiFi ì—°ê²° ì„±ê³µ: outrobot
   IP: 192.168.0.6
   Subnet: 255.255.255.0
   Gateway: 192.168.0.1
   DNS: 172.20.10.1
ğŸ’¾ WiFi ì„¤ì • ì €ì¥ë¨: outrobot
ğŸ• NTP ì‹œê°„ ë™ê¸°í™” ì‹œì‘...
   NTP ì„œë²„ ì—°ê²° ì‹œë„: pool.ntp.org
âœ… ì‹œê°„ ë™ê¸°í™” ì„±ê³µ: pool.ntp.org
   í•œêµ­ ì‹œê°„: (2025, 10, 16, 16, 25, 0, 3, 289)
  âœ… ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸ë¡œ ì—°ê²° ì„±ê³µ!
ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ìœ¼ë¡œ ì´ë™
ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ ë™ì  ìƒì„± ì¤‘...
ğŸ“± meal_time í™”ë©´ ì´ˆê¸°í™” ì™„ë£Œ
âœ… í™”ë©´ ë“±ë¡: meal_time
âœ… ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ ìƒì„± ë° ë“±ë¡ ì™„ë£Œ
ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ìœ¼ë¡œ ì´ë™
ğŸ“± meal_time í™”ë©´ í‘œì‹œ ì‹œì‘...
âš ï¸ í™”ë©´ ê°ì²´ê°€ ì—†ìŠµë‹ˆë‹¤. í™”ë©´ì„ ìƒì„±í•©ë‹ˆë‹¤.
ğŸ“± meal_time í™”ë©´ ìƒì„± ì‹œì‘...
âœ… font_notosans_kr_regular í°íŠ¸ ë¡œë“œ ì„±ê³µ
âš ï¸ ê·¸ë¦¼ì ìŠ¤íƒ€ì¼ ë©”ì„œë“œ ì§€ì› ì•ˆë¨, ê±´ë„ˆë›°ê¸°
âœ… UI ìŠ¤íƒ€ì¼ ê°ì²´ë“¤ ìƒì„± ì™„ë£Œ
âœ… UIStyle ì´ˆê¸°í™” ì™„ë£Œ
âœ… UI ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” ì™„ë£Œ
ğŸ“± meal_time Modern í™”ë©´ ìƒì„± ì‹œì‘...
  ğŸ“± í™”ë©´ ê°ì²´ ìƒì„±...
  ğŸ“± í™”ë©´ ê°ì²´ ìƒì„±ë¨: lvgl obj
  âœ… í™”ë©´ ë°°ê²½ ì„¤ì • ì™„ë£Œ
  ğŸ“± í™”ë©´ í¬ê¸°: 160x128
  ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œë„...
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ê°ì²´ ìƒì„±ë¨: lvgl obj
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ í¬ê¸° ì„¤ì •: 160x128
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìœ„ì¹˜ ì„¤ì •: CENTER
    ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì„¤ì • ì™„ë£Œ
    âš ï¸ get_size() ë©”ì„œë“œ ì§€ì› ì•ˆë¨, í¬ê¸° í™•ì¸ ê±´ë„ˆë›°ê¸°
  ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ
  ğŸ“± ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ
  ğŸ“± ì œëª© ì˜ì—­ ìƒì„± ì‹œë„...
  âœ… ì œëª© ì˜ì—­ ìƒì„± ì™„ë£Œ
  ğŸ“± ì œëª© ì˜ì—­ ìƒì„± ì™„ë£Œ
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì˜ì—­ ìƒì„± ì‹œë„...
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì‘...
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì»¨í…Œì´ë„ˆ ê°ì²´ ìƒì„±ë¨
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì»¨í…Œì´ë„ˆ í¬ê¸° ì„¤ì •: 140x80
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì»¨í…Œì´ë„ˆ ìœ„ì¹˜ ì„¤ì •: CENTER
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì„¤ì • ì™„ë£Œ
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì»¨í…Œì´ë„ˆ ìŠ¤í¬ë¡¤ ì„¤ì • ì™„ë£Œ
  ğŸ“± 3ê°œ ë³µìš© ì‹œê°„ ì˜µì…˜ ìƒì„± ì‹œì‘...
  ğŸ“± ì•„ì¹¨ ì˜µì…˜ ìƒì„± ì¤‘... (y_offset: 0)
  ğŸ“± ì•„ì¹¨ ì²´í¬ë°•ìŠ¤ ê°ì²´ ìƒì„±ë¨
  ğŸ“± ì•„ì¹¨ ì²´í¬ë°•ìŠ¤ ì„¤ì • ì™„ë£Œ
  ğŸ“± ì•„ì¹¨ ë¼ë²¨ ìƒì„± ì¤‘...
  ğŸ“± ì•„ì¹¨ ë¼ë²¨ ìƒì„± ì™„ë£Œ
  ğŸ“± ì•„ì¹¨ í™”ì‚´í‘œ ì œê±°ë¨
  âœ… ì•„ì¹¨ ì˜µì…˜ ìƒì„± ì™„ë£Œ
  ğŸ“± ì ì‹¬ ì˜µì…˜ ìƒì„± ì¤‘... (y_offset: 25)
  ğŸ“± ì ì‹¬ ì²´í¬ë°•ìŠ¤ ê°ì²´ ìƒì„±ë¨
  ğŸ“± ì ì‹¬ ì²´í¬ë°•ìŠ¤ ì„¤ì • ì™„ë£Œ
  ğŸ“± ì ì‹¬ ë¼ë²¨ ìƒì„± ì¤‘...
  ğŸ“± ì ì‹¬ ë¼ë²¨ ìƒì„± ì™„ë£Œ
  ğŸ“± ì ì‹¬ í™”ì‚´í‘œ ì œê±°ë¨
  âœ… ì ì‹¬ ì˜µì…˜ ìƒì„± ì™„ë£Œ
  ğŸ“± ì €ë… ì˜µì…˜ ìƒì„± ì¤‘... (y_offset: 50)
  ğŸ“± ì €ë… ì²´í¬ë°•ìŠ¤ ê°ì²´ ìƒì„±ë¨
  ğŸ“± ì €ë… ì²´í¬ë°•ìŠ¤ ì„¤ì • ì™„ë£Œ
  ğŸ“± ì €ë… ë¼ë²¨ ìƒì„± ì¤‘...
  ğŸ“± ì €ë… ë¼ë²¨ ìƒì„± ì™„ë£Œ
  ğŸ“± ì €ë… í™”ì‚´í‘œ ì œê±°ë¨
  âœ… ì €ë… ì˜µì…˜ ìƒì„± ì™„ë£Œ
  âœ… ë³µìš© ì‹œê°„ ì„ íƒ ì˜ì—­ ìƒì„± ì™„ë£Œ
ğŸ“± í˜„ì¬ ì„ íƒ: ì•„ì¹¨
  ğŸ“± ë³µìš© ì‹œê°„ ì„ íƒ ì˜ì—­ ìƒì„± ì™„ë£Œ
  ğŸ“± ë²„íŠ¼ íŒíŠ¸ ì˜ì—­ ìƒì„± ì‹œë„...
  âœ… ê°„ë‹¨í•œ ë²„íŠ¼ íŒíŠ¸ ìƒì„± ì™„ë£Œ (LVGL ì‹¬ë³¼ ì‚¬ìš©)
  ğŸ“± ë²„íŠ¼ íŒíŠ¸ ì˜ì—­ ìƒì„± ì™„ë£Œ
  âœ… Modern í™”ë©´ ìƒì„± ì™„ë£Œ
âœ… meal_time í™”ë©´ ìƒì„± ì™„ë£Œ
ğŸ“± í™”ë©´ ê°ì²´ ì¡´ì¬ í™•ì¸ë¨
ğŸ“± í˜„ì¬ í™œì„± í™”ë©´: lvgl obj
âœ… meal_time í™”ë©´ ë¡œë“œ ì™„ë£Œ
ğŸ“± ë¡œë“œ í›„ í™œì„± í™”ë©´: lvgl obj
ğŸ“± í™”ë©´ ì „í™˜: meal_time
ğŸ”˜ ë²„íŠ¼ C (SW3) ëˆŒë¦¼
ğŸ”˜ ë²„íŠ¼ C (SW3) ëˆŒë¦¼ - OK/ì²´í¬ë°•ìŠ¤ í† ê¸€
ğŸ“± breakfast ì„ íƒ
ğŸ”˜ ë²„íŠ¼ D (SW4) ëˆŒë¦¼
ğŸ”˜ ë²„íŠ¼ D (SW4) ëˆŒë¦¼ - ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì´ë™
ğŸ“± ì„ íƒëœ ë³µìš© ì‹œê°„ ê°œìˆ˜: 1
ğŸ“± ì„ íƒëœ ë³µìš© ì‹œê°„ì´ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
ğŸ“± ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ ì •ë³´ ìƒì„±: 1ê°œ (ì•„ì¹¨, ì ì‹¬, ì €ë… ìˆœì„œ)
  - ì•„ì¹¨: ê¸°ë³¸ ì‹œê°„ 08:00
ğŸ“± ì „ë‹¬í•  ì‹ì‚¬ ì‹œê°„ ì •ë³´: [{'default_minute': 0, 'default_hour': 8, 'key': 'breakfast', 'name': '\uc544\uce68'}]
ğŸ“± dose_time í™”ë©´ì´ ë“±ë¡ë˜ì§€ ì•ŠìŒ. ë™ì  ìƒì„± ì¤‘...
âœ… font_notosans_kr_regular í°íŠ¸ ë¡œë“œ ì„±ê³µ
âš ï¸ ê·¸ë¦¼ì ìŠ¤íƒ€ì¼ ë©”ì„œë“œ ì§€ì› ì•ˆë¨, ê±´ë„ˆë›°ê¸°
âœ… UI ìŠ¤íƒ€ì¼ ê°ì²´ë“¤ ìƒì„± ì™„ë£Œ
âœ… UIStyle ì´ˆê¸°í™” ì™„ë£Œ
ğŸ“± ì²« ë²ˆì§¸ ì‹ì‚¬ ì‹œê°„ ê¸°ë³¸ê°’ ì„¤ì •: 08:00 (ì•„ì¹¨)
  ğŸ“± dose_time ê°„ë‹¨í•œ í™”ë©´ ìƒì„± ì‹œì‘...
ğŸ“± ì œëª© ì—…ë°ì´íŠ¸: ì•„ì¹¨ - ì‹œê°„ ì„¤ì •
  ğŸ“± ì‹œê°„ ë¡¤ëŸ¬ ìƒì„± ì¤‘...
  âœ… ì‹œê°„ ë¡¤ëŸ¬ ìƒì„± ì™„ë£Œ
  ğŸ“± ë¶„ ë¡¤ëŸ¬ ìƒì„± ì¤‘...
  âœ… ë¶„ ë¡¤ëŸ¬ ìƒì„± ì™„ë£Œ
  âœ… ê°„ë‹¨í•œ í™”ë©´ ìƒì„± ì™„ë£Œ
  ğŸ“± ì‹œê°„ í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜
  ğŸ“± ì œëª© ì—…ë°ì´íŠ¸ ì‹œì‘ - current_dose_index: 0, editing_hour: True
  ğŸ“± selected_meals ê¸¸ì´: 1
  ğŸ“± ì œëª© ì—…ë°ì´íŠ¸ ì™„ë£Œ: ì•„ì¹¨ - ì‹œê°„ ì„¤ì •
âœ… dose_time í™”ë©´ ì´ˆê¸°í™” ì™„ë£Œ (ë³µìš© íšŸìˆ˜: 1)
ğŸ“± ì„ íƒëœ ì‹ì‚¬ ì‹œê°„: ['\uc544\uce68']
âœ… í™”ë©´ ë“±ë¡: dose_time
âœ… dose_time í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
ğŸ“± meal_time í™”ë©´ ìˆ¨ê¸°ê¸°
ğŸ“± dose_time í™”ë©´ í‘œì‹œ ì‹œì‘...
ğŸ“± í™”ë©´ ê°ì²´ ì¡´ì¬ í™•ì¸ë¨
âœ… dose_time í™”ë©´ ë¡œë“œ ì™„ë£Œ
ğŸ“± dose_time í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì‹œì‘...
  ğŸ“± ì—…ë°ì´íŠ¸ 1/5
  ğŸ“± ì—…ë°ì´íŠ¸ 2/5
  ğŸ“± ì—…ë°ì´íŠ¸ 3/5
  ğŸ“± ì—…ë°ì´íŠ¸ 4/5
  ğŸ“± ì—…ë°ì´íŠ¸ 5/5
âœ… dose_time í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ
ğŸ“± ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ ì‹¤í–‰...
âš ï¸ ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ ì˜¤ë¥˜ (ë¬´ì‹œ): 'module' object has no attribute 'disp'
âœ… dose_time í™”ë©´ ì‹¤í–‰ë¨
ğŸ“± í™”ë©´ ì „í™˜: dose_time
ğŸ”˜ ë²„íŠ¼ D (SW4) ëˆŒë¦¼
  ğŸ“± ë¶„ í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜
  ğŸ“± ì œëª© ì—…ë°ì´íŠ¸ ì‹œì‘ - current_dose_index: 0, editing_hour: False
  ğŸ“± selected_meals ê¸¸ì´: 1
  ğŸ“± ì œëª© ì—…ë°ì´íŠ¸ ì™„ë£Œ: ì•„ì¹¨ - ë¶„ ì„¤ì •
  ğŸ“± ì‹œê°„ 08ì‹œ ì„¤ì • ì™„ë£Œ, ë¶„ ì„¤ì •ìœ¼ë¡œ ì´ë™
ğŸ”˜ ë²„íŠ¼ D (SW4) ëˆŒë¦¼
  ğŸ“± ì•„ì¹¨ ì‹œê°„ ì €ì¥: 08:00
  ğŸ“± ëª¨ë“  ë³µìš© ì‹œê°„ ì„¤ì • ì™„ë£Œ!
  ğŸ“± ì„¤ì •ëœ ì‹œê°„ë“¤: [{'hour': 8, 'meal_name': '\uc544\uce68', 'minute': 0, 'time': '08:00', 'meal_key': 'breakfast'}]
  ğŸ“± pill_loading í™”ë©´ì´ ë“±ë¡ë˜ì§€ ì•ŠìŒ. ë™ì  ìƒì„± ì¤‘...
  ğŸ“± í˜„ì¬ dose_time í™”ë©´ ì™„ì „ ì •ë¦¬ ì‹œì‘...
ğŸ“± dose_time í™”ë©´ ìˆ¨ê¹€
  ğŸ“± dose_time í™”ë©´ ê°ì²´ ì‚­ì œ ì™„ë£Œ
  ğŸ§¹ pill_loading í™”ë©´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
  âœ… pill_loading í™”ë©´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
stack: 2020 out of 15360
GC: total: 255808, used: 158624, free: 97184, max new split: 24064
 No. of 1-blocks: 1653, 2-blocks: 341, max blk sz: 641, max free sz: 266
  ğŸ“± pill_loading í™”ë©´ ìƒì„± ëŒ€ì•ˆ ì‹œë„...
  ğŸ§¹ ìƒˆë¡œìš´ í™”ë©´ ìƒì„± ì „ ë©”ëª¨ë¦¬ ì •ë¦¬...
  âœ… ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
  ğŸ“± PillLoadingScreen í´ë˜ìŠ¤ ì„í¬íŠ¸ ì‹œì‘...

"""
ë³µìš© ì‹œê°„ ì„¤ì • í™”ë©´
ê° ë³µìš© ì‹œê°„ì„ ì„¤ì •í•˜ëŠ” í™”ë©´ (ë¡¤ëŸ¬ UI ìŠ¤íƒ€ì¼)
"""

import time
import lvgl as lv
from ui_style import UIStyle

class DoseTimeScreen:
    """ë³µìš© ì‹œê°„ ì„¤ì • í™”ë©´ í´ë˜ìŠ¤ - ë¡¤ëŸ¬ UI ìŠ¤íƒ€ì¼"""
    
    def __init__(self, screen_manager, dose_count=1, selected_meals=None):
        """ë³µìš© ì‹œê°„ ì„¤ì • í™”ë©´ ì´ˆê¸°í™”"""
        self.screen_manager = screen_manager
        self.screen_name = 'dose_time'
        self.screen_obj = None
        self.dose_count = dose_count
        self.selected_meals = selected_meals or []  # ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ ì •ë³´
        self.dose_times = []  # ì„¤ì •ëœ ë³µìš© ì‹œê°„ë“¤
        self.current_dose_index = 0  # í˜„ì¬ ì„¤ì • ì¤‘ì¸ ë³µìš© ì‹œê°„ ì¸ë±ìŠ¤
        self.current_hour = 8  # ê¸°ë³¸ê°’: ì˜¤ì „ 8ì‹œ
        self.current_minute = 0  # ê¸°ë³¸ê°’: 0ë¶„
        self.editing_hour = True  # True: ì‹œê°„ í¸ì§‘, False: ë¶„ í¸ì§‘
        
        # ë¡¤ëŸ¬ ê°ì²´ë“¤
        self.hour_roller = None
        self.minute_roller = None
        
        # UI ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        self.ui_style = UIStyle()
        
        # ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ì— ë”°ë¼ ê¸°ë³¸ ì‹œê°„ ì„¤ì •
        self._set_default_time_from_meals()
        
        # ê°„ë‹¨í•œ í™”ë©´ ìƒì„±
        self._create_simple_screen()
        
        print(f"âœ… {self.screen_name} í™”ë©´ ì´ˆê¸°í™” ì™„ë£Œ (ë³µìš© íšŸìˆ˜: {dose_count})")
        if self.selected_meals:
            print(f"ğŸ“± ì„ íƒëœ ì‹ì‚¬ ì‹œê°„: {[meal['name'] for meal in self.selected_meals]}")
    
    def _set_default_time_from_meals(self):
        """ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ì— ë”°ë¼ ê¸°ë³¸ ì‹œê°„ ì„¤ì •"""
        try:
            if self.selected_meals and len(self.selected_meals) > 0:
                # ì²« ë²ˆì§¸ ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ì˜ ê¸°ë³¸ ì‹œê°„ ì‚¬ìš©
                first_meal = self.selected_meals[0]
                self.current_hour = first_meal.get('default_hour', 8)
                self.current_minute = first_meal.get('default_minute', 0)
                print(f"ğŸ“± ì²« ë²ˆì§¸ ì‹ì‚¬ ì‹œê°„ ê¸°ë³¸ê°’ ì„¤ì •: {self.current_hour:02d}:{self.current_minute:02d} ({first_meal['name']})")
            else:
                # ê¸°ë³¸ê°’ ìœ ì§€
                print(f"ğŸ“± ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ì´ ì—†ì–´ ê¸°ë³¸ê°’ ì‚¬ìš©: {self.current_hour:02d}:{self.current_minute:02d}")
        except Exception as e:
            print(f"âŒ ê¸°ë³¸ ì‹œê°„ ì„¤ì • ì‹¤íŒ¨: {e}")
    
    def _update_title_text(self):
        """ì œëª© í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸"""
        try:
            if self.selected_meals and self.current_dose_index < len(self.selected_meals):
                # ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ì´ ìˆìœ¼ë©´ í•´ë‹¹ ì‹ì‚¬ ì‹œê°„ í‘œì‹œ
                current_meal = self.selected_meals[self.current_dose_index]
                title_text = f"{current_meal['name']} - ì‹œê°„ ì„¤ì •"
            else:
                # ê¸°ë³¸ ì œëª©
                title_text = f"ë³µìš© ì‹œê°„ {self.current_dose_index + 1}"
            
            if hasattr(self, 'title_label') and self.title_label:
                self.title_label.set_text(title_text)
                print(f"ğŸ“± ì œëª© ì—…ë°ì´íŠ¸: {title_text}")
        except Exception as e:
            print(f"âŒ ì œëª© í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
    
    def _create_simple_screen(self):
        """ê°„ë‹¨í•œ í™”ë©´ ìƒì„±"""
        print(f"  ğŸ“± {self.screen_name} ê°„ë‹¨í•œ í™”ë©´ ìƒì„± ì‹œì‘...")
        
        try:
            # ë©”ëª¨ë¦¬ ì •ë¦¬
            import gc
            gc.collect()
            
            # í™”ë©´ ìƒì„±
            self.screen_obj = lv.obj()
            self.screen_obj.set_size(160, 128)
            self.screen_obj.set_style_bg_color(lv.color_hex(0xFFFFFF), 0)
            
            # ì œëª©
            self.title_label = lv.label(self.screen_obj)
            self._update_title_text()
            self.title_label.align(lv.ALIGN.TOP_MID, 0, 10)
            self.title_label.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            
            # í•œêµ­ì–´ í°íŠ¸ ì ìš©
            korean_font = getattr(lv, "font_notosans_kr_regular", None)
            if korean_font:
                self.title_label.set_style_text_font(korean_font, 0)
            
            # ì‹œê°„ ë¡¤ëŸ¬ ìƒì„±
            print("  ğŸ“± ì‹œê°„ ë¡¤ëŸ¬ ìƒì„± ì¤‘...")
            self.hour_roller = lv.roller(self.screen_obj)
            self.hour_roller.set_size(50, 60)
            self.hour_roller.align(lv.ALIGN.CENTER, -30, 0)
            
            # ì‹œê°„ ì˜µì…˜ ì„¤ì •
            hours = [f"{i:02d}" for i in range(24)]
            self.hour_roller.set_options("\n".join(hours), lv.roller.MODE.INFINITE)
            self.hour_roller.set_selected(self.current_hour, True)
            
            # ì‹œê°„ ë¡¤ëŸ¬ ìŠ¤íƒ€ì¼
            self.hour_roller.set_style_bg_color(lv.color_hex(0xF2F2F7), 0)
            self.hour_roller.set_style_border_width(0, 0)
            self.hour_roller.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            
            if korean_font:
                self.hour_roller.set_style_text_font(korean_font, 0)
            
            # ë¡¤ëŸ¬ ì„ íƒëœ í•­ëª© ìŠ¤íƒ€ì¼ - ë¡œê³  ìƒ‰ìƒ(ë¯¼íŠ¸)
            try:
                self.hour_roller.set_style_bg_color(lv.color_hex(0x00C9A7), lv.PART.SELECTED)
                self.hour_roller.set_style_bg_opa(255, lv.PART.SELECTED)
                self.hour_roller.set_style_text_color(lv.color_hex(0xFFFFFF), lv.PART.SELECTED)
                self.hour_roller.set_style_radius(6, lv.PART.SELECTED)
            except AttributeError:
                pass
            
            print("  âœ… ì‹œê°„ ë¡¤ëŸ¬ ìƒì„± ì™„ë£Œ")
            
            # ë©”ëª¨ë¦¬ ì •ë¦¬
            import gc
            gc.collect()
            
            # ì½œë¡  í‘œì‹œ
            self.colon_label = lv.label(self.screen_obj)
            self.colon_label.set_text(":")
            self.colon_label.align(lv.ALIGN.CENTER, 0, 0)
            self.colon_label.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            
            if korean_font:
                self.colon_label.set_style_text_font(korean_font, 0)
            
            # ë¶„ ë¡¤ëŸ¬ ìƒì„±
            print("  ğŸ“± ë¶„ ë¡¤ëŸ¬ ìƒì„± ì¤‘...")
            self.minute_roller = lv.roller(self.screen_obj)
            self.minute_roller.set_size(50, 60)
            self.minute_roller.align(lv.ALIGN.CENTER, 30, 0)
            
            # ë¶„ ì˜µì…˜ ì„¤ì •
            minutes = [f"{i:02d}" for i in range(0, 60, 5)]
            self.minute_roller.set_options("\n".join(minutes), lv.roller.MODE.INFINITE)
            self.minute_roller.set_selected(self.current_minute // 5, True)
            
            # ë¶„ ë¡¤ëŸ¬ ìŠ¤íƒ€ì¼
            self.minute_roller.set_style_bg_color(lv.color_hex(0xF2F2F7), 0)
            self.minute_roller.set_style_border_width(0, 0)
            self.minute_roller.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            
            if korean_font:
                self.minute_roller.set_style_text_font(korean_font, 0)
            
            # ë¡¤ëŸ¬ ì„ íƒëœ í•­ëª© ìŠ¤íƒ€ì¼ - ë¡œê³  ìƒ‰ìƒ(ë¯¼íŠ¸)
            try:
                self.minute_roller.set_style_bg_color(lv.color_hex(0x00C9A7), lv.PART.SELECTED)
                self.minute_roller.set_style_bg_opa(255, lv.PART.SELECTED)
                self.minute_roller.set_style_text_color(lv.color_hex(0xFFFFFF), lv.PART.SELECTED)
                self.minute_roller.set_style_radius(6, lv.PART.SELECTED)
            except AttributeError:
                pass
            
            print("  âœ… ë¶„ ë¡¤ëŸ¬ ìƒì„± ì™„ë£Œ")
            
            # ë©”ëª¨ë¦¬ ì •ë¦¬
            import gc
            gc.collect()
            
            # ë²„íŠ¼ íŒíŠ¸ (ë³µìš© íšŸìˆ˜ í™”ë©´ê³¼ ë™ì¼í•œ ìœ„ì¹˜ ë° ìƒ‰ìƒ)
            self.hints_label = lv.label(self.screen_obj)
            self.hints_label.set_text(f"A:{lv.SYMBOL.UP} B:{lv.SYMBOL.DOWN} C:{lv.SYMBOL.PREV} D:{lv.SYMBOL.OK}")
            self.hints_label.align(lv.ALIGN.BOTTOM_MID, 0, -2)  # -5 â†’ -2ë¡œ ë³€ê²½
            self.hints_label.set_style_text_color(lv.color_hex(0x8E8E93), 0)  # 0x007AFF â†’ 0x8E8E93 (ëª¨ë˜ ë¼ì´íŠ¸ ê·¸ë ˆì´)
            self.hints_label.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
            
            print(f"  âœ… ê°„ë‹¨í•œ í™”ë©´ ìƒì„± ì™„ë£Œ")
            
            # ì´ˆê¸° ë¡¤ëŸ¬ ê°€ì‹œì„±ê³¼ ì œëª© ì„¤ì •
            self._update_roller_visibility()
            self._update_title()
            
        except Exception as e:
            print(f"  âŒ í™”ë©´ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
            import sys
            sys.print_exception(e)
    
    def on_button_a(self):
        """A ë²„íŠ¼: ìœ„ë¡œ ì´ë™"""
        try:
            if self.editing_hour and hasattr(self, 'hour_roller') and self.hour_roller:
                current_selected = self.hour_roller.get_selected()
                self.hour_roller.set_selected(current_selected - 1, True)
                self._update_time_from_rollers()
                print(f"  ğŸ“± ì‹œê°„ ë³€ê²½: {self.current_hour:02d}:{self.current_minute:02d}")
            elif not self.editing_hour and hasattr(self, 'minute_roller') and self.minute_roller:
                current_selected = self.minute_roller.get_selected()
                self.minute_roller.set_selected(current_selected - 1, True)
                self._update_time_from_rollers()
                print(f"  ğŸ“± ì‹œê°„ ë³€ê²½: {self.current_hour:02d}:{self.current_minute:02d}")
            else:
                print(f"  âš ï¸ ë¡¤ëŸ¬ ê°ì²´ê°€ ì—†ìŠµë‹ˆë‹¤. editing_hour: {self.editing_hour}")
        except Exception as e:
            print(f"  âŒ A ë²„íŠ¼ ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
    
    def on_button_b(self):
        """B ë²„íŠ¼: ì•„ë˜ë¡œ ì´ë™"""
        try:
            if self.editing_hour and hasattr(self, 'hour_roller') and self.hour_roller:
                current_selected = self.hour_roller.get_selected()
                self.hour_roller.set_selected(current_selected + 1, True)
                self._update_time_from_rollers()
                print(f"  ğŸ“± ì‹œê°„ ë³€ê²½: {self.current_hour:02d}:{self.current_minute:02d}")
            elif not self.editing_hour and hasattr(self, 'minute_roller') and self.minute_roller:
                current_selected = self.minute_roller.get_selected()
                self.minute_roller.set_selected(current_selected + 1, True)
                self._update_time_from_rollers()
                print(f"  ğŸ“± ì‹œê°„ ë³€ê²½: {self.current_hour:02d}:{self.current_minute:02d}")
        except Exception as e:
            print(f"  âŒ B ë²„íŠ¼ ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
    
    def on_button_c(self):
        """C ë²„íŠ¼: ë’¤ë¡œê°€ê¸° - ë‹¨ê³„ë³„ ë˜ëŒì•„ê°€ê¸°"""
        try:
            if self.editing_hour:
                # ì‹œê°„ ì„¤ì • ì¤‘ì´ë©´ ì´ì „ ë³µìš© ì‹œê°„ìœ¼ë¡œ ë˜ëŒì•„ê°€ê¸°
                if self.current_dose_index > 0:
                    # ì´ì „ ë³µìš© ì‹œê°„ìœ¼ë¡œ ë˜ëŒì•„ê°€ê¸°
                    self.current_dose_index -= 1
                    self._setup_current_dose_time()
                    print(f"  ğŸ“± ì´ì „ ë³µìš© ì‹œê°„ìœ¼ë¡œ ë˜ëŒì•„ê°€ê¸°: {self.current_dose_index + 1}ë²ˆì§¸")
                else:
                    # ì²« ë²ˆì§¸ ë³µìš© ì‹œê°„ì´ë©´ ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ìœ¼ë¡œ
                    print(f"  ğŸ“± ë’¤ë¡œê°€ê¸° - ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ìœ¼ë¡œ ì´ë™")
                    if 'meal_time' in self.screen_manager.screens:
                        self.screen_manager.show_screen('meal_time')
                        print(f"  âœ… ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ìœ¼ë¡œ ì´ë™ ì™„ë£Œ")
                    else:
                        print(f"  âŒ ë³µìš© ì‹œê°„ ì„ íƒ í™”ë©´ì´ ë“±ë¡ë˜ì§€ ì•ŠìŒ")
            else:
                # ë¶„ ì„¤ì • ì¤‘ì´ë©´ ì‹œê°„ ì„¤ì •ìœ¼ë¡œ ë˜ëŒì•„ê°€ê¸°
                print(f"  ğŸ“± ë’¤ë¡œê°€ê¸° - ì‹œê°„ ì„¤ì •ìœ¼ë¡œ ë˜ëŒì•„ê°€ê¸°")
                self.editing_hour = True
                self._update_roller_visibility()
                self._update_title()
                print(f"  âœ… ì‹œê°„ ì„¤ì • ëª¨ë“œë¡œ ì „í™˜ ì™„ë£Œ")
                    
        except Exception as e:
            print(f"  âŒ C ë²„íŠ¼ ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
    
    def _update_roller_visibility(self):
        """ì‹œê°„/ë¶„ í¸ì§‘ ëª¨ë“œì— ë”°ë¼ ë¡¤ëŸ¬ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸"""
        try:
            if self.editing_hour:
                # ì‹œê°„ í¸ì§‘ ëª¨ë“œ: ì‹œê°„ ë¡¤ëŸ¬ ê°•ì¡°
                if self.hour_roller:
                    self.hour_roller.set_style_border_width(2, 0)
                    self.hour_roller.set_style_border_color(lv.color_hex(0x00C9A7), 0)
                if self.minute_roller:
                    self.minute_roller.set_style_border_width(0, 0)
                print(f"  ğŸ“± ì‹œê°„ í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜")
            else:
                # ë¶„ í¸ì§‘ ëª¨ë“œ: ë¶„ ë¡¤ëŸ¬ ê°•ì¡°
                if self.hour_roller:
                    self.hour_roller.set_style_border_width(0, 0)
                if self.minute_roller:
                    self.minute_roller.set_style_border_width(2, 0)
                    self.minute_roller.set_style_border_color(lv.color_hex(0x00C9A7), 0)
                print(f"  ğŸ“± ë¶„ í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜")
        except Exception as e:
            print(f"  âŒ ë¡¤ëŸ¬ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
    
    def _update_title(self):
        """í˜„ì¬ í¸ì§‘ ëª¨ë“œì— ë”°ë¼ ì œëª© ì—…ë°ì´íŠ¸"""
        try:
            if hasattr(self, 'title_label'):
                print(f"  ğŸ“± ì œëª© ì—…ë°ì´íŠ¸ ì‹œì‘ - current_dose_index: {self.current_dose_index}, editing_hour: {self.editing_hour}")
                print(f"  ğŸ“± selected_meals ê¸¸ì´: {len(self.selected_meals) if self.selected_meals else 0}")
                
                if self.selected_meals and self.current_dose_index < len(self.selected_meals):
                    meal_name = self.selected_meals[self.current_dose_index]['name']
                    if self.editing_hour:
                        new_title = f"{meal_name} - ì‹œê°„ ì„¤ì •"
                    else:
                        new_title = f"{meal_name} - ë¶„ ì„¤ì •"
                    
                    self.title_label.set_text(new_title)
                    print(f"  ğŸ“± ì œëª© ì—…ë°ì´íŠ¸ ì™„ë£Œ: {new_title}")
                else:
                    print(f"  âŒ ì œëª© ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: ì¸ë±ìŠ¤ ë²”ìœ„ ì´ˆê³¼")
        except Exception as e:
            print(f"  âŒ ì œëª© ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def _setup_current_dose_time(self):
        """í˜„ì¬ ë³µìš© ì‹œê°„ ì„¤ì •"""
        try:
            # ì´ë¯¸ ì €ì¥ëœ ì‹œê°„ ì •ë³´ê°€ ìˆëŠ”ì§€ í™•ì¸
            saved_time = None
            if self.selected_meals and self.current_dose_index < len(self.selected_meals):
                current_meal = self.selected_meals[self.current_dose_index]
                meal_key = current_meal['key']
                
                # dose_timesì—ì„œ í•´ë‹¹ ì‹ì‚¬ ì‹œê°„ì˜ ì €ì¥ëœ ì •ë³´ ì°¾ê¸°
                for dose_time in self.dose_times:
                    if dose_time.get('meal_key') == meal_key:
                        saved_time = dose_time
                        break
            
            if saved_time:
                # ì €ì¥ëœ ì‹œê°„ ì •ë³´ ì‚¬ìš©
                self.current_hour = saved_time['hour']
                self.current_minute = saved_time['minute']
                print(f"  ğŸ“± ì €ì¥ëœ ì‹œê°„ ì •ë³´ ì‚¬ìš©: {self.current_hour:02d}:{self.current_minute:02d} ({saved_time['meal_name']})")
            else:
                # ì €ì¥ëœ ì •ë³´ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
                if self.selected_meals and self.current_dose_index < len(self.selected_meals):
                    current_meal = self.selected_meals[self.current_dose_index]
                    self.current_hour = current_meal.get('default_hour', 8)
                    self.current_minute = current_meal.get('default_minute', 0)
                    print(f"  ğŸ“± ê¸°ë³¸ê°’ ì‚¬ìš©: {self.current_hour:02d}:{self.current_minute:02d} ({current_meal['name']})")
                else:
                    # ê¸°ë³¸ê°’ìœ¼ë¡œ ë¦¬ì…‹
                    self.current_hour = 8
                    self.current_minute = 0
            
            # ì‹œê°„ í¸ì§‘ ëª¨ë“œë¡œ ë¦¬ì…‹
            self.editing_hour = True
            
            # ë¡¤ëŸ¬ ê°’ ì—…ë°ì´íŠ¸
            if hasattr(self, 'hour_roller') and hasattr(self, 'minute_roller'):
                self.hour_roller.set_selected(self.current_hour, True)
                self.minute_roller.set_selected(self.current_minute, True)
            
            # ì œëª©ê³¼ ë¡¤ëŸ¬ í¬ì»¤ìŠ¤ ì—…ë°ì´íŠ¸
            self._update_title()
            self._update_roller_visibility()
            
            print(f"  âœ… í˜„ì¬ ë³µìš© ì‹œê°„ ì„¤ì • ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ í˜„ì¬ ë³µìš© ì‹œê°„ ì„¤ì • ì‹¤íŒ¨: {e}")
    
    def on_button_d(self):
        """D ë²„íŠ¼: ì„ íƒ/í™•ì¸ - ì‹œê°„/ë¶„ ëª¨ë“œ ì „í™˜ ë˜ëŠ” ë‹¤ìŒ ë‹¨ê³„"""
        try:
            if self.editing_hour:
                # ì‹œê°„ ì„¤ì • ì™„ë£Œ, ë¶„ ì„¤ì •ìœ¼ë¡œ ì´ë™
                self.editing_hour = False
                self._update_roller_visibility()
                self._update_title()
                self._update_roller_options()
                print(f"  ğŸ“± ì‹œê°„ {self.current_hour:02d}ì‹œ ì„¤ì • ì™„ë£Œ, ë¶„ ì„¤ì •ìœ¼ë¡œ ì´ë™")
            else:
                # ë¶„ ì„¤ì • ì™„ë£Œ, ì‹œê°„ ì €ì¥í•˜ê³  ë‹¤ìŒ ë‹¨ê³„
                self._save_current_time()
                self._next_time_setup()
        except Exception as e:
            print(f"  âŒ D ë²„íŠ¼ ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
    
    def _update_time_from_rollers(self):
        """ë¡¤ëŸ¬ì—ì„œ ì„ íƒëœ ê°’ì„ ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸"""
        try:
            if hasattr(self, 'hour_roller') and hasattr(self, 'minute_roller'):
                self.current_hour = self.hour_roller.get_selected()
                self.current_minute = self.minute_roller.get_selected() * 5  # 5ë¶„ ê°„ê²©
        except Exception as e:
            print(f"  âŒ ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
    
    def _update_roller_options(self):
        """ë¡¤ëŸ¬ ì˜µì…˜ ì—…ë°ì´íŠ¸"""
        try:
            # ì œëª© ì—…ë°ì´íŠ¸
            if hasattr(self, 'title_label'):
                if self.selected_meals and self.current_dose_index < len(self.selected_meals):
                    current_meal = self.selected_meals[self.current_dose_index]
                    if self.editing_hour:
                        self.title_label.set_text(f"{current_meal['name']} - ì‹œê°„ ì„¤ì •")
                    else:
                        self.title_label.set_text(f"{current_meal['name']} - ë¶„ ì„¤ì •")
                else:
                    if self.editing_hour:
                        self.title_label.set_text(f"ë³µìš© ì‹œê°„ {self.current_dose_index + 1} - ì‹œê°„ ì„¤ì •")
                    else:
                        self.title_label.set_text(f"ë³µìš© ì‹œê°„ {self.current_dose_index + 1} - ë¶„ ì„¤ì •")
            
        except Exception as e:
            print(f"  âŒ ë¡¤ëŸ¬ ì˜µì…˜ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
    
    def _save_current_time(self):
        """í˜„ì¬ ì„¤ì •ëœ ì‹œê°„ ì €ì¥"""
        try:
            self._update_time_from_rollers()
            time_str = f"{self.current_hour:02d}:{self.current_minute:02d}"
            
            # ì‹ì‚¬ ì‹œê°„ ì •ë³´ì™€ í•¨ê»˜ ì €ì¥
            if self.selected_meals and self.current_dose_index < len(self.selected_meals):
                current_meal = self.selected_meals[self.current_dose_index]
                dose_info = {
                    'time': time_str,
                    'meal_key': current_meal['key'],
                    'meal_name': current_meal['name'],
                    'hour': self.current_hour,
                    'minute': self.current_minute
                }
                self.dose_times.append(dose_info)
                print(f"  ğŸ“± {current_meal['name']} ì‹œê°„ ì €ì¥: {time_str}")
            else:
                # ê¸°ë³¸ ì €ì¥ ë°©ì‹
                self.dose_times.append(time_str)
                print(f"  ğŸ“± ë³µìš© ì‹œê°„ {self.current_dose_index + 1} ì €ì¥: {time_str}")
        except Exception as e:
            print(f"  âŒ ì‹œê°„ ì €ì¥ ì‹¤íŒ¨: {e}")
    
    def _next_time_setup(self):
        """ë‹¤ìŒ ë³µìš© ì‹œê°„ ì„¤ì • ë˜ëŠ” ì™„ë£Œ"""
        try:
            self.current_dose_index += 1
            
            if self.current_dose_index < self.dose_count:
                # ë‹¤ìŒ ë³µìš© ì‹œê°„ ì„¤ì •
                self.editing_hour = True  # ë‹¤ì‹œ ì‹œê°„ í¸ì§‘ ëª¨ë“œë¡œ
                
                # ë‹¤ìŒ ì‹ì‚¬ ì‹œê°„ì˜ ê¸°ë³¸ê°’ ì„¤ì •
                if self.selected_meals and self.current_dose_index < len(self.selected_meals):
                    next_meal = self.selected_meals[self.current_dose_index]
                    self.current_hour = next_meal.get('default_hour', 8)
                    self.current_minute = next_meal.get('default_minute', 0)
                    print(f"  ğŸ“± ë‹¤ìŒ ì‹ì‚¬ ì‹œê°„ ê¸°ë³¸ê°’ ì„¤ì •: {self.current_hour:02d}:{self.current_minute:02d} ({next_meal['name']})")
                else:
                    # ê¸°ë³¸ê°’ìœ¼ë¡œ ë¦¬ì…‹
                    self.current_hour = 8
                    self.current_minute = 0
                
                # ë¡¤ëŸ¬ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ë¦¬ì…‹
                if hasattr(self, 'hour_roller') and hasattr(self, 'minute_roller'):
                    self.hour_roller.set_selected(self.current_hour, True)
                    self.minute_roller.set_selected(self.current_minute // 5, True)
                
                # ì œëª©ê³¼ ë¡¤ëŸ¬ ê°€ì‹œì„± ì—…ë°ì´íŠ¸ (ì‹œê°„ ì„¤ì • ëª¨ë“œë¡œ)
                self._update_title()
                self._update_roller_visibility()
                
                print(f"  ğŸ“± ë³µìš© ì‹œê°„ {self.current_dose_index + 1} ì„¤ì • ì‹œì‘")
            else:
                # ëª¨ë“  ë³µìš© ì‹œê°„ ì„¤ì • ì™„ë£Œ
                print(f"  ğŸ“± ëª¨ë“  ë³µìš© ì‹œê°„ ì„¤ì • ì™„ë£Œ!")
                print(f"  ğŸ“± ì„¤ì •ëœ ì‹œê°„ë“¤: {self.dose_times}")
                
                # í•„ ë¡œë”© ì„¤ì • í™”ë©´ìœ¼ë¡œ ì´ë™
                if 'pill_loading' in self.screen_manager.screens:
                    # ê¸°ì¡´ í™”ë©´ì— ë³µìš© ì‹œê°„ ì •ë³´ ì „ë‹¬
                    pill_loading_screen = self.screen_manager.screens['pill_loading']
                    pill_loading_screen.update_dose_times(self.dose_times)
                    self.screen_manager.show_screen('pill_loading')
                else:
                    # í•„ ë¡œë”© í™”ë©´ì´ ì—†ìœ¼ë©´ ë™ì ìœ¼ë¡œ ìƒì„±
                    print("  ğŸ“± pill_loading í™”ë©´ì´ ë“±ë¡ë˜ì§€ ì•ŠìŒ. ë™ì  ìƒì„± ì¤‘...")
                    try:
                        from screens.pill_loading_screen import PillLoadingScreen
                        pill_loading_screen = PillLoadingScreen(self.screen_manager)
                        print("  ğŸ“± pill_loading í™”ë©´ ìƒì„± ì™„ë£Œ, ë³µìš© ì‹œê°„ ì •ë³´ ì „ë‹¬ ì¤‘...")
                        pill_loading_screen.update_dose_times(self.dose_times)
                        print("  ğŸ“± ë³µìš© ì‹œê°„ ì •ë³´ ì „ë‹¬ ì™„ë£Œ, í™”ë©´ ë“±ë¡ ì¤‘...")
                        self.screen_manager.register_screen('pill_loading', pill_loading_screen)
                        print("  âœ… pill_loading í™”ë©´ ìƒì„± ë° ë“±ë¡ ì™„ë£Œ")
                        self.screen_manager.show_screen('pill_loading')
                        print("  ğŸ“± í•„ ë¡œë”© í™”ë©´ìœ¼ë¡œ ì „í™˜ ì™„ë£Œ")
                    except Exception as e:
                        print(f"  âŒ í•„ ë¡œë”© í™”ë©´ ìƒì„± ì‹¤íŒ¨: {e}")
                        print("  ğŸ“± í•„ ë¡œë”© í™”ë©´ ìƒì„± ì‹¤íŒ¨ë¡œ í˜„ì¬ í™”ë©´ì— ë¨¸ë¬¼ê¸°")
            
        except Exception as e:
            print(f"  âŒ ë‹¤ìŒ ë‹¨ê³„ ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def update_meal_selections(self, dose_count, selected_meals):
        """ì‹ì‚¬ ì‹œê°„ ì„ íƒ ì •ë³´ ì—…ë°ì´íŠ¸"""
        try:
            print(f"ğŸ“± dose_time í™”ë©´ ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹œì‘")
            print(f"  - ì´ì „ ë³µìš© íšŸìˆ˜: {self.dose_count} â†’ ìƒˆë¡œìš´ ë³µìš© íšŸìˆ˜: {dose_count}")
            print(f"  - ì´ì „ ì„ íƒëœ ì‹ì‚¬: {[meal.get('name', 'Unknown') for meal in self.selected_meals] if self.selected_meals else 'None'}")
            print(f"  - ìƒˆë¡œìš´ ì„ íƒëœ ì‹ì‚¬: {[meal.get('name', 'Unknown') for meal in selected_meals] if selected_meals else 'None'}")
            
            # ìƒíƒœ ì´ˆê¸°í™”
            self.dose_count = dose_count
            self.selected_meals = selected_meals or []
            self.dose_times = []
            self.current_dose_index = 0
            self.editing_hour = True
            
            # ìƒˆë¡œìš´ ì‹ì‚¬ ì‹œê°„ì— ë”°ë¼ ê¸°ë³¸ ì‹œê°„ ì„¤ì •
            self._set_default_time_from_meals()
            
            # ì œëª© ì—…ë°ì´íŠ¸
            self._update_title_text()
            
            # ë¡¤ëŸ¬ ê°’ ì—…ë°ì´íŠ¸
            if hasattr(self, 'hour_roller') and hasattr(self, 'minute_roller'):
                self.hour_roller.set_selected(self.current_hour, True)
                self.minute_roller.set_selected(self.current_minute // 5, True)
                print(f"  ğŸ“± ë¡¤ëŸ¬ ê°’ ì—…ë°ì´íŠ¸: {self.current_hour:02d}:{self.current_minute:02d}")
            
            print(f"âœ… dose_time í™”ë©´ ìƒíƒœ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
            
        except Exception as e:
            print(f"âŒ dose_time í™”ë©´ ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def get_dose_times(self):
        """ì„¤ì •ëœ ë³µìš© ì‹œê°„ë“¤ ë°˜í™˜"""
        try:
            print(f"ğŸ“± ì €ì¥ëœ ë³µìš© ì‹œê°„ ì •ë³´ ë°˜í™˜: {len(self.dose_times)}ê°œ")
            for i, dose_info in enumerate(self.dose_times):
                if isinstance(dose_info, dict):
                    print(f"  {i+1}. {dose_info['meal_name']}: {dose_info['time']}")
                else:
                    print(f"  {i+1}. {dose_info}")
            return self.dose_times
        except Exception as e:
            print(f"  âŒ ë³µìš© ì‹œê°„ ë°˜í™˜ ì‹¤íŒ¨: {e}")
            return []
    
    def show(self):
        """í™”ë©´ í‘œì‹œ"""
        try:
            print(f"ğŸ“± {self.screen_name} í™”ë©´ í‘œì‹œ ì‹œì‘...")
            
            if hasattr(self, 'screen_obj') and self.screen_obj:
                print(f"ğŸ“± í™”ë©´ ê°ì²´ ì¡´ì¬ í™•ì¸ë¨")
                
                lv.screen_load(self.screen_obj)
                print(f"âœ… {self.screen_name} í™”ë©´ ë¡œë“œ ì™„ë£Œ")
                
                # í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸
                print(f"ğŸ“± {self.screen_name} í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì‹œì‘...")
                for i in range(5):
                    lv.timer_handler()
                    time.sleep(0.01)
                    print(f"  ğŸ“± ì—…ë°ì´íŠ¸ {i+1}/5")
                print(f"âœ… {self.screen_name} í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
                
                # ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ
                print(f"ğŸ“± ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ ì‹¤í–‰...")
                try:
                    lv.disp.flush()
                except Exception as flush_error:
                    print(f"âš ï¸ ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ ì˜¤ë¥˜ (ë¬´ì‹œ): {flush_error}")
                
                print(f"âœ… {self.screen_name} í™”ë©´ ì‹¤í–‰ë¨")
            else:
                print(f"âŒ {self.screen_name} í™”ë©´ ê°ì²´ê°€ ì—†ìŒ")
                
        except Exception as e:
            print(f"  âŒ {self.screen_name} í™”ë©´ í‘œì‹œ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def hide(self):
        """í™”ë©´ ìˆ¨ê¸°ê¸°"""
        try:
            print(f"ğŸ“± {self.screen_name} í™”ë©´ ìˆ¨ê¹€")
        except Exception as e:
            print(f"  âŒ {self.screen_name} í™”ë©´ ìˆ¨ê¹€ ì‹¤íŒ¨: {e}")
    
    def update(self):
        """í™”ë©´ ì—…ë°ì´íŠ¸"""
        try:
            # í˜„ì¬ëŠ” íŠ¹ë³„í•œ ì—…ë°ì´íŠ¸ ë¡œì§ì´ ì—†ìŒ
            pass
        except Exception as e:
            print(f"  âŒ {self.screen_name} í™”ë©´ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")

"""
ì•Œì•½ ì¶©ì „ í™”ë©´
ì•Œì•½ì„ ë””ìŠ¤í¬ì— ì¶©ì „í•˜ëŠ” í™”ë©´
"""

import time
import math
import json
import lvgl as lv
from ui_style import UIStyle

class DiskState:
    """ë””ìŠ¤í¬ ìƒíƒœ ê´€ë¦¬ í´ë˜ìŠ¤ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜)"""
    
    def __init__(self, disk_id):
        self.disk_id = disk_id
        self.total_compartments = 15  # ì´ 15ì¹¸
        self.compartments_per_loading = 3  # í•œ ë²ˆì— 3ì¹¸ì”© ì¶©ì „ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ 3ë²ˆ ê°ì§€)
        self.loaded_count = 0  # ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ë¡œ ì¹´ìš´íŠ¸ëœ ì¶©ì „ëœ ì¹¸ ìˆ˜
        self.is_loading = False  # í˜„ì¬ ì¶©ì „ ì¤‘ì¸ì§€ ì—¬ë¶€
        self.current_loading_count = 0  # í˜„ì¬ ì¶©ì „ ì¤‘ì¸ ì¹¸ ìˆ˜ (0-3)
        
    def can_load_more(self):
        """ë” ì¶©ì „í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸"""
        return self.loaded_count < self.total_compartments
    
    def start_loading(self):
        """ì¶©ì „ ì‹œì‘ (3ì¹¸ì”©)"""
        if self.can_load_more():
            self.is_loading = True
            self.current_loading_count = 0
            return True
        return False
    
    def complete_loading(self):
        """ì¶©ì „ ì™„ë£Œ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê°ì§€ ì‹œ í˜¸ì¶œ)"""
        if self.is_loading:
            self.current_loading_count += 1
            self.loaded_count += 1  # ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ 1ë²ˆ ê°ì§€ = 1ì¹¸ ì´ë™
            print(f"  ğŸ“± ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ {self.current_loading_count}ë²ˆì§¸ ê°ì§€ - 1ì¹¸ ì´ë™ (ì´ {self.loaded_count}ì¹¸)")
            
            # 3ì¹¸ì´ ëª¨ë‘ ì¶©ì „ë˜ë©´ ì¶©ì „ ì™„ë£Œ
            if self.current_loading_count >= 3:
                self.is_loading = False
                print(f"  ğŸ“± 3ì¹¸ ì¶©ì „ ì™„ë£Œ! ì´ {self.loaded_count}ì¹¸")
                return True
            return False
        return False
    
    def get_loading_progress(self):
        """ì¶©ì „ ì§„í–‰ë¥  ë°˜í™˜ (0-100)"""
        return (self.loaded_count / self.total_compartments) * 100

class PillLoadingScreen:
    """ì•Œì•½ ì¶©ì „ í™”ë©´ í´ë˜ìŠ¤"""
    
    def __init__(self, screen_manager):
        """ì•Œì•½ ì¶©ì „ í™”ë©´ ì´ˆê¸°í™”"""
        # ë©”ëª¨ë¦¬ ì •ë¦¬
        import gc
        gc.collect()
        
        self.screen_manager = screen_manager
        self.screen_name = 'pill_loading'
        self.screen_obj = None
        self.selected_disk_index = 0  # 0, 1, 2 (ë””ìŠ¤í¬ 1, 2, 3)
        self.is_loading = False
        self.loading_progress = 0  # 0-100%
        self.current_mode = 'selection'  # 'selection' ë˜ëŠ” 'loading'
        self.current_disk_state = None
        
        # ì‹ì‚¬ ì‹œê°„ê³¼ ë””ìŠ¤í¬ ë§¤í•‘
        self.meal_to_disk_mapping = {
            'breakfast': 0,  # ì•„ì¹¨ â†’ ë””ìŠ¤í¬ 1
            'lunch': 1,      # ì ì‹¬ â†’ ë””ìŠ¤í¬ 2
            'dinner': 2      # ì €ë… â†’ ë””ìŠ¤í¬ 3
        }
        
        # ì„¤ì •ëœ ë³µìš© ì‹œê°„ ì •ë³´ (dose_time í™”ë©´ì—ì„œ ì „ë‹¬ë°›ìŒ)
        self.dose_times = []
        self.selected_meals = []
        self.available_disks = []  # ì¶©ì „ ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ëª©ë¡
        
        # ìˆœì°¨ì  ì¶©ì „ ê´€ë ¨ ë³€ìˆ˜
        self.sequential_mode = False  # ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ ì—¬ë¶€
        self.current_sequential_index = 0  # í˜„ì¬ ì¶©ì „ ì¤‘ì¸ ë””ìŠ¤í¬ ì¸ë±ìŠ¤
        self.sequential_disks = []  # ìˆœì°¨ì  ì¶©ì „í•  ë””ìŠ¤í¬ ëª©ë¡
        
        # ë””ìŠ¤í¬ ìƒíƒœ ê´€ë¦¬
        self.disk_states = {}
        self.disk_states_file = "/disk_states.json"  # ì €ì¥ íŒŒì¼ ê²½ë¡œ
        
        # ì €ì¥ëœ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸° (ìˆìœ¼ë©´)
        self._load_disk_states()
        
        # ë¶ˆëŸ¬ì˜¨ ìƒíƒœê°€ ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
        for i in range(3):
            if i not in self.disk_states:
                self.disk_states[i] = DiskState(i + 1)
        
        # UI ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
        try:
            self.ui_style = UIStyle()
            print("âœ… UI ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” ì™„ë£Œ")
        except Exception as e:
            print(f"âš ï¸ UI ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
            self.ui_style = None
        
        # ëª¨í„° ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        try:
            from motor_control import PillBoxMotorSystem
            self.motor_system = PillBoxMotorSystem()
            
            # ëª¨í„° ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œ ì›ì  ë³´ì • (ì„ íƒì‚¬í•­)
            # self.motor_system.calibrate_all_disks()
            
            print("âœ… ëª¨í„° ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ")
        except Exception as e:
            print(f"âš ï¸ ëª¨í„° ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
            self.motor_system = None
        
        # í™”ë©´ ìƒì„± (ë³µìš© ì‹œê°„ ì •ë³´ê°€ ì„¤ì •ëœ í›„ì— ìƒì„±)
        # self._create_modern_screen()  # update_dose_times í›„ì— ìƒì„±
        
        print(f"âœ… {self.screen_name} í™”ë©´ ì´ˆê¸°í™” ì™„ë£Œ")
    
    def show(self):
        """í™”ë©´ í‘œì‹œ"""
        try:
            print(f"ğŸ“± {self.screen_name} í™”ë©´ í‘œì‹œ ì‹œì‘...")
            
            # í™”ë©´ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ í™”ë©´ ìƒì„±
            if not hasattr(self, 'screen_obj') or not self.screen_obj:
                print(f"ğŸ“± í™”ë©´ì´ ì—†ìŒ - ê¸°ë³¸ í™”ë©´ ìƒì„±")
                self._create_modern_screen()
            
            if hasattr(self, 'screen_obj') and self.screen_obj:
                print(f"ğŸ“± í™”ë©´ ê°ì²´ ì¡´ì¬ í™•ì¸ë¨")
                
                lv.screen_load(self.screen_obj)
                print(f"âœ… {self.screen_name} í™”ë©´ ë¡œë“œ ì™„ë£Œ")
                
                # í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸
                print(f"ğŸ“± {self.screen_name} í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì‹œì‘...")
                for i in range(5):
                    lv.timer_handler()
                    time.sleep(0.01)
                    print(f"  ğŸ“± ì—…ë°ì´íŠ¸ {i+1}/5")
                print(f"âœ… {self.screen_name} í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
                
                # ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ
                print(f"ğŸ“± ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ ì‹¤í–‰...")
                try:
                    lv.disp.flush()
                except Exception as flush_error:
                    print(f"âš ï¸ ë””ìŠ¤í”Œë ˆì´ í”ŒëŸ¬ì‹œ ì˜¤ë¥˜ (ë¬´ì‹œ): {flush_error}")
                
                print(f"âœ… {self.screen_name} í™”ë©´ ì‹¤í–‰ë¨")
                
                # ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œì¸ ê²½ìš° ì´ë¯¸ ì¶©ì „ í™”ë©´ì´ ìƒì„±ë¨
                if self.sequential_mode and self.current_mode == 'loading':
                    print(f"ğŸ“± ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ - ì¶©ì „ í™”ë©´ì´ ì´ë¯¸ ìƒì„±ë¨")
            else:
                print(f"âŒ {self.screen_name} í™”ë©´ ê°ì²´ê°€ ì—†ìŒ")
                
        except Exception as e:
            print(f"  âŒ {self.screen_name} í™”ë©´ í‘œì‹œ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def update_dose_times(self, dose_times):
        """ë³µìš© ì‹œê°„ ì •ë³´ ì—…ë°ì´íŠ¸ ë° ì¶©ì „ ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ê²°ì •"""
        try:
            print(f"ğŸ“± ë³µìš© ì‹œê°„ ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘")
            self.dose_times = dose_times or []
            
            # ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ ì¶”ì¶œ
            self.selected_meals = []
            for dose_info in self.dose_times:
                if isinstance(dose_info, dict) and 'meal_key' in dose_info:
                    self.selected_meals.append(dose_info['meal_key'])
            
            print(f"ğŸ“± ì„¤ì •ëœ ë³µìš© ì‹œê°„: {len(self.dose_times)}ê°œ")
            for dose_info in self.dose_times:
                if isinstance(dose_info, dict):
                    print(f"  - {dose_info['meal_name']}: {dose_info['time']}")
            
            print(f"ğŸ“± ì„ íƒëœ ì‹ì‚¬ ì‹œê°„: {self.selected_meals}")
            
            # ì¶©ì „ ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ê²°ì •
            self._determine_available_disks()
            
            # ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ ê²°ì •
            self._determine_sequential_mode()
            
            # í™”ë©´ ìƒì„± (ë³µìš© ì‹œê°„ ì •ë³´ ì„¤ì • í›„)
            if not hasattr(self, 'screen_obj') or not self.screen_obj:
                print(f"ğŸ“± ë³µìš© ì‹œê°„ ì •ë³´ ì„¤ì • ì™„ë£Œ - í™”ë©´ ìƒì„± ì‹œì‘")
                self._create_modern_screen()
                print(f"ğŸ“± í™”ë©´ ìƒì„± ì™„ë£Œ")
            
            print(f"âœ… ë³µìš© ì‹œê°„ ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
            
        except Exception as e:
            print(f"âŒ ë³µìš© ì‹œê°„ ì •ë³´ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def _determine_available_disks(self):
        """ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ì— ë”°ë¼ ì¶©ì „ ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ê²°ì •"""
        try:
            self.available_disks = []
            
            if not self.selected_meals:
                # ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ì´ ì—†ìœ¼ë©´ ëª¨ë“  ë””ìŠ¤í¬ ì¶©ì „ ê°€ëŠ¥
                self.available_disks = [0, 1, 2]  # ë””ìŠ¤í¬ 1, 2, 3
                print(f"ğŸ“± ì„ íƒëœ ì‹ì‚¬ ì‹œê°„ ì—†ìŒ - ëª¨ë“  ë””ìŠ¤í¬ ì¶©ì „ ê°€ëŠ¥")
            elif len(self.selected_meals) == 1:
                # 1ê°œë§Œ ì„ íƒí–ˆìœ¼ë©´ ëª¨ë“  ë””ìŠ¤í¬ ì¶©ì „ ê°€ëŠ¥
                self.available_disks = [0, 1, 2]  # ë””ìŠ¤í¬ 1, 2, 3
                print(f"ğŸ“± 1ê°œ ì‹ì‚¬ ì‹œê°„ ì„ íƒ - ëª¨ë“  ë””ìŠ¤í¬ ì¶©ì „ ê°€ëŠ¥")
            else:
                # 2ê°œ ì´ìƒ ì„ íƒí–ˆìœ¼ë©´ í•´ë‹¹ ë””ìŠ¤í¬ë§Œ ì¶©ì „ ê°€ëŠ¥
                for meal_key in self.selected_meals:
                    if meal_key in self.meal_to_disk_mapping:
                        disk_index = self.meal_to_disk_mapping[meal_key]
                        self.available_disks.append(disk_index)
                
                print(f"ğŸ“± {len(self.selected_meals)}ê°œ ì‹ì‚¬ ì‹œê°„ ì„ íƒ - ì œí•œëœ ë””ìŠ¤í¬ ì¶©ì „")
                for disk_index in self.available_disks:
                    meal_name = self._get_meal_name_by_disk(disk_index)
                    print(f"  - ë””ìŠ¤í¬ {disk_index + 1}: {meal_name}")
            
        except Exception as e:
            print(f"âŒ ì¶©ì „ ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ê²°ì • ì‹¤íŒ¨: {e}")
            # ì˜¤ë¥˜ ì‹œ ëª¨ë“  ë””ìŠ¤í¬ í—ˆìš©
            self.available_disks = [0, 1, 2]
    
    def _get_meal_name_by_disk(self, disk_index):
        """ë””ìŠ¤í¬ ì¸ë±ìŠ¤ë¡œ ì‹ì‚¬ ì‹œê°„ ì´ë¦„ ë°˜í™˜"""
        for meal_key, disk_idx in self.meal_to_disk_mapping.items():
            if disk_idx == disk_index:
                meal_names = {'breakfast': 'ì•„ì¹¨', 'lunch': 'ì ì‹¬', 'dinner': 'ì €ë…'}
                return meal_names.get(meal_key, 'ì•Œ ìˆ˜ ì—†ìŒ')
        return 'ì•Œ ìˆ˜ ì—†ìŒ'
    
    def _determine_sequential_mode(self):
        """ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ ê²°ì •"""
        try:
            if len(self.selected_meals) >= 2:
                # 2ê°œ ì´ìƒ ì„ íƒí–ˆìœ¼ë©´ ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ
                self.sequential_mode = True
                self.sequential_disks = []
                
                # ì•„ì¹¨, ì ì‹¬, ì €ë… ìˆœì„œë¡œ ì •ë ¬
                meal_order = ['breakfast', 'lunch', 'dinner']
                for meal_key in meal_order:
                    if meal_key in self.selected_meals:
                        disk_index = self.meal_to_disk_mapping[meal_key]
                        self.sequential_disks.append(disk_index)
                
                self.current_sequential_index = 0
                print(f"ğŸ“± ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ í™œì„±í™”: {len(self.sequential_disks)}ê°œ ë””ìŠ¤í¬")
                for i, disk_index in enumerate(self.sequential_disks):
                    meal_name = self._get_meal_name_by_disk(disk_index)
                    print(f"  {i+1}. ë””ìŠ¤í¬ {disk_index + 1} ({meal_name})")
            else:
                # 1ê°œ ì´í•˜ ì„ íƒí–ˆìœ¼ë©´ ê°œë³„ ì„ íƒ ëª¨ë“œ
                self.sequential_mode = False
                self.sequential_disks = []
                self.current_sequential_index = 0
                print(f"ğŸ“± ê°œë³„ ì„ íƒ ëª¨ë“œ í™œì„±í™”")
                
        except Exception as e:
            print(f"âŒ ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ ê²°ì • ì‹¤íŒ¨: {e}")
            self.sequential_mode = False
            self.sequential_disks = []
    
    def start_sequential_loading(self):
        """ìˆœì°¨ì  ì¶©ì „ ì‹œì‘"""
        try:
            if not self.sequential_mode or not self.sequential_disks:
                print(f"âŒ ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œê°€ ì•„ë‹ˆê±°ë‚˜ ë””ìŠ¤í¬ ëª©ë¡ì´ ë¹„ì–´ìˆìŒ")
                return False
            
            print(f"ğŸ“± ìˆœì°¨ì  ì¶©ì „ ì‹œì‘: {len(self.sequential_disks)}ê°œ ë””ìŠ¤í¬")
            self.current_sequential_index = 0
            self._start_current_disk_loading()
            return True
            
        except Exception as e:
            print(f"âŒ ìˆœì°¨ì  ì¶©ì „ ì‹œì‘ ì‹¤íŒ¨: {e}")
            return False
    
    def _start_current_disk_loading(self):
        """í˜„ì¬ ë””ìŠ¤í¬ ì¶©ì „ ì‹œì‘"""
        try:
            if self.current_sequential_index >= len(self.sequential_disks):
                print(f"ğŸ“± ëª¨ë“  ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ!")
                self._complete_sequential_loading()
                return
            
            current_disk_index = self.sequential_disks[self.current_sequential_index]
            meal_name = self._get_meal_name_by_disk(current_disk_index)
            
            print(f"ğŸ“± {meal_name} ë””ìŠ¤í¬ ì¶©ì „ ì‹œì‘ ({self.current_sequential_index + 1}/{len(self.sequential_disks)})")
            
            # í˜„ì¬ ë””ìŠ¤í¬ë¡œ ì„¤ì •
            self.selected_disk_index = current_disk_index
            self.current_disk_state = self.disk_states[current_disk_index]
            self.current_mode = 'loading'
            
            # ë””ìŠ¤í¬ ìƒíƒœ ì´ˆê¸°í™” (ìƒˆë¡œìš´ ë””ìŠ¤í¬ë¡œ ì „í™˜ ì‹œ)
            if self.current_sequential_index > 0:  # ì²« ë²ˆì§¸ ë””ìŠ¤í¬ê°€ ì•„ë‹Œ ê²½ìš°
                print(f"  ğŸ“± ìƒˆë¡œìš´ ë””ìŠ¤í¬ë¡œ ì „í™˜ - ë””ìŠ¤í¬ ìƒíƒœ ì´ˆê¸°í™”")
                # ë””ìŠ¤í¬ ìƒíƒœë¥¼ í˜„ì¬ ë¡œë“œëœ ìƒíƒœë¡œ ì´ˆê¸°í™”
                self.current_disk_state.loaded_count = self.current_disk_state.loaded_count  # í˜„ì¬ ìƒíƒœ ìœ ì§€
                print(f"  ğŸ“± ë””ìŠ¤í¬ {current_disk_index} í˜„ì¬ ìƒíƒœ: {self.current_disk_state.loaded_count}ì¹¸")
            
            # í™”ë©´ ì—…ë°ì´íŠ¸ (ì„œë¸Œ í™”ë©´ ìƒì„± ëŒ€ì‹ )
            self._update_loading_screen()
            
        except Exception as e:
            print(f"âŒ í˜„ì¬ ë””ìŠ¤í¬ ì¶©ì „ ì‹œì‘ ì‹¤íŒ¨: {e}")
    
    def _complete_current_disk_loading(self):
        """í˜„ì¬ ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ í›„ ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ"""
        try:
            print(f"ğŸ“± í˜„ì¬ ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ")
            self.current_sequential_index += 1
            
            if self.current_sequential_index < len(self.sequential_disks):
                # ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ
                print(f"ğŸ“± ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ ì´ë™")
                self._start_current_disk_loading()
            else:
                # ëª¨ë“  ë””ìŠ¤í¬ ì™„ë£Œ
                print(f"ğŸ“± ëª¨ë“  ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ!")
                self._complete_sequential_loading()
                
        except Exception as e:
            print(f"âŒ í˜„ì¬ ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
    
    def _complete_sequential_loading(self):
        """ìˆœì°¨ì  ì¶©ì „ ì™„ë£Œ"""
        try:
            print(f"ğŸ“± ìˆœì°¨ì  ì¶©ì „ ì™„ë£Œ - ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™")
            
            # ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™
            if hasattr(self.screen_manager, 'screens') and 'main' in self.screen_manager.screens:
                self.screen_manager.show_screen('main')
            else:
                print(f"ğŸ“± ë©”ì¸ í™”ë©´ì´ ì—†ì–´ì„œ í˜„ì¬ í™”ë©´ì— ë¨¸ë¬¼ê¸°")
            
        except Exception as e:
            print(f"âŒ ìˆœì°¨ì  ì¶©ì „ ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨: {e}")
    
    def _create_modern_screen(self):
        """Modern ìŠ¤íƒ€ì¼ í™”ë©´ ìƒì„± (dose_count_screenê³¼ ì¼ê´€ëœ ìŠ¤íƒ€ì¼)"""
        print(f"  ğŸ“± {self.screen_name} Modern í™”ë©´ ìƒì„± ì‹œì‘...")
        
        # ê°•ë ¥í•œ ë©”ëª¨ë¦¬ ì •ë¦¬
        import gc
        for i in range(5):
            gc.collect()
            time.sleep(0.02)
        print(f"  âœ… ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
        
        # í™”ë©´ ê°ì²´ ìƒì„±
        print(f"  ğŸ“± í™”ë©´ ê°ì²´ ìƒì„±...")
        self.screen_obj = lv.obj()
        self.screen_obj.set_style_bg_color(lv.color_hex(0xFFFFFF), 0)  # í™”ì´íŠ¸ ë°°ê²½
        
        # ë©”ì¸ í™”ë©´ ìŠ¤í¬ë¡¤ë°” ë¹„í™œì„±í™”
        self.screen_obj.set_scrollbar_mode(lv.SCROLLBAR_MODE.OFF)
        self.screen_obj.set_scroll_dir(lv.DIR.NONE)
        
        print(f"  âœ… í™”ë©´ ê°ì²´ ìƒì„± ì™„ë£Œ")
        
        # ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œì¸ ê²½ìš° ë°”ë¡œ ì¶©ì „ í™”ë©´ ìƒì„±
        if self.sequential_mode:
            print(f"  ğŸ“± ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ - ë°”ë¡œ ì¶©ì „ í™”ë©´ ìƒì„±")
            self._create_loading_screen_directly()
        else:
            # ê°œë³„ ì„ íƒ ëª¨ë“œì¸ ê²½ìš° ê¸°ì¡´ ë°©ì‹
            print(f"  ğŸ“± ê°œë³„ ì„ íƒ ëª¨ë“œ - ê¸°ì¡´ í™”ë©´ ìƒì„±")
            # 3ê°œ ì˜ì—­ìœ¼ë¡œ êµ¬ì¡°í™” (ë‹¨ê³„ë³„ ë©”ëª¨ë¦¬ ì •ë¦¬)
            print(f"  ğŸ“± ìƒë‹¨ ìƒíƒœ ì»¨í…Œì´ë„ˆ ìƒì„±...")
            self._create_status_container()  # ìƒë‹¨ ìƒíƒœ ì»¨í…Œì´ë„ˆ
            import gc; gc.collect()
            
            print(f"  ğŸ“± ì¤‘ì•™ ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„±...")
            self._create_main_container()    # ì¤‘ì•™ ë©”ì¸ ì»¨í…Œì´ë„ˆ
            import gc; gc.collect()
            
            print(f"  ğŸ“± í•˜ë‹¨ ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ ìƒì„±...")
            self._create_button_hints_area() # í•˜ë‹¨ ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ
            import gc; gc.collect()
        
        print(f"  âœ… Modern í™”ë©´ ìƒì„± ì™„ë£Œ")
    
    def _create_loading_screen_directly(self):
        """ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œì—ì„œ ë°”ë¡œ ì¶©ì „ í™”ë©´ì„ ë©”ì¸ í™”ë©´ìœ¼ë¡œ ìƒì„±"""
        try:
            print(f"  ğŸ“± ì§ì ‘ ì¶©ì „ í™”ë©´ ìƒì„± ì‹œì‘...")
            
            # ì²« ë²ˆì§¸ ë””ìŠ¤í¬ ì„¤ì •
            if self.sequential_disks:
                self.selected_disk_index = self.sequential_disks[0]
                self.current_disk_state = self.disk_states[self.selected_disk_index]
                self.current_mode = 'loading'
                
                # ì œëª© ìƒì„±
                meal_name = self._get_meal_name_by_disk(self.selected_disk_index)
                self.title_text = lv.label(self.screen_obj)
                self.title_text.set_text(f"{meal_name}ì•½ ì¶©ì „")
                self.title_text.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
                self.title_text.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
                self.title_text.align(lv.ALIGN.TOP_MID, 0, 10)
                
                # í•œêµ­ì–´ í°íŠ¸ ì ìš©
                korean_font = getattr(lv, "font_notosans_kr_regular", None)
                if korean_font:
                    self.title_text.set_style_text_font(korean_font, 0)
                
                # ì•„í¬ í”„ë¡œê·¸ë ˆìŠ¤ ë°” ìƒì„±
                self.progress_arc = lv.arc(self.screen_obj)
                self.progress_arc.set_size(60, 60)
                self.progress_arc.align(lv.ALIGN.CENTER, -30, 10)
                self.progress_arc.set_bg_angles(0, 360)
                
                # í˜„ì¬ ì¶©ì „ ìƒíƒœë¥¼ ë°˜ì˜í•œ ê°ë„ ì„¤ì •
                progress = self.current_disk_state.get_loading_progress()
                arc_angle = int((progress / 100) * 360)
                self.progress_arc.set_angles(0, arc_angle)
                self.progress_arc.set_rotation(270)
                
                # ì•„í¬ ìŠ¤íƒ€ì¼ ì„¤ì •
                self.progress_arc.set_style_arc_width(8, 0)  # ë°°ê²½ ì•„í¬
                self.progress_arc.set_style_arc_color(lv.color_hex(0xE5E5EA), 0)  # ë°°ê²½ íšŒìƒ‰
                self.progress_arc.set_style_arc_width(8, lv.PART.INDICATOR)  # ì§„í–‰ ì•„í¬
                self.progress_arc.set_style_arc_color(lv.color_hex(0x00C9A7), lv.PART.INDICATOR)  # ì§„í–‰ ë¯¼íŠ¸ìƒ‰
                
                # ì•„í¬ ë…¸ë¸Œ ìƒ‰ìƒ ì„¤ì • (ì•„í¬ì™€ ë™ì¼í•œ ë¯¼íŠ¸ìƒ‰)
                try:
                    self.progress_arc.set_style_bg_color(lv.color_hex(0x00C9A7), lv.PART.KNOB)
                    self.progress_arc.set_style_bg_opa(255, lv.PART.KNOB)
                    print(f"  âœ… ì•„í¬ ë…¸ë¸Œ ìƒ‰ìƒ ì„¤ì • ì™„ë£Œ (ë¯¼íŠ¸ìƒ‰)")
                except AttributeError:
                    print(f"  âš ï¸ lv.PART.KNOB ì§€ì› ì•ˆë¨, ê±´ë„ˆë›°ê¸°")
                
                # ì§„í–‰ë¥  í…ìŠ¤íŠ¸ ë¼ë²¨
                self.progress_label = lv.label(self.screen_obj)
                self.progress_label.set_text(f"{progress:.0f}%")
                self.progress_label.align(lv.ALIGN.CENTER, -30, 10)
                self.progress_label.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
                self.progress_label.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
                
                if korean_font:
                    self.progress_label.set_style_text_font(korean_font, 0)
                
                # ì„¸ë¶€ ì •ë³´ ë¼ë²¨
                self.detail_label = lv.label(self.screen_obj)
                loaded_count = self.current_disk_state.loaded_count
                self.detail_label.set_text(f"{loaded_count}/15ì¹¸")
                self.detail_label.align(lv.ALIGN.CENTER, 30, 10)
                self.detail_label.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
                self.detail_label.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
                
                if korean_font:
                    self.detail_label.set_style_text_font(korean_font, 0)
                
                # ë²„íŠ¼ íŒíŠ¸ (lv.SYMBOL.DOWNLOAD ì‚¬ìš©)
                self.hints_text = lv.label(self.screen_obj)
                self.hints_text.set_text(f"A:- B:- C:- D:{lv.SYMBOL.DOWNLOAD}")
                self.hints_text.align(lv.ALIGN.BOTTOM_MID, 0, -2)
                self.hints_text.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
                self.hints_text.set_style_text_color(lv.color_hex(0x8E8E93), 0)
                # lv ê¸°ë³¸ í°íŠ¸ ì‚¬ìš© (í•œêµ­ì–´ í°íŠ¸ ì ìš©í•˜ì§€ ì•ŠìŒ) - dose_count_screenê³¼ ë™ì¼
                
                print(f"  âœ… ì§ì ‘ ì¶©ì „ í™”ë©´ ìƒì„± ì™„ë£Œ: {meal_name}ì•½ ì¶©ì „")
                
        except Exception as e:
            print(f"  âŒ ì§ì ‘ ì¶©ì „ í™”ë©´ ìƒì„± ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def _update_loading_screen(self):
        """ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œì—ì„œ ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ í™”ë©´ ì—…ë°ì´íŠ¸"""
        try:
            print(f"  ğŸ“± ì¶©ì „ í™”ë©´ ì—…ë°ì´íŠ¸ ì‹œì‘...")
            
            # ì œëª© ì—…ë°ì´íŠ¸
            if hasattr(self, 'title_text'):
                meal_name = self._get_meal_name_by_disk(self.selected_disk_index)
                self.title_text.set_text(f"{meal_name}ì•½ ì¶©ì „")
                print(f"  âœ… ì œëª© ì—…ë°ì´íŠ¸ ì™„ë£Œ: {meal_name}ì•½ ì¶©ì „")
            
            # ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            if hasattr(self, 'progress_arc') and hasattr(self, 'progress_label'):
                progress = self.current_disk_state.get_loading_progress()
                arc_angle = int((progress / 100) * 360)
                self.progress_arc.set_angles(0, arc_angle)
                self.progress_label.set_text(f"{progress:.0f}%")
                print(f"  âœ… ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì™„ë£Œ: {progress:.0f}%")
            
            # ì„¸ë¶€ ì •ë³´ ì—…ë°ì´íŠ¸
            if hasattr(self, 'detail_label'):
                loaded_count = self.current_disk_state.loaded_count
                self.detail_label.set_text(f"{loaded_count}/15ì¹¸")
                print(f"  âœ… ì„¸ë¶€ ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: {loaded_count}/15ì¹¸ (ë””ìŠ¤í¬ {self.selected_disk_index})")
            
            print(f"  âœ… ì¶©ì „ í™”ë©´ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ ì¶©ì „ í™”ë©´ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    def _create_status_container(self):
        """ìƒë‹¨ ìƒíƒœ ì»¨í…Œì´ë„ˆ ìƒì„±"""
        # ìƒë‹¨ ìƒíƒœ ì»¨í…Œì´ë„ˆ (ì œëª© í‘œì‹œ)
        self.status_container = lv.obj(self.screen_obj)
        self.status_container.set_size(160, 25)
        self.status_container.align(lv.ALIGN.TOP_MID, 0, 0)
        self.status_container.set_style_bg_opa(0, 0)
        self.status_container.set_style_border_width(0, 0)
        self.status_container.set_style_pad_all(0, 0)
        
        # ìŠ¤í¬ë¡¤ë°” ë¹„í™œì„±í™”
        self.status_container.set_scrollbar_mode(lv.SCROLLBAR_MODE.OFF)
        self.status_container.set_scroll_dir(lv.DIR.NONE)
        
        # ì œëª© í…ìŠ¤íŠ¸
        self.title_text = lv.label(self.status_container)
        self.title_text.set_text("ì•Œì•½ ì¶©ì „")
        self.title_text.align(lv.ALIGN.CENTER, 0, 0)
        self.title_text.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
        self.title_text.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
        
        # í•œêµ­ì–´ í°íŠ¸ ì ìš©
        korean_font = getattr(lv, "font_notosans_kr_regular", None)
        if korean_font:
            self.title_text.set_style_text_font(korean_font, 0)
        
        print("  âœ… ìƒë‹¨ ìƒíƒœ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ")
    
    def _create_main_container(self):
        """ì¤‘ì•™ ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„±"""
        # ë©”ì¸ ì»¨í…Œì´ë„ˆ (ìƒë‹¨ 25px, í•˜ë‹¨ 20px ì œì™¸)
        self.main_container = lv.obj(self.screen_obj)
        self.main_container.set_size(160, 83)
        self.main_container.align(lv.ALIGN.TOP_MID, 0, 25)
        self.main_container.set_style_bg_opa(0, 0)
        self.main_container.set_style_border_width(0, 0)
        self.main_container.set_style_pad_all(0, 0)
        
        # ìŠ¤í¬ë¡¤ë°” ë¹„í™œì„±í™”
        self.main_container.set_scrollbar_mode(lv.SCROLLBAR_MODE.OFF)
        self.main_container.set_scroll_dir(lv.DIR.NONE)
        
        # ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„±
        self._create_disk_selection_area()
        
        print("  âœ… ì¤‘ì•™ ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ")
    
    def _create_disk_selection_area(self):
        """ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„±"""
        try:
            if self.sequential_mode:
                # ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œì—ì„œëŠ” ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ì„ ìƒì„±í•˜ì§€ ì•ŠìŒ
                print("  ğŸ“± ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ - ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒëµ")
                self.disk_label = None
                self.disk_roller = None
                return
            
            # ê°œë³„ ì„ íƒ ëª¨ë“œì—ì„œë§Œ ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„±
            # ë””ìŠ¤í¬ ì„ íƒ ì•ˆë‚´ í…ìŠ¤íŠ¸
            self.disk_label = lv.label(self.main_container)
            self.disk_label.set_text("ë””ìŠ¤í¬ë¥¼ ì„ íƒí•˜ì„¸ìš”")
            self.disk_label.align(lv.ALIGN.CENTER, 0, -10)
            self.disk_label.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
            self.disk_label.set_style_text_color(lv.color_hex(0x333333), 0)
            
            # í•œêµ­ì–´ í°íŠ¸ ì ìš©
            korean_font = getattr(lv, "font_notosans_kr_regular", None)
            if korean_font:
                self.disk_label.set_style_text_font(korean_font, 0)
            
            # ë””ìŠ¤í¬ ì˜µì…˜ ìƒì„±
            self._update_disk_options()
            
            # ë””ìŠ¤í¬ ì„ íƒ ë¡¤ëŸ¬ ìƒì„±
            self.disk_roller = lv.roller(self.main_container)
            self.disk_roller.set_size(120, 50)
            self.disk_roller.align(lv.ALIGN.CENTER, 0, 10)
            self.disk_roller.set_options(self.disk_options_text, lv.roller.MODE.INFINITE)
            self.disk_roller.set_selected(0, True)  # ì²« ë²ˆì§¸ ë””ìŠ¤í¬ ì„ íƒ
            
            # ë¡¤ëŸ¬ ìŠ¤íƒ€ì¼ ì„¤ì •
            self.disk_roller.set_style_bg_color(lv.color_hex(0xF2F2F7), 0)
            self.disk_roller.set_style_border_width(0, 0)
            self.disk_roller.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            
            # í•œêµ­ì–´ í°íŠ¸ ì ìš©
            if korean_font:
                self.disk_roller.set_style_text_font(korean_font, 0)
            
            # ë¡¤ëŸ¬ ì„ íƒëœ í•­ëª© ìŠ¤íƒ€ì¼ - ë¡œê³  ìƒ‰ìƒ(ë¯¼íŠ¸)
            try:
                self.disk_roller.set_style_bg_color(lv.color_hex(0x00C9A7), lv.PART.SELECTED)
                self.disk_roller.set_style_bg_opa(255, lv.PART.SELECTED)
                self.disk_roller.set_style_text_color(lv.color_hex(0xFFFFFF), lv.PART.SELECTED)
                self.disk_roller.set_style_radius(6, lv.PART.SELECTED)
            except AttributeError:
                pass
            
            print("  âœ… ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„± ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„± ì‹¤íŒ¨: {e}")
    
    def _update_disk_options(self):
        """ì¶©ì „ ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ì˜µì…˜ ì—…ë°ì´íŠ¸"""
        try:
            if not hasattr(self, 'available_disks') or not self.available_disks:
                # ê¸°ë³¸ê°’: ëª¨ë“  ë””ìŠ¤í¬
                self.available_disks = [0, 1, 2]
            
            # ë””ìŠ¤í¬ ì˜µì…˜ í…ìŠ¤íŠ¸ ìƒì„±
            disk_options = []
            for disk_index in self.available_disks:
                meal_name = self._get_meal_name_by_disk(disk_index)
                if meal_name != 'ì•Œ ìˆ˜ ì—†ìŒ':
                    disk_options.append(f"{meal_name} ë””ìŠ¤í¬")
                else:
                    disk_options.append(f"ë””ìŠ¤í¬ {disk_index + 1}")
            
            self.disk_options_text = "\n".join(disk_options)
            print(f"  ğŸ“± ë””ìŠ¤í¬ ì˜µì…˜ ì—…ë°ì´íŠ¸: {self.disk_options_text}")
            
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ì˜µì…˜ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
            # ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
            self.disk_options_text = "ë””ìŠ¤í¬ 1\në””ìŠ¤í¬ 2\në””ìŠ¤í¬ 3"
            self.available_disks = [0, 1, 2]
    
    def _create_button_hints_area(self):
        """í•˜ë‹¨ ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ ìƒì„±"""
        # ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ (í™”ë©´ í•˜ë‹¨ì— ì§ì ‘ ë°°ì¹˜)
        self.hints_container = lv.obj(self.screen_obj)
        self.hints_container.set_size(140, 18)
        self.hints_container.align(lv.ALIGN.BOTTOM_MID, 0, -2)
        self.hints_container.set_style_bg_opa(0, 0)
        self.hints_container.set_style_border_width(0, 0)
        self.hints_container.set_style_pad_all(0, 0)
        
        # ë²„íŠ¼íŒíŠ¸ í…ìŠ¤íŠ¸ (lv ê¸°ë³¸ í°íŠ¸ ì‚¬ìš©)
        self.hints_text = lv.label(self.hints_container)
        self.hints_text.set_text(f"A:{lv.SYMBOL.UP} B:{lv.SYMBOL.DOWN} C:{lv.SYMBOL.PREV} D:{lv.SYMBOL.DOWNLOAD}")
        self.hints_text.align(lv.ALIGN.CENTER, 0, 0)
        self.hints_text.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
        self.hints_text.set_style_text_color(lv.color_hex(0x8E8E93), 0)
        # lv ê¸°ë³¸ í°íŠ¸ ì‚¬ìš© (í•œêµ­ì–´ í°íŠ¸ ì ìš©í•˜ì§€ ì•ŠìŒ)
        
        # ìŠ¤í¬ë¡¤ë°” ë¹„í™œì„±í™”
        self.hints_container.set_scrollbar_mode(lv.SCROLLBAR_MODE.OFF)
        self.hints_container.set_scroll_dir(lv.DIR.NONE)
        
        print("  âœ… í•˜ë‹¨ ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ")
    
    def _create_main_container(self):
        """ì¤‘ì•™ ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„±"""
        # ë©”ì¸ ì»¨í…Œì´ë„ˆ (ìƒë‹¨ 25px, í•˜ë‹¨ 20px ì œì™¸)
        self.main_container = lv.obj(self.screen_obj)
        self.main_container.set_size(160, 83)  # 128 - 25 - 20 = 83
        self.main_container.align(lv.ALIGN.TOP_MID, 0, 25)
        self.main_container.set_style_bg_opa(0, 0)
        self.main_container.set_style_border_width(0, 0)
        self.main_container.set_style_pad_all(0, 0)
        
        # ìŠ¤í¬ë¡¤ë°” ë¹„í™œì„±í™”
        self.main_container.set_scrollbar_mode(lv.SCROLLBAR_MODE.OFF)
        self.main_container.set_scroll_dir(lv.DIR.NONE)
        
        # ë©”ì¸ ì»¨í…Œì´ë„ˆ ì•ˆì— ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„±
        self._create_disk_selection_area()
        
        print("  âœ… ì¤‘ì•™ ë©”ì¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ")
    
    def _create_button_hints_area(self):
        """í•˜ë‹¨ ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ ìƒì„±"""
        # ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ (í™”ë©´ í•˜ë‹¨ì— ì§ì ‘ ë°°ì¹˜)
        self.hints_container = lv.obj(self.screen_obj)
        self.hints_container.set_size(140, 18)
        self.hints_container.align(lv.ALIGN.BOTTOM_MID, 0, -2)
        self.hints_container.set_style_bg_opa(0, 0)
        self.hints_container.set_style_border_width(0, 0)
        self.hints_container.set_style_pad_all(0, 0)
        
        # ë²„íŠ¼íŒíŠ¸ í…ìŠ¤íŠ¸ (lv ê¸°ë³¸ í°íŠ¸ ì‚¬ìš©)
        self.hints_text = lv.label(self.hints_container)
        self.hints_text.set_text(f"A:{lv.SYMBOL.UP} B:{lv.SYMBOL.DOWN} C:{lv.SYMBOL.PREV} D:{lv.SYMBOL.DOWNLOAD}")
        self.hints_text.align(lv.ALIGN.CENTER, 0, 0)
        self.hints_text.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
        self.hints_text.set_style_text_color(lv.color_hex(0x8E8E93), 0)
        # lv ê¸°ë³¸ í°íŠ¸ ì‚¬ìš© (í•œêµ­ì–´ í°íŠ¸ ì ìš©í•˜ì§€ ì•ŠìŒ)
        
        print("  âœ… í•˜ë‹¨ ë²„íŠ¼íŒíŠ¸ ì»¨í…Œì´ë„ˆ ìƒì„± ì™„ë£Œ")
        
        # ìŠ¤í¬ë¡¤ë°” ë¹„í™œì„±í™”
        self.hints_container.set_scrollbar_mode(lv.SCROLLBAR_MODE.OFF)
        self.hints_container.set_scroll_dir(lv.DIR.NONE)
    
    def _create_title_area(self):
        """ì œëª© ì˜ì—­ ìƒì„±"""
        print(f"  ğŸ“± ì œëª© ì˜ì—­ ìƒì„± ì‹œë„...")
        
        try:
            # ì œëª© ë¼ë²¨ (í™”ë©´ì— ì§ì ‘)
            self.title_text = lv.label(self.screen_obj)
            self.title_text.set_text("ì•Œì•½ ì¶©ì „")
            self.title_text.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            self.title_text.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
            
            # í•œêµ­ì–´ í°íŠ¸ ì ìš©
            if hasattr(lv, "font_notosans_kr_regular"):
                self.title_text.set_style_text_font(lv.font_notosans_kr_regular, 0)
                print("  âœ… ì œëª©ì— í•œêµ­ì–´ í°íŠ¸ ì ìš© ì™„ë£Œ")
            
            # ì œëª© ìœ„ì¹˜ (ìƒë‹¨ ì¤‘ì•™)
            self.title_text.align(lv.ALIGN.TOP_MID, 0, 10)
            
            print("  âœ… ì œëª© í…ìŠ¤íŠ¸ ìƒì„± ì™„ë£Œ")
            print("  ğŸ“± ì œëª© ì˜ì—­ ìƒì„± ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ ì œëª© ì˜ì—­ ìƒì„± ì‹¤íŒ¨: {e}")
    
    def _create_disk_selection_area_old(self):
        """ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„± (ê¸°ì¡´ ë²„ì „ - ì‚¬ìš© ì•ˆí•¨)"""
        print(f"  ğŸ“± ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„± ì‹œë„...")
        
        try:
            # ë””ìŠ¤í¬ ì˜µì…˜ë“¤
            self.disk_options = ["ë””ìŠ¤í¬ 1", "ë””ìŠ¤í¬ 2", "ë””ìŠ¤í¬ 3"]
            
            # ë¡¤ëŸ¬ ì˜µì…˜ì„ ê°œí–‰ ë¬¸ìë¡œ ì—°ê²°
            roller_options_str = "\n".join(self.disk_options)
            print(f"  ğŸ“± ë¡¤ëŸ¬ ì˜µì…˜: {roller_options_str}")
            
            # ë¡¤ëŸ¬ ìœ„ì ¯ ìƒì„± (í™”ë©´ì— ì§ì ‘)
            self.disk_roller = lv.roller(self.screen_obj)
            self.disk_roller.set_options(roller_options_str, lv.roller.MODE.INFINITE)
            self.disk_roller.set_size(120, 60)
            self.disk_roller.align(lv.ALIGN.CENTER, 0, 0)  # í™”ë©´ ì¤‘ì•™ì— ë°°ì¹˜
            
            # ë¡¤ëŸ¬ ìŠ¤íƒ€ì¼ ì„¤ì • (dose_count_screenê³¼ ë™ì¼)
            self.disk_roller.set_style_bg_color(lv.color_hex(0xF2F2F7), 0)  # iOS ë¼ì´íŠ¸ ê·¸ë ˆì´
            self.disk_roller.set_style_bg_opa(255, 0)
            self.disk_roller.set_style_radius(10, 0)
            self.disk_roller.set_style_border_width(1, 0)
            self.disk_roller.set_style_border_color(lv.color_hex(0xD1D5DB), 0)
            
            # ë¡¤ëŸ¬ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
            self.disk_roller.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            self.disk_roller.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
            
            # í•œêµ­ì–´ í°íŠ¸ ì ìš©
            if hasattr(lv, "font_notosans_kr_regular"):
                self.disk_roller.set_style_text_font(lv.font_notosans_kr_regular, 0)
                print("  âœ… ë¡¤ëŸ¬ì— í•œêµ­ì–´ í°íŠ¸ ì ìš© ì™„ë£Œ")
            
            # ë¡¤ëŸ¬ ì„ íƒëœ í•­ëª© ìŠ¤íƒ€ì¼ - ë¡œê³  ìƒ‰ìƒ(ë¯¼íŠ¸)
            try:
                self.disk_roller.set_style_bg_color(lv.color_hex(0x00C9A7), lv.PART.SELECTED)  # ë¯¼íŠ¸ìƒ‰ (ë¡œê³ ì™€ ë™ì¼)
                self.disk_roller.set_style_bg_opa(255, lv.PART.SELECTED)
                self.disk_roller.set_style_text_color(lv.color_hex(0xFFFFFF), lv.PART.SELECTED)  # í°ìƒ‰ í…ìŠ¤íŠ¸
                self.disk_roller.set_style_radius(6, lv.PART.SELECTED)
                print("  âœ… ë¡¤ëŸ¬ ì„ íƒëœ í•­ëª© ìŠ¤íƒ€ì¼ ì„¤ì • ì™„ë£Œ")
            except AttributeError:
                print("  âš ï¸ lv.PART.SELECTED ì§€ì› ì•ˆë¨, ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì‚¬ìš©")
            
            # ì´ˆê¸° ì„ íƒ ì„¤ì • (ë””ìŠ¤í¬ 1ì´ ê¸°ë³¸ê°’)
            try:
                self.disk_roller.set_selected(self.selected_disk_index, lv.ANIM.OFF)
            except AttributeError:
                self.disk_roller.set_selected(self.selected_disk_index, 0)
            
            print("  âœ… ë””ìŠ¤í¬ ì„ íƒ ë¡¤ëŸ¬ ìƒì„± ì™„ë£Œ")
            print("  âœ… ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„± ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ì„ íƒ ì˜ì—­ ìƒì„± ì‹¤íŒ¨: {e}")
    
    def _create_button_hints_area(self):
        """í•˜ë‹¨ ë²„íŠ¼ íŒíŠ¸ ì˜ì—­ ìƒì„± (ê°„ë‹¨í•œ ë°©ì‹)"""
        try:
            print("  ğŸ“± ë²„íŠ¼ íŒíŠ¸ í…ìŠ¤íŠ¸ ìƒì„± ì‹œë„...")
            
            # ë²„íŠ¼ íŒíŠ¸ í…ìŠ¤íŠ¸ (í™”ë©´ì— ì§ì ‘) - dose_count_screenê³¼ ë™ì¼í•œ ìŠ¤íƒ€ì¼
            self.hints_text = lv.label(self.screen_obj)
            
            # ë²„íŠ¼ íŒíŠ¸ ì„¤ì • (lv.SYMBOL.DOWNLOAD ì‚¬ìš©)
            self.hints_text.set_text(f"A:- B:- C:- D:{lv.SYMBOL.DOWNLOAD}")
            print(f"  âœ… ë²„íŠ¼ íŒíŠ¸ ì„¤ì • ì™„ë£Œ: A:- B:- C:- D:{lv.SYMBOL.DOWNLOAD}")
            
            self.hints_text.set_style_text_color(lv.color_hex(0x8E8E93), 0)  # ëª¨ë˜ ë¼ì´íŠ¸ ê·¸ë ˆì´
            # lv ê¸°ë³¸ í°íŠ¸ ì‚¬ìš© (í•œêµ­ì–´ í°íŠ¸ ì ìš©í•˜ì§€ ì•ŠìŒ) - dose_count_screenê³¼ ë™ì¼
            
            # dose_count_screenê³¼ ë™ì¼í•œ ìœ„ì¹˜ (BOTTOM_MID, 0, -2)
            self.hints_text.align(lv.ALIGN.BOTTOM_MID, 0, -2)
            self.hints_text.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
            
            print("  âœ… ë²„íŠ¼ íŒíŠ¸ ì˜ì—­ ìƒì„± ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ ë²„íŠ¼ íŒíŠ¸ ì˜ì—­ ìƒì„± ì‹¤íŒ¨: {e}")
    
    def _create_loading_sub_screen(self):
        """ë””ìŠ¤í¬ ì¶©ì „ ì„œë¸Œ í™”ë©´ ìƒì„±"""
        print(f"  ğŸ“± ë””ìŠ¤í¬ ì¶©ì „ ì„œë¸Œ í™”ë©´ ìƒì„± ì‹œì‘...")
        
        try:
            # ê¸°ì¡´ í™”ë©´ ìˆ¨ê¸°ê¸°
            print(f"  ğŸ“± ê¸°ì¡´ í™”ë©´ ìˆ¨ê¸°ê¸°...")
            if hasattr(self, 'disk_roller') and self.disk_roller:
                self.disk_roller.set_style_opa(0, 0)  # íˆ¬ëª…í•˜ê²Œ
                print(f"  âœ… ë¡¤ëŸ¬ ìˆ¨ê¹€ ì™„ë£Œ")
            else:
                print(f"  ğŸ“± ë¡¤ëŸ¬ê°€ ì—†ìŒ (ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ)")
            
            # ì œëª© ì—…ë°ì´íŠ¸
            print(f"  ğŸ“± ì œëª© ì—…ë°ì´íŠ¸...")
            if hasattr(self, 'title_text'):
                meal_name = self._get_meal_name_by_disk(self.selected_disk_index)
                self.title_text.set_text(f"{meal_name}ì•½ ì¶©ì „")
                print(f"  âœ… ì œëª© ì—…ë°ì´íŠ¸ ì™„ë£Œ: {meal_name}ì•½ ì¶©ì „")
            
            # ì•„í¬ í”„ë¡œê·¸ë ˆìŠ¤ ë°” ìƒì„± (ì™¼ìª½ìœ¼ë¡œ ì´ë™, ì•„ë˜ë¡œ 10í”½ì…€)
            print(f"  ğŸ“± ì•„í¬ í”„ë¡œê·¸ë ˆìŠ¤ ë°” ìƒì„±...")
            self.progress_arc = lv.arc(self.screen_obj)
            self.progress_arc.set_size(60, 60)
            self.progress_arc.align(lv.ALIGN.CENTER, -30, 10)
            print(f"  âœ… ì•„í¬ ìƒì„± ë° ìœ„ì¹˜ ì„¤ì • ì™„ë£Œ")
            
            # ì•„í¬ ì„¤ì • (270ë„ì—ì„œ ì‹œì‘í•˜ì—¬ ì‹œê³„ë°©í–¥ìœ¼ë¡œ)
            print(f"  ğŸ“± ì•„í¬ ì„¤ì •...")
            self.progress_arc.set_bg_angles(0, 360)
            
            # í˜„ì¬ ì¶©ì „ ìƒíƒœë¥¼ ë°˜ì˜í•œ ê°ë„ ì„¤ì •
            progress = self.current_disk_state.get_loading_progress()
            arc_angle = int((progress / 100) * 360)
            self.progress_arc.set_angles(0, arc_angle)  # ì €ì¥ëœ ìƒíƒœ ë°˜ì˜
            print(f"  ğŸ“± ì•„í¬ ì´ˆê¸° ê°ë„: {arc_angle}ë„ (ì§„í–‰ë¥ : {progress:.0f}%)")
            
            self.progress_arc.set_rotation(270)  # 12ì‹œ ë°©í–¥ì—ì„œ ì‹œì‘
            print(f"  âœ… ì•„í¬ ê°ë„ ì„¤ì • ì™„ë£Œ")
            
            # ì•„í¬ ìŠ¤íƒ€ì¼ ì„¤ì •
            print(f"  ğŸ“± ì•„í¬ ìŠ¤íƒ€ì¼ ì„¤ì •...")
            self.progress_arc.set_style_arc_width(6, 0)  # ë°°ê²½ ì•„í¬ ë‘ê»˜
            self.progress_arc.set_style_arc_color(lv.color_hex(0xE0E0E0), 0)  # ë°°ê²½ íšŒìƒ‰
            self.progress_arc.set_style_arc_width(6, lv.PART.INDICATOR)  # ì§„í–‰ ì•„í¬ ë‘ê»˜
            self.progress_arc.set_style_arc_color(lv.color_hex(0x00C9A7), lv.PART.INDICATOR)  # ì§„í–‰ ë¯¼íŠ¸ìƒ‰
            
            # ì•„í¬ ëë¶€ë¶„ ë™ê·¸ë¼ë¯¸(knob) ìŠ¤íƒ€ì¼ - ë¯¼íŠ¸ìƒ‰ìœ¼ë¡œ ì„¤ì •
            try:
                self.progress_arc.set_style_bg_color(lv.color_hex(0x00C9A7), lv.PART.KNOB)  # ë¯¼íŠ¸ìƒ‰
                self.progress_arc.set_style_bg_opa(255, lv.PART.KNOB)
                print(f"  âœ… ì•„í¬ knob ìŠ¤íƒ€ì¼ ì„¤ì • ì™„ë£Œ (ë¯¼íŠ¸ìƒ‰)")
            except AttributeError:
                print(f"  âš ï¸ lv.PART.KNOB ì§€ì› ì•ˆë¨, ê±´ë„ˆë›°ê¸°")
            
            print(f"  âœ… ì•„í¬ ìŠ¤íƒ€ì¼ ì„¤ì • ì™„ë£Œ")
            
            # ì§„í–‰ë¥  í…ìŠ¤íŠ¸ ë¼ë²¨ (ì•„í¬ ì¤‘ì•™ì—)
            print(f"  ğŸ“± ì§„í–‰ë¥  í…ìŠ¤íŠ¸ ë¼ë²¨ ìƒì„±...")
            self.progress_label = lv.label(self.screen_obj)
            progress = self.current_disk_state.get_loading_progress()
            self.progress_label.set_text(f"{progress:.0f}%")
            self.progress_label.set_style_text_color(lv.color_hex(0x1D1D1F), 0)
            self.progress_label.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
            print(f"  âœ… ì§„í–‰ë¥  ë¼ë²¨ ìƒì„± ì™„ë£Œ: {progress:.0f}%")
            
            # í•œêµ­ì–´ í°íŠ¸ ì ìš©
            if hasattr(lv, "font_notosans_kr_regular"):
                self.progress_label.set_style_text_font(lv.font_notosans_kr_regular, 0)
                print("  âœ… ì§„í–‰ë¥  ë¼ë²¨ì— í•œêµ­ì–´ í°íŠ¸ ì ìš© ì™„ë£Œ")
            
            # ì•„í¬ ì¤‘ì•™ì— í…ìŠ¤íŠ¸ ë°°ì¹˜ (ì•„í¬ì™€ í•¨ê»˜ ì™¼ìª½ìœ¼ë¡œ ì´ë™, ì•„ë˜ë¡œ 10í”½ì…€)
            self.progress_label.align(lv.ALIGN.CENTER, -30, 10)
            print(f"  âœ… ì§„í–‰ë¥  ë¼ë²¨ ìœ„ì¹˜ ì„¤ì • ì™„ë£Œ")
            
            # ì„¸ë¶€ ì •ë³´ ë¼ë²¨ (ì•„í¬ ì˜¤ë¥¸ìª½ì—) - ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜ ì¹´ìš´íŠ¸
            print(f"  ğŸ“± ì„¸ë¶€ ì •ë³´ ë¼ë²¨ ìƒì„±...")
            self.detail_label = lv.label(self.screen_obj)
            loaded_count = self.current_disk_state.loaded_count
            self.detail_label.set_text(f"{loaded_count}/15ì¹¸")
            self.detail_label.set_style_text_color(lv.color_hex(0x000000), 0)  # ê²€ì •ìƒ‰
            self.detail_label.set_style_text_align(lv.TEXT_ALIGN.CENTER, 0)
            self.detail_label.set_style_opa(255, 0)  # ì™„ì „ ë¶ˆíˆ¬ëª…
            print(f"  âœ… ì„¸ë¶€ ì •ë³´ ë¼ë²¨ ìƒì„± ì™„ë£Œ: {loaded_count}/15ì¹¸")
            
            # í•œêµ­ì–´ í°íŠ¸ ì ìš© (Noto Sans KR) - wifi_scan_screen ë°©ì‹ ì‚¬ìš©
            if hasattr(lv, "font_notosans_kr_regular"):
                self.detail_label.set_style_text_font(lv.font_notosans_kr_regular, 0)
                print("  âœ… 0/15ì¹¸ ë¼ë²¨ì— í•œêµ­ì–´ í°íŠ¸ ì ìš© ì™„ë£Œ")
            else:
                print("  âš ï¸ í•œêµ­ì–´ í°íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
            
            # ì•„í¬ ì˜¤ë¥¸ìª½ì— ë°°ì¹˜ (ì•„í¬ì™€ ê°™ì€ ë†’ì´)
            print(f"  ğŸ“± ì„¸ë¶€ ì •ë³´ ë¼ë²¨ ìœ„ì¹˜ ì„¤ì •: CENTER, 30, 10")
            self.detail_label.align(lv.ALIGN.CENTER, 30, 10)
            print(f"  âœ… ì„¸ë¶€ ì •ë³´ ë¼ë²¨ ìœ„ì¹˜ ì„¤ì • ì™„ë£Œ")
            
            # ìœ„ì¹˜ ê°•ì œ ì—…ë°ì´íŠ¸
            print(f"  ğŸ“± ë¼ë²¨ ìœ„ì¹˜ ê°•ì œ ì—…ë°ì´íŠ¸...")
            try:
                lv.timer_handler()
                print(f"  âœ… ë¼ë²¨ ìœ„ì¹˜ ê°•ì œ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
            except Exception as e:
                print(f"  âš ï¸ ë¼ë²¨ ìœ„ì¹˜ ê°•ì œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
            
            # ë””ìŠ¤í¬ ì‹œê°í™” ì œê±° - ì•„í¬ë§Œ ì‚¬ìš©
            
            # ë²„íŠ¼ íŒíŠ¸ ì—…ë°ì´íŠ¸
            print(f"  ğŸ“± ë²„íŠ¼ íŒíŠ¸ ì—…ë°ì´íŠ¸...")
            try:
                if hasattr(self, 'hints_text') and self.hints_text:
                    self.hints_text.set_text(f"A:- B:- C:- D:{lv.SYMBOL.DOWNLOAD}")
                    print(f"  âœ… ë²„íŠ¼ íŒíŠ¸ ì—…ë°ì´íŠ¸ ì™„ë£Œ")
                else:
                    print(f"  âš ï¸ ë²„íŠ¼ íŒíŠ¸ í…ìŠ¤íŠ¸ ê°ì²´ê°€ ì—†ìŒ")
            except Exception as e:
                print(f"  âŒ ë²„íŠ¼ íŒíŠ¸ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
            
            print("  âœ… ë””ìŠ¤í¬ ì¶©ì „ ì„œë¸Œ í™”ë©´ ìƒì„± ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ì¶©ì „ ì„œë¸Œ í™”ë©´ ìƒì„± ì‹¤íŒ¨: {e}")
    
    def _create_disk_visualization(self):
        """ë””ìŠ¤í¬ ì‹œê°í™” ì œê±°ë¨ - ì•„í¬ë§Œ ì‚¬ìš©"""
        # ë””ìŠ¤í¬ ì‹œê°í™” ê¸°ëŠ¥ ì œê±°ë¨
        pass
    
    def _update_disk_visualization(self):
        """ì•„í¬ í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜)"""
        try:
            # ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            if hasattr(self, 'progress_label'):
                progress = self.current_disk_state.get_loading_progress()
                
                # ì•„í¬ í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸
                if hasattr(self, 'progress_arc'):
                    # 0-360ë„ ë²”ìœ„ë¡œ ë³€í™˜ (0% = 0ë„, 100% = 360ë„)
                    arc_angle = int((progress / 100) * 360)
                    self.progress_arc.set_angles(0, arc_angle)
                
                # ì§„í–‰ë¥  í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                self.progress_label.set_text(f"{progress:.0f}%")
                
                # ì„¸ë¶€ ì •ë³´ ì—…ë°ì´íŠ¸ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜ ì¹´ìš´íŠ¸)
                if hasattr(self, 'detail_label'):
                    loaded_count = self.current_disk_state.loaded_count
                    self.detail_label.set_text(f"{loaded_count}/15ì¹¸")
            
            # âš¡ LVGL í™”ë©´ ê°±ì‹  ì œê±° (ëª¨í„° ì„±ëŠ¥ ìš°ì„ )
            # import lvgl as lv
            # lv.timer_handler()
            
            # âš¡ íŒŒì¼ ì €ì¥ ì œê±° (ë§¤ ì¹¸ë§ˆë‹¤ ì €ì¥í•˜ì§€ ì•ŠìŒ, 3ì¹¸ ì™„ë£Œ í›„ì—ë§Œ ì €ì¥)
            # self._save_disk_states()
            
        except Exception as e:
            print(f"  âŒ ì•„í¬ í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
    
    def get_selected_disk(self):
        """ì„ íƒëœ ë””ìŠ¤í¬ ë²ˆí˜¸ ë°˜í™˜ (ì‹¤ì œ ë””ìŠ¤í¬ ì¸ë±ìŠ¤)"""
        try:
            if hasattr(self, 'disk_roller') and self.disk_roller:
                # ë¡¤ëŸ¬ì—ì„œ ì„ íƒëœ ì¸ë±ìŠ¤ ê°€ì ¸ì˜¤ê¸°
                roller_selected = self.disk_roller.get_selected()
                
                # available_disksì—ì„œ ì‹¤ì œ ë””ìŠ¤í¬ ì¸ë±ìŠ¤ ê°€ì ¸ì˜¤ê¸°
                if roller_selected < len(self.available_disks):
                    actual_disk_index = self.available_disks[roller_selected]
                    self.selected_disk_index = actual_disk_index
                    return actual_disk_index + 1  # 1, 2, 3
                else:
                    print(f"  âŒ ì˜ëª»ëœ ë¡¤ëŸ¬ ì„ íƒ ì¸ë±ìŠ¤: {roller_selected}")
                    return 1  # ê¸°ë³¸ê°’
            else:
                # ë¡¤ëŸ¬ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
                return self.selected_disk_index + 1
        except Exception as e:
            print(f"  âŒ ì„ íƒëœ ë””ìŠ¤í¬ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: {e}")
            return 1  # ê¸°ë³¸ê°’
    
    def get_title(self):
        """í™”ë©´ ì œëª©"""
        return "ì•Œì•½ ì¶©ì „"
    
    def get_button_hints(self):
        """ë²„íŠ¼ íŒíŠ¸ (ê¸°í˜¸ ì‚¬ìš©)"""
        try:
            up_symbol = getattr(lv.SYMBOL, 'UP', '^')
            down_symbol = getattr(lv.SYMBOL, 'DOWN', 'v')
            prev_symbol = getattr(lv.SYMBOL, 'PREV', '<')
            ok_symbol = getattr(lv.SYMBOL, 'OK', 'âœ“')
            return f"A:{up_symbol} B:{down_symbol} C:{prev_symbol} D:{ok_symbol}"
        except:
            return "A:^ B:v C:< D:âœ“"
    
    def get_voice_file(self):
        """ì•ˆë‚´ ìŒì„± íŒŒì¼"""
        return "wav_pill_loading_prompt.wav"
    
    def get_effect_file(self):
        """íš¨ê³¼ìŒ íŒŒì¼"""
        return "wav_select.wav"
    
    
    def hide(self):
        """í™”ë©´ ìˆ¨ê¸°ê¸°"""
        pass
    
    def update(self):
        """í™”ë©´ ì—…ë°ì´íŠ¸"""
        pass
    
    def on_button_a(self):
        """ë²„íŠ¼ A ì²˜ë¦¬ - ì´ì „ í™”ë©´ìœ¼ë¡œ (ë³µìš© ì‹œê°„ ì„¤ì • í™”ë©´ìœ¼ë¡œ)"""
        if self.current_mode == 'selection':
            print("ì´ì „ í™”ë©´ìœ¼ë¡œ ì´ë™ (ë³µìš© ì‹œê°„ ì„¤ì • í™”ë©´)")
            
            # ë³µìš© ì‹œê°„ ì„¤ì • í™”ë©´ìœ¼ë¡œ ì´ë™
            if hasattr(self.screen_manager, 'screens') and 'dose_time' in self.screen_manager.screens:
                self.screen_manager.show_screen('dose_time')
            else:
                print("  ğŸ“± ë³µìš© ì‹œê°„ ì„¤ì • í™”ë©´ì´ ì—†ì–´ì„œ í˜„ì¬ í™”ë©´ì— ë¨¸ë¬¼ê¸°")
        
        elif self.current_mode == 'loading':
            print("ë””ìŠ¤í¬ íšŒì „ ê¸°ëŠ¥ ë¹„í™œì„±í™” - ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜ ì¶©ì „ë§Œ ì‚¬ìš©")
    
    def on_button_b(self):
        """ë²„íŠ¼ B ì²˜ë¦¬ - ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ (ë©”ì¸ í™”ë©´ìœ¼ë¡œ)"""
        print(f"ğŸ”˜ ë²„íŠ¼ B í´ë¦­ë¨ - í˜„ì¬ ëª¨ë“œ: {self.current_mode}")
        
        if self.current_mode == 'selection':
            print("ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì´ë™ (ë©”ì¸ í™”ë©´)")
            
            # í™”ë©´ ë§¤ë‹ˆì € ìƒíƒœ í™•ì¸
            print(f"  ğŸ“± í™”ë©´ ë§¤ë‹ˆì € ì¡´ì¬: {hasattr(self.screen_manager, 'screens')}")
            if hasattr(self.screen_manager, 'screens'):
                print(f"  ğŸ“± ë“±ë¡ëœ í™”ë©´ë“¤: {list(self.screen_manager.screens.keys())}")
                print(f"  ğŸ“± main í™”ë©´ ë“±ë¡ë¨: {'main' in self.screen_manager.screens}")
            
            # ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™
            if hasattr(self.screen_manager, 'screens') and 'main' in self.screen_manager.screens:
                print("  ğŸ“± ê¸°ì¡´ main í™”ë©´ìœ¼ë¡œ ì´ë™ ì‹œë„...")
                success = self.screen_manager.show_screen('main')
                print(f"  ğŸ“± í™”ë©´ ì „í™˜ ê²°ê³¼: {success}")
            else:
                # ë©”ì¸ í™”ë©´ì´ ì—†ìœ¼ë©´ ë™ì ìœ¼ë¡œ ìƒì„±
                print("  ğŸ“± main í™”ë©´ì´ ë“±ë¡ë˜ì§€ ì•ŠìŒ. ë™ì  ìƒì„± ì¤‘...")
                try:
                    from screens.main_screen import MainScreen
                    main_screen = MainScreen(self.screen_manager)
                    self.screen_manager.register_screen('main', main_screen)
                    print("  âœ… main í™”ë©´ ìƒì„± ë° ë“±ë¡ ì™„ë£Œ")
                    success = self.screen_manager.show_screen('main')
                    print(f"  ğŸ“± ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì™„ë£Œ: {success}")
                except Exception as e:
                    print(f"  âŒ ë©”ì¸ í™”ë©´ ìƒì„± ì‹¤íŒ¨: {e}")
                    print("  ğŸ“± ë©”ì¸ í™”ë©´ ìƒì„± ì‹¤íŒ¨ë¡œ í˜„ì¬ í™”ë©´ì— ë¨¸ë¬¼ê¸°")
        
        elif self.current_mode == 'loading':
            print("ë””ìŠ¤í¬ íšŒì „ ê¸°ëŠ¥ ë¹„í™œì„±í™” - ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜ ì¶©ì „ë§Œ ì‚¬ìš©")
    
    def on_button_c(self):
        """ë²„íŠ¼ C ì²˜ë¦¬ - ë””ìŠ¤í¬ ì„ íƒ (ì•Œì•½ ì¶©ì „ ì„œë¸Œ í™”ë©´ìœ¼ë¡œ)"""
        if self.current_mode == 'selection':
            if self.sequential_mode:
                # ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œ - ë°”ë¡œ ì²« ë²ˆì§¸ ë””ìŠ¤í¬ ì¶©ì „ ì‹œì‘
                print(f"ìˆœì°¨ì  ì¶©ì „ ì‹œì‘")
                self.start_sequential_loading()
            else:
                # ê°œë³„ ì„ íƒ ëª¨ë“œ
                selected_disk = self.get_selected_disk()
                print(f"ë””ìŠ¤í¬ {selected_disk} ì„ íƒ - ì¶©ì „ ëª¨ë“œë¡œ ì „í™˜")
                
                # ì¶©ì „ ëª¨ë“œë¡œ ì „í™˜
                self.current_disk_state = self.disk_states[self.selected_disk_index]
                self.current_mode = 'loading'
                
                # ì„œë¸Œ í™”ë©´ ìƒì„±
                self._create_loading_sub_screen()
        
        elif self.current_mode == 'loading':
            print("ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ")
            
            if self.sequential_mode:
                # ìˆœì°¨ì  ì¶©ì „ ëª¨ë“œì—ì„œ 15ì¹¸ì´ ëª¨ë‘ ì¶©ì „ëœ ê²½ìš°ì—ë§Œ ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ
                if self.current_disk_state.loaded_count >= 15:
                    print(f"ğŸ“± ë””ìŠ¤í¬ {self.selected_disk_index} 15ì¹¸ ì™„ë£Œ - ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ ì´ë™")
                    self._complete_current_disk_loading()
                else:
                    print(f"ğŸ“± ë””ìŠ¤í¬ {self.selected_disk_index} {self.current_disk_state.loaded_count}/15ì¹¸ - ì•„ì§ ì™„ë£Œë˜ì§€ ì•ŠìŒ")
            else:
                # ê°œë³„ ì„ íƒ ëª¨ë“œì—ì„œ ë””ìŠ¤í¬ ì„ íƒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                self._return_to_selection_mode()
    
    def on_button_d(self):
        """ë²„íŠ¼ D ì²˜ë¦¬ - ë””ìŠ¤í¬ ì„ íƒ (ë””ìŠ¤í¬1, 2, 3 ì´ë™)"""
        if self.current_mode == 'selection':
            print("ì•Œì•½ ì¶©ì „ ë””ìŠ¤í¬ ì•„ë˜ë¡œ ì´ë™")
            
            # ë¬´í•œ íšŒì „ì„ ìœ„í•´ ì¸ë±ìŠ¤ ìˆœí™˜
            next_index = (self.selected_disk_index + 1) % len(self.disk_options)
            print(f"  ğŸ“± ë¡¤ëŸ¬ ì„ íƒ ì—…ë°ì´íŠ¸: ì¸ë±ìŠ¤ {next_index}")
            
            # ë¡¤ëŸ¬ ì§ì ‘ ì¡°ì‘ (ì• ë‹ˆë©”ì´ì…˜ê³¼ í•¨ê»˜)
            try:
                self.disk_roller.set_selected(next_index, lv.ANIM.ON)
                print(f"  ğŸ“± ë¡¤ëŸ¬ ì• ë‹ˆë©”ì´ì…˜ê³¼ í•¨ê»˜ ì„¤ì • ì™„ë£Œ")
            except AttributeError:
                self.disk_roller.set_selected(next_index, 1)
                print(f"  ğŸ“± ë¡¤ëŸ¬ ì• ë‹ˆë©”ì´ì…˜ ì—†ì´ ì„¤ì • ì™„ë£Œ")
            
            # ê°•ì œ ì—…ë°ì´íŠ¸
            try:
                lv.timer_handler()
            except:
                pass
            
            self.selected_disk_index = next_index
            print(f"  âœ… ë¡¤ëŸ¬ ì„ íƒ ì—…ë°ì´íŠ¸ ì™„ë£Œ: {self.disk_options[self.selected_disk_index]}")
            
        elif self.current_mode == 'loading':
            print("ì•Œì•½ ì¶©ì „ ì‹¤í–‰ - ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê¸°ë°˜")
            
            # ì¶©ì „ ê°€ëŠ¥í•œì§€ í™•ì¸
            if self.current_disk_state.can_load_more():
                disk_index = self.current_disk_state.disk_id - 1  # 0, 1, 2
                
                # ì‹¤ì œ ëª¨í„° ì œì–´ë§Œ ì‚¬ìš©
                if self.motor_system and self.motor_system.motor_controller:
                    success = self._real_loading(disk_index)
                    if not success:
                        print("  ğŸ“± ì¶©ì „ ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•ŠìŒ")
                else:
                    print("  âŒ ëª¨í„° ì‹œìŠ¤í…œì´ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ - ì¶©ì „ ë¶ˆê°€ëŠ¥")
            else:
                print("  ğŸ“± ë” ì´ìƒ ì¶©ì „í•  ì¹¸ì´ ì—†ìŠµë‹ˆë‹¤")
                print("  ğŸ‰ ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ! (15/15ì¹¸)")
                # ì¶©ì „ ì™„ë£Œ - ìˆ˜ë™ìœ¼ë¡œ ì™„ë£Œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ í•¨
                print("  ğŸ“± ì™„ë£Œ ë²„íŠ¼(C)ì„ ëˆŒëŸ¬ ë””ìŠ¤í¬ ì„ íƒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ì„¸ìš”")
    
    def _return_to_selection_mode(self):
        """ë””ìŠ¤í¬ ì„ íƒ ëª¨ë“œë¡œ ëŒì•„ê°€ê¸°"""
        print("  ğŸ“± ë””ìŠ¤í¬ ì„ íƒ ëª¨ë“œë¡œ ëŒì•„ê°€ê¸°")
        
        # ëª¨ë“œ ë³€ê²½
        self.current_mode = 'selection'
        
        # ê¸°ì¡´ ì„œë¸Œ í™”ë©´ ìš”ì†Œë“¤ ìˆ¨ê¸°ê¸°
        if hasattr(self, 'progress_arc'):
            self.progress_arc.set_style_opa(0, 0)
        if hasattr(self, 'progress_label'):
            self.progress_label.set_style_opa(0, 0)
        if hasattr(self, 'detail_label'):
            self.detail_label.set_style_opa(0, 0)
        
        # ì›ë˜ í™”ë©´ ë³µì›
        if hasattr(self, 'disk_roller'):
            self.disk_roller.set_style_opa(255, 0)  # ë‹¤ì‹œ ë³´ì´ê²Œ
        
        # ì œëª©ê³¼ ë²„íŠ¼ íŒíŠ¸ ë³µì›
        if hasattr(self, 'title_text'):
            self.title_text.set_text("ì•Œì•½ ì¶©ì „")
        if hasattr(self, 'hints_text'):
            self.hints_text.set_text(f"A:- B:- C:- D:{lv.SYMBOL.DOWNLOAD}")
        
        # í™”ë©´ ê°•ì œ ì—…ë°ì´íŠ¸
        try:
            lv.timer_handler()
        except:
            pass
    
    
    def _real_loading(self, disk_index):
        """ì‹¤ì œ ëª¨í„° ì œì–´ë¥¼ í†µí•œ ì•Œì•½ ì¶©ì „ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ì—£ì§€ ê°ì§€ ë°©ì‹)"""
        print(f"  ğŸ“± ì‹¤ì œ ëª¨í„° ì œì–´: ë””ìŠ¤í¬ {disk_index + 1} ì¶©ì „ ì‹œì‘")
        
        try:
            if not self.motor_system or not self.motor_system.motor_controller:
                print("  âŒ ëª¨í„° ì‹œìŠ¤í…œì´ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ")
                return False
            
            # âš¡ ì¶©ì „ ì‹œì‘ ì „ ëª¨ë“  ëª¨í„° ì½”ì¼ OFF (ì „ë ¥ ì†Œëª¨ ë°©ì§€)
            print(f"  âš¡ ì¶©ì „ ì‹œì‘ ì „ ëª¨ë“  ëª¨í„° ì½”ì¼ OFF")
            self.motor_system.motor_controller.stop_all_motors()
            
            if self.current_disk_state.start_loading():
                print(f"  ğŸ“± ëª¨í„° íšŒì „ ì‹œì‘ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ëˆŒë¦¼ ê°ì§€ 3ë²ˆê¹Œì§€)")
                
                # ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ìƒíƒœ ì¶”ì  ë³€ìˆ˜ (í•œ ë²ˆë§Œ ì´ˆê¸°í™”)
                prev_limit_state = False
                current_limit_state = False
                step_count = 0
                max_steps = 5000  # ìµœëŒ€ 5000ìŠ¤í… í›„ ê°•ì œ ì¢…ë£Œ (ì•ˆì „ì¥ì¹˜)
                
                # ì´ˆê¸° ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ìƒíƒœ í™•ì¸
                motor_index = disk_index + 1  # disk_indexëŠ” 0,1,2ì´ì§€ë§Œ ëª¨í„° ë²ˆí˜¸ëŠ” 1,2,3ì´ë¯€ë¡œ +1
                current_limit_state = self.motor_system.motor_controller.is_limit_switch_pressed(motor_index)
                print(f"  ğŸ“± ì´ˆê¸° ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ìƒíƒœ: {'ëˆŒë¦¼' if current_limit_state else 'ì•ˆëˆŒë¦¼'}")
                
                # ì´ˆê¸° ìƒíƒœê°€ ëˆŒë¦° ê²½ìš° ì²« ë²ˆì§¸ ê°ì§€ë¥¼ ë¬´ì‹œí•˜ê¸° ìœ„í•œ í”Œë˜ê·¸
                skip_first_detection = current_limit_state
                
                try:
                    # ë‹¨ì¼ ë£¨í”„ë¡œ 3ì¹¸ ëª¨ë‘ ì²˜ë¦¬
                    while self.current_disk_state.is_loading and step_count < max_steps:
                        step_count += 1
                        
                        # 100ìŠ¤í…ë§ˆë‹¤ ì§„í–‰ ìƒí™© ì¶œë ¥
                        if step_count % 100 == 0:
                            print(f"  ğŸ“ ì¶©ì „ ì§„í–‰ ì¤‘... ìŠ¤í… {step_count}, í˜„ì¬ ìƒíƒœ: {self.current_disk_state.loaded_count}ì¹¸")
                        
                        # 1ìŠ¤í…ì”© íšŒì „ (ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê°ì§€ë˜ì–´ë„ ê³„ì† íšŒì „) - ë°˜ì‹œê³„ë°©í–¥
                        # disk_indexëŠ” 0,1,2ì´ì§€ë§Œ ëª¨í„° ë²ˆí˜¸ëŠ” 1,2,3ì´ë¯€ë¡œ +1
                        motor_index = disk_index + 1
                        
                        # 100ìŠ¤í…ë§ˆë‹¤ ëª¨í„° ë™ì‘ í™•ì¸
                        if step_count % 100 == 0:
                            print(f"  ğŸ”§ ëª¨í„° {motor_index} íšŒì „ ì‹œë„ (ìŠ¤í… {step_count})")
                        
                        success = self.motor_system.motor_controller.step_motor_continuous(motor_index, -1, 1)
                        if not success:
                            print(f"  âŒ ëª¨í„° {motor_index} íšŒì „ ì‹¤íŒ¨ (ìŠ¤í… {step_count})")
                            break
                        
                        # í˜„ì¬ ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ìƒíƒœ í™•ì¸ (ì—£ì§€ ê°ì§€ ì •í™•ì„± ìœ„í•´ ë§¤ ìŠ¤í… ì²´í¬)
                        # disk_indexëŠ” 0,1,2ì´ì§€ë§Œ ëª¨í„° ë²ˆí˜¸ëŠ” 1,2,3ì´ë¯€ë¡œ +1
                        current_limit_state = self.motor_system.motor_controller.is_limit_switch_pressed(motor_index)
                        
                        # ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ëˆŒë¦¼ ê°ì§€: ì´ì „ì— ì•ˆëˆŒë ¤ìˆì—ˆê³  ì§€ê¸ˆ ëˆŒë¦° ìƒíƒœ
                        if not prev_limit_state and current_limit_state:
                            # ì´ˆê¸° ìƒíƒœê°€ ëˆŒë¦° ê²½ìš° ì²« ë²ˆì§¸ ê°ì§€ë¥¼ ë¬´ì‹œ
                            if skip_first_detection:
                                print(f"  â­ï¸ ì²« ë²ˆì§¸ ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ê°ì§€ ë¬´ì‹œ (ì´ˆê¸° ìƒíƒœ) - ìŠ¤í… {step_count}")
                                skip_first_detection = False  # ë‹¤ìŒë¶€í„°ëŠ” ì •ìƒ ê°ì§€
                            else:
                                print(f"  ğŸ”˜ ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ëˆŒë¦¼ ê°ì§€! ({self.current_disk_state.loaded_count + 1}ì¹¸) - ìŠ¤í… {step_count}")
                                # ë¦¬ë¯¸íŠ¸ ìŠ¤ìœ„ì¹˜ ëˆŒë¦¼ ê°ì§€ ì‹œ ì¶©ì „ ì™„ë£Œ (ë°ì´í„°ë§Œ ì—…ë°ì´íŠ¸, UIëŠ” ì£¼ê¸°ì ìœ¼ë¡œ)
                                loading_complete = self.current_disk_state.complete_loading()
                                
                                # âš¡ UI ì—…ë°ì´íŠ¸ ì œê±° - 200ìŠ¤í…ë§ˆë‹¤ ê°±ì‹ ìœ¼ë¡œ ì¶©ë¶„ (ëŠê¹€ ì™„ì „ ì œê±°)
                                # self._update_disk_visualization()
                                
                                # 3ì¹¸ ì¶©ì „ì´ ì™„ë£Œë˜ë©´ ë£¨í”„ ì¢…ë£Œ
                                if loading_complete:
                                    print(f"  âœ… 3ì¹¸ ì¶©ì „ ì™„ë£Œ! ì´ {self.current_disk_state.loaded_count}ì¹¸")
                                    # âœ… 3ì¹¸ ì™„ë£Œ í›„ UI ìµœì¢… ì—…ë°ì´íŠ¸ & íŒŒì¼ ì €ì¥
                                    self._update_disk_visualization()  # ìµœì¢… ìƒíƒœ ë°˜ì˜
                                    self._save_disk_states()
                                    
                                    # 15ì¹¸ ì¶©ì „ ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ ë„˜ì–´ê°€ê¸°
                                    if self.current_disk_state.loaded_count >= 15:
                                        if self.sequential_mode:
                                            print(f"  ğŸ“± 15ì¹¸ ì¶©ì „ ì™„ë£Œ - ìë™ìœ¼ë¡œ ë‹¤ìŒ ë””ìŠ¤í¬ë¡œ ì´ë™")
                                            self._complete_current_disk_loading()
                                    else:
                                        print(f"  ğŸ“± 3ì¹¸ ì¶©ì „ ì™„ë£Œ - ë‹¤ìŒ 3ì¹¸ ì¶©ì „ì„ ìœ„í•´ Dë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”")
                                    
                                    break
                        
                        # ìƒíƒœ ì—…ë°ì´íŠ¸ (ë§¤ë²ˆ ì—…ë°ì´íŠ¸, ë¦¬ì…‹ ì•ˆí•¨!)
                        prev_limit_state = current_limit_state
                        
                        # âš¡ ìµœê³  ì„±ëŠ¥ - UI ì—…ë°ì´íŠ¸ ì™„ì „ ì œê±° (ëŠê¹€ 0%)
                        # ëª¨í„° íšŒì „ ì¤‘ì—ëŠ” UI ì—…ë°ì´íŠ¸ ì•ˆí•¨, 3ì¹¸ ì™„ë£Œ í›„ì—ë§Œ ìµœì¢… ì—…ë°ì´íŠ¸
                        # ì´ë ‡ê²Œ í•˜ë©´ ì™„ì „íˆ ëŠê¹€ ì—†ëŠ” ë¶€ë“œëŸ¬ìš´ íšŒì „ ê°€ëŠ¥
                        pass
                    
                    # ì•ˆì „ì¥ì¹˜: ìµœëŒ€ ìŠ¤í… ìˆ˜ì— ë„ë‹¬í•œ ê²½ìš°
                    if step_count >= max_steps:
                        print(f"  âš ï¸ ìµœëŒ€ ìŠ¤í… ìˆ˜ ({max_steps}) ë„ë‹¬, ì¶©ì „ ê°•ì œ ì¢…ë£Œ")
                        self.current_disk_state.is_loading = False
                        # í˜„ì¬ê¹Œì§€ì˜ ì§„í–‰ ìƒí™© ì €ì¥
                        self._update_disk_visualization()
                        self._save_disk_states()
                
                except Exception as e:
                    print(f"  âŒ ëª¨í„° ì œì–´ ì¤‘ ì˜¤ë¥˜: {e}")
                    # ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ ëª¨í„° ì •ì§€
                    self.motor_system.motor_controller.stop_motor(motor_index)
                    return False
                
                # âš¡ ì¶©ì „ ì™„ë£Œ í›„ ëª¨í„° ì½”ì¼ OFF (ì „ë ¥ ì†Œëª¨ ë°©ì§€)
                print(f"  âš¡ ì¶©ì „ ì™„ë£Œ, ëª¨í„° {motor_index} ì½”ì¼ OFF")
                self.motor_system.motor_controller.stop_motor(motor_index)
                
                # ì™„ì „íˆ ì¶©ì „ëœ ê²½ìš° í™•ì¸
                if not self.current_disk_state.can_load_more():
                    print("  ğŸ‰ ì‹¤ì œ ëª¨í„°: ë””ìŠ¤í¬ ì¶©ì „ ì™„ë£Œ! (15/15ì¹¸)")
                    # ì¶©ì „ ì™„ë£Œ - ìˆ˜ë™ìœ¼ë¡œ ì™„ë£Œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì•¼ í•¨
                    print("  ğŸ“± ì™„ë£Œ ë²„íŠ¼(C)ì„ ëˆŒëŸ¬ ë””ìŠ¤í¬ ì„ íƒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ì„¸ìš”")
                    return True
                
                return True
            else:
                print("  ğŸ“± ì‹¤ì œ ëª¨í„°: ë” ì´ìƒ ì¶©ì „í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
                return False
                
        except Exception as e:
            print(f"  âŒ ì‹¤ì œ ëª¨í„° ì¶©ì „ ì‹¤íŒ¨: {e}")
            return False
    
    def reset_disk_state(self, disk_index):
        """íŠ¹ì • ë””ìŠ¤í¬ ìƒíƒœ ì´ˆê¸°í™”"""
        try:
            if disk_index in self.disk_states:
                self.disk_states[disk_index] = DiskState(disk_index + 1)
                print(f"  ğŸ“± ë””ìŠ¤í¬ {disk_index + 1} ìƒíƒœ ì´ˆê¸°í™” ì™„ë£Œ")
                # ì´ˆê¸°í™” í›„ íŒŒì¼ì— ì €ì¥
                self._save_disk_states()
                return True
            else:
                print(f"  âŒ ë””ìŠ¤í¬ {disk_index + 1} ìƒíƒœ ì´ˆê¸°í™” ì‹¤íŒ¨: ì¸ë±ìŠ¤ ì˜¤ë¥˜")
                return False
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ìƒíƒœ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
            return False
    
    def get_disk_loading_status(self):
        """ëª¨ë“  ë””ìŠ¤í¬ì˜ ì¶©ì „ ìƒíƒœ ë°˜í™˜"""
        try:
            status = {}
            for i, disk_state in self.disk_states.items():
                status[f"disk_{i+1}"] = {
                    "loaded_count": disk_state.loaded_count,
                    "total_compartments": disk_state.total_compartments,
                    "progress_percent": disk_state.get_loading_progress(),
                    "is_loading": disk_state.is_loading,
                    "can_load_more": disk_state.can_load_more()
                }
            return status
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨: {e}")
            return {}
    
    def cleanup(self):
        """ë¦¬ì†ŒìŠ¤ ì •ë¦¬"""
        try:
            print(f"  ğŸ“± {self.screen_name} ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‹œì‘...")
            
            # ëª¨í„° ì‹œìŠ¤í…œ ì •ë¦¬
            if hasattr(self, 'motor_system') and self.motor_system:
                try:
                    # ëª¨í„° ì •ì§€ ë“± í•„ìš”í•œ ì •ë¦¬ ì‘ì—…
                    pass
                except:
                    pass
            
            # í™”ë©´ ê°ì²´ ì •ë¦¬
            if hasattr(self, 'screen_obj') and self.screen_obj:
                try:
                    # LVGL ê°ì²´ ì •ë¦¬
                    pass
                except:
                    pass
            
            print(f"  âœ… {self.screen_name} ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì™„ë£Œ")
            
        except Exception as e:
            print(f"  âŒ {self.screen_name} ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì‹¤íŒ¨: {e}")
    
    def get_screen_info(self):
        """í™”ë©´ ì •ë³´ ë°˜í™˜"""
        return {
            "screen_name": self.screen_name,
            "current_mode": self.current_mode,
            "selected_disk": self.get_selected_disk() if self.current_mode == 'selection' else None,
            "disk_states": self.get_disk_loading_status(),
            "is_loading": self.is_loading,
            "loading_progress": self.loading_progress
        }
    
    def set_disk_loading_count(self, disk_index, count):
        """íŠ¹ì • ë””ìŠ¤í¬ì˜ ì¶©ì „ëœ ì¹¸ ìˆ˜ë¥¼ ì„¤ì •"""
        try:
            if disk_index in self.disk_states:
                if 0 <= count <= 15:
                    self.disk_states[disk_index].loaded_count = count
                    print(f"  ğŸ“± ë””ìŠ¤í¬ {disk_index + 1} ì¶©ì „ ì¹¸ ìˆ˜ë¥¼ {count}ë¡œ ì„¤ì •")
                    # ì„¤ì • í›„ íŒŒì¼ì— ì €ì¥
                    self._save_disk_states()
                    return True
                else:
                    print(f"  âŒ ì˜ëª»ëœ ì¹¸ ìˆ˜: {count} (0-15 ë²”ìœ„)")
                    return False
            else:
                print(f"  âŒ ì˜ëª»ëœ ë””ìŠ¤í¬ ì¸ë±ìŠ¤: {disk_index}")
                return False
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ì¶©ì „ ì¹¸ ìˆ˜ ì„¤ì • ì‹¤íŒ¨: {e}")
            return False
    
    def is_disk_fully_loaded(self, disk_index):
        """íŠ¹ì • ë””ìŠ¤í¬ê°€ ì™„ì „íˆ ì¶©ì „ë˜ì—ˆëŠ”ì§€ í™•ì¸"""
        try:
            if disk_index in self.disk_states:
                return self.disk_states[disk_index].loaded_count >= 15
            return False
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ì¶©ì „ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨: {e}")
            return False
    
    def get_next_available_disk(self):
        """ì¶©ì „ ê°€ëŠ¥í•œ ë‹¤ìŒ ë””ìŠ¤í¬ ë°˜í™˜"""
        try:
            for i in range(3):
                if self.disk_states[i].can_load_more():
                    return i
            return None  # ëª¨ë“  ë””ìŠ¤í¬ê°€ ì¶©ì „ë¨
        except Exception as e:
            print(f"  âŒ ë‹¤ìŒ ì‚¬ìš© ê°€ëŠ¥í•œ ë””ìŠ¤í¬ ì¡°íšŒ ì‹¤íŒ¨: {e}")
            return None
    
    def reset_all_disks(self):
        """ëª¨ë“  ë””ìŠ¤í¬ ìƒíƒœ ì´ˆê¸°í™”"""
        try:
            for i in range(3):
                self.disk_states[i] = DiskState(i + 1)
            print("  ğŸ“± ëª¨ë“  ë””ìŠ¤í¬ ìƒíƒœ ì´ˆê¸°í™” ì™„ë£Œ")
            # ì´ˆê¸°í™” í›„ íŒŒì¼ì— ì €ì¥
            self._save_disk_states()
            return True
        except Exception as e:
            print(f"  âŒ ëª¨ë“  ë””ìŠ¤í¬ ìƒíƒœ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
            return False
    
    def _save_disk_states(self):
        """ë””ìŠ¤í¬ ì¶©ì „ ìƒíƒœë¥¼ íŒŒì¼ì— ì €ì¥"""
        try:
            config = {
                'disk_0_loaded': self.disk_states[0].loaded_count,
                'disk_1_loaded': self.disk_states[1].loaded_count,
                'disk_2_loaded': self.disk_states[2].loaded_count,
                'saved_at': time.time()
            }
            
            with open(self.disk_states_file, 'w') as f:
                json.dump(config, f)
            
            print(f"  ğŸ’¾ ë””ìŠ¤í¬ ì¶©ì „ ìƒíƒœ ì €ì¥ë¨: {self.disk_states[0].loaded_count}, {self.disk_states[1].loaded_count}, {self.disk_states[2].loaded_count}")
            
        except Exception as e:
            print(f"  âŒ ë””ìŠ¤í¬ ì¶©ì „ ìƒíƒœ ì €ì¥ ì‹¤íŒ¨: {e}")
    
    def _load_disk_states(self):
        """ì €ì¥ëœ ë””ìŠ¤í¬ ì¶©ì „ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸°"""
        try:
            with open(self.disk_states_file, 'r') as f:
                config = json.load(f)
            
            # ë¶ˆëŸ¬ì˜¨ ìƒíƒœë¡œ ë””ìŠ¤í¬ ìƒì„±
            for i in range(3):
                self.disk_states[i] = DiskState(i + 1)
                loaded_count = config.get(f'disk_{i}_loaded', 0)
                self.disk_states[i].loaded_count = loaded_count
            
            print(f"  ğŸ“‚ ë””ìŠ¤í¬ ì¶©ì „ ìƒíƒœ ë¶ˆëŸ¬ì˜´: {self.disk_states[0].loaded_count}, {self.disk_states[1].loaded_count}, {self.disk_states[2].loaded_count}")
            
        except Exception as e:
            print(f"  âš ï¸ ì €ì¥ëœ ë””ìŠ¤í¬ ì¶©ì „ ìƒíƒœ ì—†ìŒ: {e}")

ì´ê±´ ë¬¸ì œê°€ ì—†ë˜ ë²„ì „ì˜ ì½”ë“œì•¼

---

## ğŸ”Š I2S ì´ˆê¸°í™” ë©”ëª¨ë¦¬ ìµœì í™” ë°©ì•ˆ

### **í˜„ì¬ ìƒí™© ë¶„ì„**

#### **I2S ì´ˆê¸°í™” ì„±ê³µ ë° WAV ìŒì„± ì¶œë ¥ ì„±ê³µ ë‹¬ì„±**
- âœ… I2S í•˜ë“œì›¨ì–´ ì§€ì—° ì´ˆê¸°í™” ì™„ë£Œ
- âœ… WAV íŒŒì¼ ì¬ìƒ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ
- âœ… ë‹¨ê³„ë³„ I2S ì„¤ì • ì‹œë„ë¡œ ë©”ëª¨ë¦¬ ë¶€ì¡± ìƒí™© ê·¹ë³µ

#### **í˜„ì¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¶„ì„**
```python
# í˜„ì¬ I2S ì„¤ì •ë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
configs = [
    {"rate": 2000, "bits": 16, "ibuf": 8},      # ìµœì†Œ ë©”ëª¨ë¦¬
    {"rate": 4000, "bits": 16, "ibuf": 8},      # ìµœì†Œ ë©”ëª¨ë¦¬  
    {"rate": 4000, "bits": 16, "ibuf": 16},     # ì•½ê°„ ì¦ê°€
    {"rate": 8000, "bits": 16, "ibuf": 16},     # ì¤‘ê°„ ì„¤ì •
    {"rate": 8000, "bits": 16, "ibuf": 32},     # ê¸°ë³¸ ì„¤ì •
    {"rate": 16000, "bits": 16, "ibuf": 64}     # ê³ í’ˆì§ˆ
]
```

### **ë©”ëª¨ë¦¬ ì—¬ìœ  í™•ë³´ ë°©ì•ˆ**

#### **1. I2S ë²„í¼ í¬ê¸° ìµœì í™”**

**í˜„ì¬ êµ¬í˜„:**
```python
def _try_i2s_initialization(self, Pin, I2S):
    # ì‹œë„í•  ì„¤ì •ë“¤ (ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìˆœ)
    configs = [
        {"rate": 2000, "bits": 16, "ibuf": 8},      # 16 bytes
        {"rate": 4000, "bits": 16, "ibuf": 8},      # 16 bytes
        {"rate": 4000, "bits": 16, "ibuf": 16},     # 32 bytes
        {"rate": 8000, "bits": 16, "ibuf": 16},     # 32 bytes
        {"rate": 8000, "bits": 16, "ibuf": 32},     # 64 bytes
        {"rate": 16000, "bits": 16, "ibuf": 64}     # 128 bytes
    ]
```

**ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê³„ì‚°:**
- **ibuf í¬ê¸° Ã— bits Ã· 8 = ì‹¤ì œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**
- ibuf=8: 8 Ã— 16 Ã· 8 = 16 bytes
- ibuf=16: 16 Ã— 16 Ã· 8 = 32 bytes  
- ibuf=32: 32 Ã— 16 Ã· 8 = 64 bytes
- ibuf=64: 64 Ã— 16 Ã· 8 = 128 bytes

#### **2. ë™ì  ë©”ëª¨ë¦¬ ê´€ë¦¬ ê°œì„ **

**í˜„ì¬ êµ¬í˜„:**
```python
def _ensure_i2s_initialized(self):
    # 1. ëª¨ë“  ìºì‹œ ì •ë¦¬
    self._clear_all_caches()
    
    # 2. ê°•í™”ëœ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ (10íšŒ)
    for i in range(10):
        gc.collect()
        time.sleep_ms(50)
    
    # 3. ë©”ëª¨ë¦¬ ìƒíƒœ í™•ì¸
    free_mem = self._check_memory_status()
    
    # 4. ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ë¹„ìƒ ì •ë¦¬
    if free_mem < 20000:  # 20KB ë¯¸ë§Œ
        self._emergency_memory_cleanup()
```

**ê°œì„  ë°©ì•ˆ:**
```python
def _ensure_i2s_initialized_optimized(self):
    # 1. ì§€ëŠ¥í˜• ë©”ëª¨ë¦¬ ì •ë¦¬
    self._intelligent_memory_cleanup()
    
    # 2. ë‹¨ê³„ë³„ ë©”ëª¨ë¦¬ í™•ë³´
    free_mem = self._check_memory_status()
    if free_mem < 30000:  # 30KB ë¯¸ë§Œ ì‹œ ì •ë¦¬
        self._aggressive_memory_cleanup()
    
    # 3. I2S ì´ˆê¸°í™” ì „ ìµœì¢… ì •ë¦¬
    self._final_pre_i2s_cleanup()
```

#### **3. ìºì‹œ ì‹œìŠ¤í…œ ìµœì í™”**

**í˜„ì¬ êµ¬í˜„:**
```python
def _clear_all_caches(self):
    # ëª¨ë“ˆ ìºì‹œ ì •ë¦¬
    self._machine_modules.clear()
    # íŒŒì¼ ìºì‹œ ì •ë¦¬  
    self._file_cache.clear()
    self._last_file_check.clear()
    # ì˜¤ë””ì˜¤ íŒŒì¼ ì •ë³´ ìºì‹œ ì •ë¦¬
    self.audio_files_info = None
```

**ê°œì„  ë°©ì•ˆ:**
```python
def _intelligent_cache_cleanup(self):
    # 1. ìš°ì„ ìˆœìœ„ë³„ ìºì‹œ ì •ë¦¬
    if len(self._file_cache) > 50:  # íŒŒì¼ ìºì‹œê°€ ë§ìœ¼ë©´
        self._file_cache.clear()
    
    # 2. ì‹œê°„ ê¸°ë°˜ ìºì‹œ ì •ë¦¬
    current_time = time.ticks_ms()
    old_entries = []
    for key, value in self._last_file_check.items():
        if time.ticks_diff(current_time, value["timestamp"]) > 10000:  # 10ì´ˆ ì´ìƒ
            old_entries.append(key)
    
    for key in old_entries:
        del self._last_file_check[key]
```

#### **4. ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§ ê°•í™”**

**í˜„ì¬ êµ¬í˜„:**
```python
def _check_memory_status(self):
    free_mem = gc.mem_free()
    alloc_mem = gc.mem_alloc()
    total_mem = free_mem + alloc_mem
    
    print(f"[MEMORY] ì‚¬ìš© ê°€ëŠ¥: {free_mem} bytes")
    print(f"[MEMORY] ì‚¬ìš© ì¤‘: {alloc_mem} bytes")
    print(f"[MEMORY] ì´ ë©”ëª¨ë¦¬: {total_mem} bytes")
    print(f"[MEMORY] ì‚¬ìš©ë¥ : {(alloc_mem/total_mem)*100:.1f}%")
    
    return free_mem
```

**ê°œì„  ë°©ì•ˆ:**
```python
def _detailed_memory_analysis(self):
    free_mem = gc.mem_free()
    alloc_mem = gc.mem_alloc()
    total_mem = free_mem + alloc_mem
    
    # ë©”ëª¨ë¦¬ ë‹¨í¸í™” ë¶„ì„
    max_free_block = gc.mem_free()  # ìµœëŒ€ ì—°ì† ë¸”ë¡
    fragmentation = (total_mem - max_free_block) / total_mem * 100
    
    print(f"[MEMORY] ìƒì„¸ ë¶„ì„:")
    print(f"  - ì‚¬ìš© ê°€ëŠ¥: {free_mem:,} bytes")
    print(f"  - ì‚¬ìš© ì¤‘: {alloc_mem:,} bytes") 
    print(f"  - ìµœëŒ€ ì—°ì† ë¸”ë¡: {max_free_block:,} bytes")
    print(f"  - ë‹¨í¸í™”ìœ¨: {fragmentation:.1f}%")
    
    return {
        'free': free_mem,
        'allocated': alloc_mem,
        'max_free_block': max_free_block,
        'fragmentation': fragmentation
    }
```

#### **5. I2S ì´ˆê¸°í™” ì „ëµ ê°œì„ **

**í˜„ì¬ êµ¬í˜„:**
```python
# ê° ì„¤ì • ì‹œë„ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬
for i, config in enumerate(configs):
    import gc
    gc.collect()
    time.sleep_ms(200)
    
    i2s = I2S(0, sck=Pin(6), ws=Pin(7), sd=Pin(5),
              mode=I2S.TX, bits=config['bits'],
              format=I2S.MONO, rate=config['rate'],
              ibuf=config['ibuf'])
```

**ê°œì„  ë°©ì•ˆ:**
```python
def _smart_i2s_initialization(self, Pin, I2S):
    # 1. ë©”ëª¨ë¦¬ ìƒíƒœì— ë”°ë¥¸ ë™ì  ì„¤ì • ì„ íƒ
    memory_info = self._detailed_memory_analysis()
    
    if memory_info['max_free_block'] > 20000:  # 20KB ì´ìƒ
        # ê³ í’ˆì§ˆ ì„¤ì • ì‹œë„
        configs = [
            {"rate": 16000, "bits": 16, "ibuf": 64},
            {"rate": 8000, "bits": 16, "ibuf": 32}
        ]
    elif memory_info['max_free_block'] > 10000:  # 10KB ì´ìƒ
        # ì¤‘ê°„ í’ˆì§ˆ ì„¤ì • ì‹œë„
        configs = [
            {"rate": 8000, "bits": 16, "ibuf": 16},
            {"rate": 4000, "bits": 16, "ibuf": 16}
        ]
    else:
        # ìµœì†Œ ë©”ëª¨ë¦¬ ì„¤ì • ì‹œë„
        configs = [
            {"rate": 4000, "bits": 16, "ibuf": 8},
            {"rate": 2000, "bits": 16, "ibuf": 8}
        ]
    
    # 2. ì„¤ì •ë³„ ìµœì í™”ëœ ì´ˆê¸°í™” ì‹œë„
    for config in configs:
        if self._try_i2s_config(Pin, I2S, config):
            return True
    
    return False
```

### **ì¶”ê°€ ë©”ëª¨ë¦¬ ì ˆì•½ ë°©ì•ˆ**

#### **6. ì˜¤ë””ì˜¤ íŒŒì¼ ê´€ë¦¬ ìµœì í™”**

**í˜„ì¬ êµ¬í˜„:**
```python
def _get_audio_files_info(self):
    if self.audio_files_info is None:
        from audio_files_info import get_audio_files_info
        self.audio_files_info = get_audio_files_info()
    return self.audio_files_info
```

**ê°œì„  ë°©ì•ˆ:**
```python
def _get_audio_files_info_lazy(self, audio_file=None):
    # íŠ¹ì • íŒŒì¼ ì •ë³´ë§Œ í•„ìš”í•  ë•Œ í•´ë‹¹ íŒŒì¼ë§Œ ë¡œë“œ
    if audio_file:
        return self._load_single_audio_info(audio_file)
    
    # ì „ì²´ ì •ë³´ê°€ í•„ìš”í•  ë•Œë§Œ ë¡œë“œ
    if self.audio_files_info is None:
        from audio_files_info import get_audio_files_info
        self.audio_files_info = get_audio_files_info()
    return self.audio_files_info
```

#### **7. ëª¨ë“ˆ ì§€ì—° ë¡œë”© ê°•í™”**

**í˜„ì¬ êµ¬í˜„:**
```python
def _get_machine_module(self, module_name):
    if module_name not in self._machine_modules:
        if module_name == "Pin":
            from machine import Pin
            self._machine_modules[module_name] = Pin
        # ...
```

**ê°œì„  ë°©ì•ˆ:**
```python
def _get_machine_module_optimized(self, module_name):
    # ëª¨ë“ˆ ì‚¬ìš© í›„ ì¦‰ì‹œ ì •ë¦¬
    if module_name not in self._machine_modules:
        if module_name == "Pin":
            from machine import Pin
            self._machine_modules[module_name] = Pin
        # ...
    
    # ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ë©´ ëª¨ë“ˆ ìºì‹œ ì •ë¦¬
    if gc.mem_free() < 15000:
        self._machine_modules.clear()
        # ë‹¤ì‹œ ë¡œë“œ
        if module_name == "Pin":
            from machine import Pin
            self._machine_modules[module_name] = Pin
    
    return self._machine_modules[module_name]
```

### **ë©”ëª¨ë¦¬ ìµœì í™” íš¨ê³¼ ì˜ˆìƒ**

#### **ì˜ˆìƒ ë©”ëª¨ë¦¬ ì ˆì•½ëŸ‰:**
- **I2S ë²„í¼ ìµœì í™”**: 32-112 bytes ì ˆì•½ (ibuf 16â†’8 ë˜ëŠ” 64â†’16)
- **ìºì‹œ ì‹œìŠ¤í…œ ìµœì í™”**: 1-5KB ì ˆì•½
- **ì§€ëŠ¥í˜• ë©”ëª¨ë¦¬ ê´€ë¦¬**: 5-15KB ì ˆì•½
- **ëª¨ë“ˆ ì§€ì—° ë¡œë”© ê°•í™”**: 2-8KB ì ˆì•½

**ì´ ì˜ˆìƒ ì ˆì•½ëŸ‰: 8-28KB**

#### **ì„±ëŠ¥ ì˜í–¥:**
- **ìŒì§ˆ**: ibuf í¬ê¸° ê°ì†Œë¡œ ì•½ê°„ì˜ ì§€ì—° ê°€ëŠ¥ (ë¬´ì‹œí•  ìˆ˜ì¤€)
- **ì•ˆì •ì„±**: ë©”ëª¨ë¦¬ ì—¬ìœ  í™•ë³´ë¡œ ì‹œìŠ¤í…œ ì•ˆì •ì„± í–¥ìƒ
- **ì‘ë‹µì„±**: ë¶ˆí•„ìš”í•œ ë©”ëª¨ë¦¬ ì •ë¦¬ ê°ì†Œë¡œ ì‘ë‹µì„± í–¥ìƒ

### **êµ¬í˜„ ìš°ì„ ìˆœìœ„**

1. **1ë‹¨ê³„**: I2S ë²„í¼ í¬ê¸° ë™ì  ì¡°ì • (ì¦‰ì‹œ íš¨ê³¼)
2. **2ë‹¨ê³„**: ì§€ëŠ¥í˜• ìºì‹œ ì •ë¦¬ ì‹œìŠ¤í…œ (ì•ˆì •ì„± í–¥ìƒ)  
3. **3ë‹¨ê³„**: ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§ ê°•í™” (ë””ë²„ê¹… í–¥ìƒ)
4. **4ë‹¨ê³„**: ëª¨ë“ˆ ì§€ì—° ë¡œë”© ê°•í™” (ì¥ê¸°ì  íš¨ê³¼)

ì´ëŸ¬í•œ ìµœì í™”ë¥¼ í†µí•´ I2S ì´ˆê¸°í™” ì‹œ ë©”ëª¨ë¦¬ ì—¬ìœ ë¥¼ í™•ë³´í•˜ê³ , ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ê³¼ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“Š ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìƒì„¸ ë¶„ì„

### **í˜„ì¬ ë©”ëª¨ë¦¬ ìƒí™©**

#### **ESP32-C6 ë©”ëª¨ë¦¬ ì‚¬ì–‘**
```python
# ESP32-C6 ë©”ëª¨ë¦¬ êµ¬ì„±
ì´ ë©”ëª¨ë¦¬: 255,808 bytes (ì•½ 250KB)
ìŠ¤íƒ í¬ê¸°: 15,360 bytes (15KB)
ì‚¬ìš© ê°€ëŠ¥ ë©”ëª¨ë¦¬: ì•½ 97,216 bytes (97KB)
ìµœëŒ€ ë¸”ë¡ í¬ê¸°: 641 bytes
ìµœëŒ€ ììœ  ë¸”ë¡ í¬ê¸°: 256-487 bytes
```

#### **í˜„ì¬ ë©”ëª¨ë¦¬ ì‚¬ìš© íŒ¨í„´**
```
stack: 2020 out of 15360
GC: total: 255808, used: 158592, free: 97216, max new split: 24064
No. of 1-blocks: 1653, 2-blocks: 342, max blk sz: 641, max free sz: 256
```

#### **ë©”ëª¨ë¦¬ ìƒíƒœ ì„ê³„ê°’**
```python
# ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„° ì„ê³„ê°’
critical_threshold = 20000   # 20KB ì´í•˜ ì‹œ ìœ„í—˜
warning_threshold = 30000    # 30KB ì´í•˜ ì‹œ ê²½ê³ 
normal_threshold = 50000     # 50KB ì´ìƒ ì‹œ ì •ìƒ
```

### **I2S ì´ˆê¸°í™” ë©”ëª¨ë¦¬ ìš”êµ¬ì‚¬í•­**

#### **I2S ë²„í¼ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**
```python
# I2S ë‚´ë¶€ ë²„í¼ ë©”ëª¨ë¦¬ ê³„ì‚°
def calculate_i2s_memory_usage(bits, ibuf):
    """I2S ë²„í¼ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê³„ì‚°"""
    # ibuf í¬ê¸° Ã— bits Ã· 8 = ì‹¤ì œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
    buffer_memory = ibuf * bits // 8
    
    # ì¶”ê°€ ì˜¤ë²„í—¤ë“œ (I2S ë“œë¼ì´ë²„ êµ¬ì¡°ì²´ ë“±)
    overhead = 512  # ì•½ 512 bytes ì˜¤ë²„í—¤ë“œ
    
    total_memory = buffer_memory + overhead
    return total_memory, buffer_memory, overhead

# ê° ì„¤ì •ë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
configs_memory = [
    {"rate": 2000, "bits": 16, "ibuf": 8, "memory": 528},     # 16 + 512 bytes
    {"rate": 4000, "bits": 16, "ibuf": 8, "memory": 528},     # 16 + 512 bytes
    {"rate": 4000, "bits": 16, "ibuf": 16, "memory": 544},    # 32 + 512 bytes
    {"rate": 8000, "bits": 16, "ibuf": 16, "memory": 544},    # 32 + 512 bytes
    {"rate": 8000, "bits": 16, "ibuf": 32, "memory": 576},    # 64 + 512 bytes
    {"rate": 16000, "bits": 16, "ibuf": 64, "memory": 640}    # 128 + 512 bytes
]
```

#### **I2S ì´ˆê¸°í™” ì „ í•„ìš” ë©”ëª¨ë¦¬**
```python
def calculate_required_memory_for_i2s():
    """I2S ì´ˆê¸°í™”ì— í•„ìš”í•œ ìµœì†Œ ë©”ëª¨ë¦¬ ê³„ì‚°"""
    
    # 1. I2S ë²„í¼ ë©”ëª¨ë¦¬ (ìµœëŒ€ ì„¤ì • ê¸°ì¤€)
    max_i2s_buffer = 640  # 128 + 512 bytes
    
    # 2. I2S ì´ˆê¸°í™” ê³¼ì • ì¤‘ ì„ì‹œ ë©”ëª¨ë¦¬
    initialization_overhead = 2048  # 2KB ì´ˆê¸°í™” ì˜¤ë²„í—¤ë“œ
    
    # 3. ì•ˆì „ ë§ˆì§„ (ë©”ëª¨ë¦¬ ë‹¨í¸í™” ê³ ë ¤)
    safety_margin = 1024  # 1KB ì•ˆì „ ë§ˆì§„
    
    total_required = max_i2s_buffer + initialization_overhead + safety_margin
    
    return {
        'i2s_buffer': max_i2s_buffer,
        'initialization_overhead': initialization_overhead,
        'safety_margin': safety_margin,
        'total_required': total_required  # 3.7KB
    }
```

### **WAV ì¬ìƒ ë©”ëª¨ë¦¬ ìš”êµ¬ì‚¬í•­**

#### **WAV íŒŒì¼ ì¬ìƒ ë²„í¼ ë©”ëª¨ë¦¬**
```python
def calculate_wav_playback_memory():
    """WAV ì¬ìƒì— í•„ìš”í•œ ë©”ëª¨ë¦¬ ê³„ì‚°"""
    
    # í˜„ì¬ êµ¬í˜„ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë²„í¼ í¬ê¸°
    current_buffer_size = 4096  # 4KB (test_wav_player_mono.py ê¸°ì¤€)
    
    # í”„ë ˆì„ í¬ê¸° (ëª¨ë…¸ 16bit)
    frame_size = 2  # 2 bytes per frame
    
    # ìƒ˜í”Œ ë°°ì—´ ë©”ëª¨ë¦¬
    wav_samples_memory = current_buffer_size  # 4KB
    
    # 8ë¹„íŠ¸ë¥¼ 16ë¹„íŠ¸ë¡œ ë³€í™˜ ì‹œ ì¶”ê°€ ë©”ëª¨ë¦¬
    conversion_buffer = current_buffer_size * 2  # 8KB
    
    # íŒŒì¼ ì½ê¸° ë²„í¼
    file_read_buffer = 512  # 512 bytes
    
    total_wav_memory = wav_samples_memory + conversion_buffer + file_read_buffer
    
    return {
        'wav_samples_buffer': wav_samples_memory,
        'conversion_buffer': conversion_buffer,
        'file_read_buffer': file_read_buffer,
        'total_wav_memory': total_wav_memory  # 12.5KB
    }
```

#### **ìµœì í™”ëœ WAV ì¬ìƒ ë©”ëª¨ë¦¬**
```python
def calculate_optimized_wav_memory():
    """ìµœì í™”ëœ WAV ì¬ìƒ ë©”ëª¨ë¦¬ ê³„ì‚°"""
    
    # ìµœì†Œ ë²„í¼ í¬ê¸° (í’ˆì§ˆ ìœ ì§€í•˜ë©´ì„œ ë©”ëª¨ë¦¬ ì ˆì•½)
    optimized_buffer_size = 1024  # 1KB (4096 â†’ 1024)
    
    # í”„ë ˆì„ í¬ê¸° (ëª¨ë…¸ 16bit)
    frame_size = 2  # 2 bytes per frame
    
    # ìƒ˜í”Œ ë°°ì—´ ë©”ëª¨ë¦¬
    wav_samples_memory = optimized_buffer_size  # 1KB
    
    # 8ë¹„íŠ¸ë¥¼ 16ë¹„íŠ¸ë¡œ ë³€í™˜ ì‹œ ì¶”ê°€ ë©”ëª¨ë¦¬
    conversion_buffer = optimized_buffer_size * 2  # 2KB
    
    # íŒŒì¼ ì½ê¸° ë²„í¼ (ë” ì‘ê²Œ)
    file_read_buffer = 256  # 256 bytes
    
    total_optimized_memory = wav_samples_memory + conversion_buffer + file_read_buffer
    
    return {
        'wav_samples_buffer': wav_samples_memory,
        'conversion_buffer': conversion_buffer,
        'file_read_buffer': file_read_buffer,
        'total_optimized_memory': total_optimized_memory,  # 3.25KB
        'memory_saved': 12544 - total_optimized_memory  # 9.25KB ì ˆì•½
    }
```

### **ì „ì²´ ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ ìš”êµ¬ì‚¬í•­**

#### **í˜„ì¬ êµ¬í˜„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**
```python
def calculate_total_audio_memory_current():
    """í˜„ì¬ êµ¬í˜„ì˜ ì „ì²´ ì˜¤ë””ì˜¤ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰"""
    
    # I2S ì´ˆê¸°í™” ë©”ëª¨ë¦¬ (ìµœëŒ€ ì„¤ì •)
    i2s_memory = 640  # bytes
    
    # WAV ì¬ìƒ ë©”ëª¨ë¦¬
    wav_memory = 12800  # 12.5KB
    
    # ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ í´ë˜ìŠ¤ ë©”ëª¨ë¦¬
    audio_system_memory = 2048  # 2KB
    
    # ìºì‹œ ë©”ëª¨ë¦¬
    cache_memory = 1024  # 1KB
    
    total_current_memory = i2s_memory + wav_memory + audio_system_memory + cache_memory
    
    return {
        'i2s_memory': i2s_memory,
        'wav_memory': wav_memory,
        'audio_system_memory': audio_system_memory,
        'cache_memory': cache_memory,
        'total_current_memory': total_current_memory,  # 16.5KB
        'total_current_memory_kb': total_current_memory / 1024
    }
```

#### **ìµœì í™”ëœ êµ¬í˜„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**
```python
def calculate_total_audio_memory_optimized():
    """ìµœì í™”ëœ êµ¬í˜„ì˜ ì „ì²´ ì˜¤ë””ì˜¤ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰"""
    
    # I2S ì´ˆê¸°í™” ë©”ëª¨ë¦¬ (ìµœì†Œ ì„¤ì •)
    i2s_memory_optimized = 528  # bytes (ibuf=8)
    
    # WAV ì¬ìƒ ë©”ëª¨ë¦¬ (ìµœì í™”)
    wav_memory_optimized = 3328  # 3.25KB
    
    # ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ í´ë˜ìŠ¤ ë©”ëª¨ë¦¬ (ì§€ì—° ë¡œë”©)
    audio_system_memory_optimized = 1024  # 1KB
    
    # ìºì‹œ ë©”ëª¨ë¦¬ (ì§€ëŠ¥í˜• ì •ë¦¬)
    cache_memory_optimized = 512  # 512 bytes
    
    total_optimized_memory = (i2s_memory_optimized + wav_memory_optimized + 
                            audio_system_memory_optimized + cache_memory_optimized)
    
    return {
        'i2s_memory': i2s_memory_optimized,
        'wav_memory': wav_memory_optimized,
        'audio_system_memory': audio_system_memory_optimized,
        'cache_memory': cache_memory_optimized,
        'total_optimized_memory': total_optimized_memory,  # 5.4KB
        'total_optimized_memory_kb': total_optimized_memory / 1024
    }
```

### **ë©”ëª¨ë¦¬ ì—¬ìœ  í™•ë³´ íš¨ê³¼**

#### **ë©”ëª¨ë¦¬ ì ˆì•½ëŸ‰ ë¹„êµ**
```python
# í˜„ì¬ vs ìµœì í™” ë¹„êµ
current_memory = 16912  # 16.5KB
optimized_memory = 5392  # 5.4KB
memory_saved = current_memory - optimized_memory  # 11.1KB ì ˆì•½

# ì ˆì•½ ë¹„ìœ¨
saving_percentage = (memory_saved / current_memory) * 100  # 65.6% ì ˆì•½

print(f"ë©”ëª¨ë¦¬ ì ˆì•½ëŸ‰: {memory_saved:,} bytes ({memory_saved/1024:.1f}KB)")
print(f"ì ˆì•½ ë¹„ìœ¨: {saving_percentage:.1f}%")
```

#### **ë©”ëª¨ë¦¬ ì—¬ìœ  í™•ë³´ í›„ ìƒí™©**
```python
def calculate_memory_after_optimization():
    """ìµœì í™” í›„ ë©”ëª¨ë¦¬ ìƒí™© ê³„ì‚°"""
    
    # í˜„ì¬ ì—¬ìœ  ë©”ëª¨ë¦¬
    current_free_memory = 97216  # 97KB
    
    # ìµœì í™”ë¡œ ì ˆì•½ëœ ë©”ëª¨ë¦¬
    saved_memory = 11360  # 11.1KB
    
    # ìµœì í™” í›„ ì—¬ìœ  ë©”ëª¨ë¦¬
    optimized_free_memory = current_free_memory + saved_memory
    
    return {
        'current_free_memory': current_free_memory,
        'saved_memory': saved_memory,
        'optimized_free_memory': optimized_free_memory,  # 108KB
        'improvement_percentage': (saved_memory / current_free_memory) * 100  # 11.7% ê°œì„ 
    }
```

### **ë©”ëª¨ë¦¬ ì•ˆì „ì„± ë¶„ì„**

#### **ì•ˆì „í•œ I2S ì´ˆê¸°í™”ë¥¼ ìœ„í•œ ë©”ëª¨ë¦¬ ìš”êµ¬ì‚¬í•­**
```python
def calculate_safe_i2s_initialization_memory():
    """ì•ˆì „í•œ I2S ì´ˆê¸°í™”ë¥¼ ìœ„í•œ ë©”ëª¨ë¦¬ ê³„ì‚°"""
    
    # I2S ë²„í¼ ë©”ëª¨ë¦¬ (ìµœëŒ€ ì„¤ì •)
    i2s_buffer_memory = 640  # bytes
    
    # ì´ˆê¸°í™” ê³¼ì • ì˜¤ë²„í—¤ë“œ
    init_overhead = 2048  # 2KB
    
    # ì•ˆì „ ë§ˆì§„ (ë©”ëª¨ë¦¬ ë‹¨í¸í™” ê³ ë ¤)
    safety_margin = 4096  # 4KB
    
    # ì´ í•„ìš” ë©”ëª¨ë¦¬
    total_required = i2s_buffer_memory + init_overhead + safety_margin
    
    return {
        'i2s_buffer': i2s_buffer_memory,
        'initialization_overhead': init_overhead,
        'safety_margin': safety_margin,
        'total_required': total_required,  # 6.7KB
        'recommended_free_memory': total_required * 2  # 13.4KB ê¶Œì¥
    }
```

#### **ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ëŒ€ì‘ ë°©ì•ˆ**
```python
def get_memory_shortage_response():
    """ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ëŒ€ì‘ ë°©ì•ˆ"""
    
    return {
        'critical_threshold': 5000,   # 5KB ì´í•˜ ì‹œ ìœ„í—˜
        'warning_threshold': 10000,   # 10KB ì´í•˜ ì‹œ ê²½ê³ 
        'normal_threshold': 15000,    # 15KB ì´ìƒ ì‹œ ì •ìƒ
        
        'response_strategies': {
            'critical': [
                'ë¹„ìƒ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹¤í–‰',
                'ëª¨ë“  ìºì‹œ ê°•ì œ ì •ë¦¬',
                'I2S ìµœì†Œ ì„¤ì • ì‹œë„',
                'WAV ì¬ìƒ ì¤‘ë‹¨'
            ],
            'warning': [
                'ì§€ëŠ¥í˜• ìºì‹œ ì •ë¦¬',
                'I2S ì¤‘ê°„ ì„¤ì • ì‹œë„',
                'WAV ë²„í¼ í¬ê¸° ê°ì†Œ'
            ],
            'normal': [
                'ì •ìƒ I2S ì„¤ì • ì‹œë„',
                'í‘œì¤€ WAV ì¬ìƒ'
            ]
        }
    }
```

### **ì‹¤ì‹œê°„ ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§**

#### **ë©”ëª¨ë¦¬ ìƒíƒœ ëª¨ë‹ˆí„°ë§ ì½”ë“œ**
```python
def monitor_memory_for_audio():
    """ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œìš© ë©”ëª¨ë¦¬ ëª¨ë‹ˆí„°ë§"""
    
    import gc
    
    # í˜„ì¬ ë©”ëª¨ë¦¬ ìƒíƒœ
    free_memory = gc.mem_free()
    allocated_memory = gc.mem_alloc()
    total_memory = free_memory + allocated_memory
    
    # ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ 
    usage_percentage = (allocated_memory / total_memory) * 100
    
    # ìƒíƒœ íŒì •
    if free_memory < 5000:
        status = "ğŸ”´ CRITICAL"
        action = "ë¹„ìƒ ë©”ëª¨ë¦¬ ì •ë¦¬ í•„ìš”"
    elif free_memory < 10000:
        status = "ğŸŸ¡ WARNING"
        action = "ë©”ëª¨ë¦¬ ì •ë¦¬ ê¶Œì¥"
    else:
        status = "ğŸŸ¢ OK"
        action = "ì •ìƒ ìƒíƒœ"
    
    return {
        'free_memory': free_memory,
        'allocated_memory': allocated_memory,
        'total_memory': total_memory,
        'usage_percentage': usage_percentage,
        'status': status,
        'recommended_action': action
    }
```

ì´ëŸ¬í•œ ìƒì„¸í•œ ë©”ëª¨ë¦¬ ë¶„ì„ì„ í†µí•´ I2S ì´ˆê¸°í™”ì™€ WAV ì¬ìƒì— í•„ìš”í•œ ë©”ëª¨ë¦¬ë¥¼ ì •í™•íˆ íŒŒì•…í•˜ê³ , ìµœì í™”ë¥¼ í†µí•´ ìƒë‹¹í•œ ë©”ëª¨ë¦¬ ì—¬ìœ ë¥¼ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ”´ ì‹¤ì œ ë©”ëª¨ë¦¬ ë¶€ì¡± í˜„í™© ë¶„ì„ (2025-10-19)

### **ì‹¤ì œ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½**

ì‹¤ì œ ESP32-C6ì—ì„œ í…ŒìŠ¤íŠ¸í•œ ê²°ê³¼, **ì‹¬ê°í•œ ë©”ëª¨ë¦¬ ë¶€ì¡± ìƒí™©**ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤:

#### **ë©”ëª¨ë¦¬ ìƒíƒœ ë³€í™”**
```
ì´ˆê¸° ìƒíƒœ: ğŸŸ¢ OK (77,840 bytes ì—¬ìœ )
â†“
ì•Œì•½ ì¶©ì „ í›„: ğŸŸ¢ OK (64,320 bytes ì—¬ìœ ) 
â†“
ë©”ì¸ í™”ë©´ ë¡œë“œ í›„: ğŸŸ¢ OK (64,320 bytes ì—¬ìœ )
â†“
ìˆ˜ë™ ë°°ì¶œ ì‹¤í–‰ ì‹œ: ğŸ”´ CRITICAL (13,588 bytes ì—¬ìœ )
```

#### **I2S ì´ˆê¸°í™” ì‹¤íŒ¨ ìƒì„¸**

**ì‹¤íŒ¨í•œ I2S ì„¤ì •ë“¤:**
1. `rate=2000, bits=16, ibuf=8` â†’ ì‹¤íŒ¨ (ENOMEM)
2. `rate=4000, bits=16, ibuf=8` â†’ ì‹¤íŒ¨ (ENOMEM)  
3. `rate=4000, bits=16, ibuf=16` â†’ ì‹¤íŒ¨ (ENOMEM)
4. `rate=8000, bits=16, ibuf=16` â†’ ì‹¤íŒ¨ (ENOMEM)
5. `rate=8000, bits=16, ibuf=32` â†’ ì‹¤íŒ¨ (ENOMEM)
6. `rate=16000, bits=16, ibuf=64` â†’ ì‹¤íŒ¨ (ENOMEM)

**ëª¨ë“  I2S ì„¤ì •ì´ ì‹¤íŒ¨** â†’ ìŒì„± ì¶œë ¥ ë¶ˆê°€ëŠ¥

### **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¶„ì„**

#### **ì‹œìŠ¤í…œë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**
```
ì „ì²´ ì‹œìŠ¤í…œ: 299,364 bytes (100%)
â”œâ”€ ì‚¬ìš© ì¤‘: 285,776 bytes (95.5%)
â””â”€ ì—¬ìœ : 13,588 bytes (4.5%)
```

#### **ë©”ëª¨ë¦¬ ì‚¬ìš© íŒ¨í„´**
1. **ê¸°ë³¸ ì‹œìŠ¤í…œ**: ~201,000 bytes (67%)
2. **UI í™”ë©´ë“¤**: ~15,000 bytes (5%)
3. **ë°ì´í„° ê´€ë¦¬**: ~10,000 bytes (3%)
4. **ì•ŒëŒ ì‹œìŠ¤í…œ**: ~8,000 bytes (3%)
5. **ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ**: ~50,000+ bytes (17%)
6. **ê¸°íƒ€**: ~10,000 bytes (3%)

### **ë¬¸ì œì  ë¶„ì„**

#### **1. ë©”ëª¨ë¦¬ ëˆ„ì  í˜„ìƒ**
- ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œ: 77,840 bytes ì—¬ìœ 
- ë³µì¡í•œ UI ë¡œë“œ í›„: 64,320 bytes ì—¬ìœ   
- **13,520 bytes ì¶”ê°€ ì†Œëª¨** (17% ê°ì†Œ)

#### **2. ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ ë¶€ë‹´**
- I2S ì´ˆê¸°í™” ì‹œë„ ì‹œ: 13,588 bytes ì—¬ìœ 
- **ìµœì†Œ I2S ë²„í¼ í•„ìš”ëŸ‰**: ~8,000 bytes
- **ì—¬ìœ  ë©”ëª¨ë¦¬ ë¶€ì¡±**: 5,588 bytes

#### **3. ë©”ëª¨ë¦¬ ì •ë¦¬ íš¨ê³¼ ë¶€ì¡±**
```
ë¹„ìƒ ë©”ëª¨ë¦¬ ì •ë¦¬ ì „: 13,588 bytes ì—¬ìœ 
ë¹„ìƒ ë©”ëª¨ë¦¬ ì •ë¦¬ í›„: 13,604 bytes ì—¬ìœ 
ê°œì„  íš¨ê³¼: 16 bytes (0.1% ê°œì„ )
```

### **í•´ê²° ë°©ì•ˆ**

#### **1. ì¦‰ì‹œ ì ìš© ê°€ëŠ¥í•œ ìµœì í™”**

**A. ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì§€ì—° ì´ˆê¸°í™” ê°•í™”**
```python
# í˜„ì¬: í•„ìš” ì‹œ ì´ˆê¸°í™”
# ê°œì„ : ì ˆëŒ€ í•„ìš”í•˜ì§€ ì•Šìœ¼ë©´ ì´ˆê¸°í™” ì•ˆí•¨
def _ensure_i2s_initialized(self):
    if self.i2s_initialized:
        return True
    
    # ë©”ëª¨ë¦¬ ì²´í¬ ê°•í™”
    free_mem = gc.mem_free()
    if free_mem < 20000:  # 20KB ë¯¸ë§Œì´ë©´ ì´ˆê¸°í™” ê±°ë¶€
        print(f"[WARN] ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ I2S ì´ˆê¸°í™” ê±´ë„ˆëœ€: {free_mem} bytes")
        return False
```

**B. UI ì»´í¬ë„ŒíŠ¸ ìµœì í™”**
- ë¶ˆí•„ìš”í•œ UI ê°ì²´ ì¦‰ì‹œ ì‚­ì œ
- í°íŠ¸ ìºì‹œ í¬ê¸° ì¶•ì†Œ
- ì´ë¯¸ì§€ ë¦¬ì†ŒìŠ¤ ì••ì¶•

#### **2. ì¤‘ì¥ê¸° ìµœì í™”**

**A. ë©”ëª¨ë¦¬ ì•„í‚¤í…ì²˜ ì¬ì„¤ê³„**
- ìŠ¤íƒ ë©”ëª¨ë¦¬ ì‚¬ìš© ìµœì†Œí™”
- í™ ë©”ëª¨ë¦¬ í’€ ê´€ë¦¬ ë„ì…
- ë©”ëª¨ë¦¬ ì¡°ê°í™” ë°©ì§€

**B. ê¸°ëŠ¥ë³„ ë©”ëª¨ë¦¬ í• ë‹¹ëŸ‰ ì œí•œ**
```python
MEMORY_LIMITS = {
    'ui_screens': 15000,      # UI í™”ë©´ ìµœëŒ€ 15KB
    'audio_system': 30000,    # ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ìµœëŒ€ 30KB
    'data_manager': 10000,    # ë°ì´í„° ê´€ë¦¬ ìµœëŒ€ 10KB
    'alarm_system': 8000,     # ì•ŒëŒ ì‹œìŠ¤í…œ ìµœëŒ€ 8KB
}
```

### **ê¸´ê¸‰ ëŒ€ì‘ ë°©ì•ˆ**

#### **1. ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë¹„í™œì„±í™”**
```python
# ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì™„ì „ ë¹„í™œì„±í™”
AUDIO_DISABLED_THRESHOLD = 15000  # 15KB ë¯¸ë§Œ ì‹œ ì˜¤ë””ì˜¤ ë¹„í™œì„±í™”

def is_audio_available():
    return gc.mem_free() > AUDIO_DISABLED_THRESHOLD
```

#### **2. UI ê°„ì†Œí™”**
- ë³µì¡í•œ UI ìš”ì†Œ ì œê±°
- í…ìŠ¤íŠ¸ ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤ë¡œ ì „í™˜
- ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ ë¹„í™œì„±í™”

#### **3. ë°ì´í„° ê´€ë¦¬ ìµœì í™”**
- JSON íŒŒì¼ í¬ê¸° ì¶•ì†Œ
- ìºì‹œ ë©”ëª¨ë¦¬ ì‚¬ìš© ìµœì†Œí™”
- ë¶ˆí•„ìš”í•œ ë°ì´í„° ì¦‰ì‹œ ì‚­ì œ

### **ëª¨ë‹ˆí„°ë§ ê°œì„ **

#### **ì‹¤ì‹œê°„ ë©”ëª¨ë¦¬ ì•Œë¦¼ ì‹œìŠ¤í…œ**
```python
def check_memory_status():
    free_mem = gc.mem_free()
    
    if free_mem < 10000:
        print(f"ğŸš¨ CRITICAL: ë©”ëª¨ë¦¬ ë¶€ì¡± - {free_mem} bytes")
        # ë¹„ìƒ ì¡°ì¹˜ ì‹¤í–‰
        emergency_memory_cleanup()
    elif free_mem < 20000:
        print(f"âš ï¸ WARNING: ë©”ëª¨ë¦¬ ë¶€ì¡± ê²½ê³  - {free_mem} bytes")
        # ì˜ˆë°©ì  ì •ë¦¬ ì‹¤í–‰
        preventive_memory_cleanup()
```

### **ê²°ë¡ **

í˜„ì¬ ì‹œìŠ¤í…œì€ **ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì¸í•´ í•µì‹¬ ê¸°ëŠ¥(I2S ì˜¤ë””ì˜¤)ì´ ì‘ë™í•˜ì§€ ì•ŠëŠ” ì‹¬ê°í•œ ìƒíƒœ**ì…ë‹ˆë‹¤. 

**ìš°ì„ ìˆœìœ„:**
1. **ì¦‰ì‹œ**: ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë¹„í™œì„±í™”ë¡œ ì‹œìŠ¤í…œ ì•ˆì •ì„± í™•ë³´
2. **ë‹¨ê¸°**: UI ìµœì í™” ë° ë©”ëª¨ë¦¬ ì •ë¦¬ ê°•í™”  
3. **ì¤‘ê¸°**: ë©”ëª¨ë¦¬ ì•„í‚¤í…ì²˜ ì¬ì„¤ê³„
4. **ì¥ê¸°**: í•˜ë“œì›¨ì–´ ì—…ê·¸ë ˆì´ë“œ ê²€í†  (ë” í° ë©”ëª¨ë¦¬ ESP32 ëª¨ë¸)

**ëª©í‘œ**: ìµœì†Œ 30KB ì´ìƒì˜ ì—¬ìœ  ë©”ëª¨ë¦¬ í™•ë³´ë¡œ I2S ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™

---

## ğŸ”§ í™”ë©´ ëˆ„ì  ë¬¸ì œ í•´ê²° ë°©ì•ˆ

### **ë¬¸ì œ ì›ì¸ í™•ì¸**

ì‹¤ì œ í…ŒìŠ¤íŠ¸ì—ì„œ **í™”ë©´ ëˆ„ì ì´ ë©”ëª¨ë¦¬ ë¶€ì¡±ì˜ ì£¼ìš” ì›ì¸**ì„ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤:

#### **í™”ë©´ ì „í™˜ ì‹œ ë©”ëª¨ë¦¬ ëˆ„ì **
```
meal_time (ìƒì„±) â†’ dose_time (ìƒì„±) â†’ disk_selection (ìƒì„±) â†’ pill_loading (ìƒì„±) â†’ main (ìƒì„±)
```

**ê° í™”ë©´ì´ ìƒì„±ë˜ì§€ë§Œ ì´ì „ í™”ë©´ë“¤ì´ ë©”ëª¨ë¦¬ì— ê³„ì† ë‚¨ì•„ìˆìŒ**

#### **ë©”ëª¨ë¦¬ ì†Œëª¨ íŒ¨í„´**
```
ì´ˆê¸° ìƒíƒœ: 77,840 bytes ì—¬ìœ  (26%)
â†“ (í™”ë©´ ëˆ„ì )
ìµœì¢… ìƒíƒœ: 13,588 bytes ì—¬ìœ  (4.5%)
ì´ ì†Œëª¨: 64,252 bytes (21% ê°ì†Œ)
```

### **ì¦‰ì‹œ ì ìš© ê°€ëŠ¥í•œ í•´ê²°ì±…**

#### **1. í™”ë©´ ì „í™˜ ì‹œ ì´ì „ í™”ë©´ ì‚­ì œ**

**A. ScreenManager ìˆ˜ì •**
```python
def show_screen(self, screen_name, **kwargs):
    """í™”ë©´ ì „í™˜ - ì´ì „ í™”ë©´ ì‚­ì œ ë°©ì‹"""
    # í˜„ì¬ í™”ë©´ì´ ìˆìœ¼ë©´ ì™„ì „ ì‚­ì œ
    if self.current_screen and self.current_screen_name:
        print(f"[INFO] ì´ì „ í™”ë©´ ì‚­ì œ: {self.current_screen_name}")
        self.delete_screen(self.current_screen_name)
    
    # ìƒˆ í™”ë©´ ìƒì„±
    self._create_screen_directly(screen_name, **kwargs)
```

**B. í™”ë©´ë³„ cleanup() ë©”ì„œë“œ ê°•í™”**
```python
def cleanup(self):
    """í™”ë©´ ì™„ì „ ì •ë¦¬"""
    try:
        if self.screen:
            # LVGL ê°ì²´ ì™„ì „ ì‚­ì œ
            self.screen.delete()
            self.screen = None
        
        # ê´€ë ¨ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
        if hasattr(self, 'containers'):
            self.containers = None
        if hasattr(self, 'labels'):
            self.labels = None
            
        # ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ê°•ì œ ì‹¤í–‰
        import gc
        gc.collect()
        
        print(f"[OK] {self.screen_name} í™”ë©´ ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
    except Exception as e:
        print(f"[ERROR] í™”ë©´ ì •ë¦¬ ì‹¤íŒ¨: {e}")
```

#### **2. ë©”ëª¨ë¦¬ ì„ê³„ê°’ ê¸°ë°˜ í™”ë©´ ì •ë¦¬**

```python
def cleanup_screens_if_needed():
    """ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ í™”ë©´ ì •ë¦¬"""
    import gc
    free_mem = gc.mem_free()
    
    if free_mem < 20000:  # 20KB ë¯¸ë§Œ ì‹œ
        print(f"[WARN] ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ í™”ë©´ ì •ë¦¬ ì‹¤í–‰: {free_mem} bytes")
        
        # í˜„ì¬ í™”ë©´ ì œì™¸í•˜ê³  ëª¨ë“  í™”ë©´ ì‚­ì œ
        screen_manager.delete_all_screens_except([current_screen_name])
        
        # ê°•ì œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        gc.collect()
        gc.collect()
        
        print(f"[OK] í™”ë©´ ì •ë¦¬ ì™„ë£Œ: {gc.mem_free()} bytes ì—¬ìœ ")
```

#### **3. í™”ë©´ë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì œí•œ**

```python
# ê° í™”ë©´ë³„ ìµœëŒ€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì„¤ì •
SCREEN_MEMORY_LIMITS = {
    'meal_time': 8000,        # 8KB
    'dose_time': 10000,       # 10KB  
    'disk_selection': 8000,   # 8KB
    'pill_loading': 12000,    # 12KB
    'main': 15000,           # 15KB
}

def check_screen_memory_limit(screen_name):
    """í™”ë©´ë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì²´í¬"""
    import gc
    free_mem = gc.mem_free()
    limit = SCREEN_MEMORY_LIMITS.get(screen_name, 10000)
    
    if free_mem < limit:
        print(f"[WARN] {screen_name} í™”ë©´ ë©”ëª¨ë¦¬ ë¶€ì¡±: {free_mem} < {limit}")
        return False
    return True
```

### **ì˜ˆìƒ íš¨ê³¼**

#### **ë©”ëª¨ë¦¬ ì ˆì•½ëŸ‰**
- **í™”ë©´ë‹¹ í‰ê·  ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ~12KB
- **ëˆ„ì ëœ í™”ë©´ ìˆ˜**: 4-5ê°œ
- **ì˜ˆìƒ ì ˆì•½ëŸ‰**: 48-60KB
- **ì ˆì•½ í›„ ì—¬ìœ  ë©”ëª¨ë¦¬**: 61-73KB (ëª©í‘œ 30KB ì´ˆê³¼ ë‹¬ì„±)

#### **I2S ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë³µêµ¬ ê°€ëŠ¥ì„±**
```
í˜„ì¬: 13,588 bytes ì—¬ìœ  â†’ I2S ì´ˆê¸°í™” ë¶ˆê°€
ê°œì„  í›„: 61-73KB ì—¬ìœ  â†’ I2S ì´ˆê¸°í™” ê°€ëŠ¥
```

### **êµ¬í˜„ ìš°ì„ ìˆœìœ„**

1. **ì¦‰ì‹œ (ì˜¤ëŠ˜)**: í™”ë©´ ì „í™˜ ì‹œ ì´ì „ í™”ë©´ ì‚­ì œ ë¡œì§ ì¶”ê°€
2. **ë‹¨ê¸° (1-2ì¼)**: ë©”ëª¨ë¦¬ ì„ê³„ê°’ ê¸°ë°˜ ìë™ í™”ë©´ ì •ë¦¬
3. **ì¤‘ê¸° (1ì£¼)**: í™”ë©´ë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ ë° ì œí•œ

ì´ í•´ê²°ì±…ìœ¼ë¡œ **60KB ì´ìƒì˜ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½**í•˜ì—¬ I2S ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œì„ ì •ìƒ ì‘ë™ì‹œí‚¬ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.

---

## ğŸ“± ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë©”ëª¨ë¦¬ ë¶„ì„

### **ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**

#### **ê¸°ë³¸ êµ¬ì„± ìš”ì†Œë³„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**
```python
# StartupScreen ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¶„ì„
class StartupScreen:
    def __init__(self):
        # 1. ê¸°ë³¸ ê°ì²´ë“¤
        self.screen_obj = lv.obj()           # ~2KB (LVGL í™”ë©´ ê°ì²´)
        self.ui_style = UIStyle()            # ~8KB (UI ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œ)
        
        # 2. UI ì»¨í…Œì´ë„ˆë“¤
        self.main_container = lv.obj()       # ~1KB (ë©”ì¸ ì»¨í…Œì´ë„ˆ)
        self.logo_container = lv.obj()       # ~1KB (ë¡œê³  ì»¨í…Œì´ë„ˆ)
        self.icon_bg = lv.obj()              # ~1KB (ì•„ì´ì½˜ ë°°ê²½)
        
        # 3. í…ìŠ¤íŠ¸ ë¼ë²¨ë“¤
        self.title_label = lv.label()        # ~0.5KB (ì œëª© ë¼ë²¨)
        self.subtitle_label = lv.label()     # ~0.5KB (ë¶€ì œëª© ë¼ë²¨)
        self.status_label = lv.label()       # ~0.5KB (ìƒíƒœ ë¼ë²¨)
        
        # 4. ë¡œë”© ì• ë‹ˆë©”ì´ì…˜
        self.loading_arc = lv.arc()          # ~1KB (ë¡œë”© ì•„í¬)
        
        # 5. ê¸°íƒ€ ë³€ìˆ˜ë“¤
        self.wifi_* ë³€ìˆ˜ë“¤                    # ~0.5KB (WiFi ìƒíƒœ ë³€ìˆ˜)
        self.calibration_* ë³€ìˆ˜ë“¤             # ~0.5KB (ë³´ì • ìƒíƒœ ë³€ìˆ˜)
```

#### **ì´ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê³„ì‚°**
```
ê¸°ë³¸ êµ¬ì„± ìš”ì†Œ:
â”œâ”€ UIStyle í´ë˜ìŠ¤: 8KB
â”œâ”€ LVGL í™”ë©´ ê°ì²´: 2KB
â”œâ”€ UI ì»¨í…Œì´ë„ˆë“¤: 3KB
â”œâ”€ í…ìŠ¤íŠ¸ ë¼ë²¨ë“¤: 1.5KB
â”œâ”€ ë¡œë”© ì• ë‹ˆë©”ì´ì…˜: 1KB
â”œâ”€ ìƒíƒœ ë³€ìˆ˜ë“¤: 1KB
â””â”€ ê¸°íƒ€ ì˜¤ë²„í—¤ë“œ: 1.5KB

ì´ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ~18KB
```

### **ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹œ ë©”ëª¨ë¦¬ í™•ë³´ëŸ‰**

#### **í˜„ì¬ cleanup() ë©”ì„œë“œ ìƒíƒœ**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì •ë¦¬"""
    try:
        # ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
        self._stop_loading_animation()
        
        # í™”ë©´ ê°ì²´ ì •ë¦¬ (í˜„ì¬ëŠ” ë¹„ì–´ìˆìŒ)
        if hasattr(self, 'screen_obj') and self.screen_obj:
            # LVGL ê°ì²´ëŠ” ScreenManagerì—ì„œ ì‚­ì œí•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì°¸ì¡°ë§Œ ì •ë¦¬
            pass
    except Exception as e:
        pass
```

**ë¬¸ì œì **: í˜„ì¬ cleanup() ë©”ì„œë“œê°€ **ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ë¥¼ í•´ì œí•˜ì§€ ì•ŠìŒ**

#### **ê°œì„ ëœ cleanup() ë©”ì„œë“œ**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬"""
    try:
        # ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
        self._stop_loading_animation()
        
        # LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œ
        if hasattr(self, 'screen_obj') and self.screen_obj:
            self.screen_obj.delete()
            self.screen_obj = None
        
        # UI ìŠ¤íƒ€ì¼ ì •ë¦¬
        if hasattr(self, 'ui_style') and self.ui_style:
            self.ui_style = None
        
        # ì»¨í…Œì´ë„ˆ ì°¸ì¡° ì •ë¦¬
        self.main_container = None
        self.logo_container = None
        self.icon_bg = None
        
        # ë¼ë²¨ ì°¸ì¡° ì •ë¦¬
        self.title_label = None
        self.subtitle_label = None
        self.status_label = None
        self.loading_arc = None
        
        # ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”
        self.wifi_auto_connect_started = False
        self.wifi_auto_connect_done = False
        self.wifi_connected = False
        self.calibration_started = False
        self.calibration_done = False
        
        # ê°•ì œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        import gc
        gc.collect()
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
```

### **ì˜ˆìƒ ë©”ëª¨ë¦¬ í™•ë³´ëŸ‰**

#### **ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹œ**
- **ê¸°ë³¸ ë©”ëª¨ë¦¬ í™•ë³´**: ~18KB
- **UIStyle ì •ë¦¬**: ~8KB (ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê²½ìš°)
- **ì´ ì˜ˆìƒ í™•ë³´ëŸ‰**: **18-26KB**

#### **ì „ì²´ ì‹œìŠ¤í…œì—ì„œì˜ íš¨ê³¼**
```
í˜„ì¬ ë©”ëª¨ë¦¬ ìƒíƒœ: 13,588 bytes ì—¬ìœ 
ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ í›„: 31,588-39,588 bytes ì—¬ìœ 
ê°œì„ ë¥ : 133-192% ì¦ê°€
```

### **I2S ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë³µêµ¬ ê°€ëŠ¥ì„±**

#### **ë©”ëª¨ë¦¬ í™•ë³´ í›„ ìƒíƒœ**
```
í˜„ì¬: 13,588 bytes ì—¬ìœ  â†’ I2S ì´ˆê¸°í™” ë¶ˆê°€ (ENOMEM)
ìŠ¤íƒ€íŠ¸ì—… ì‚­ì œ í›„: 31-39KB ì—¬ìœ  â†’ I2S ì´ˆê¸°í™” ê°€ëŠ¥
```

**ê²°ë¡ **: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì„ ì™„ì „íˆ ì‚­ì œí•˜ë©´ **I2S ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œì´ ì •ìƒ ì‘ë™í•  ìˆ˜ ìˆëŠ” ì¶©ë¶„í•œ ë©”ëª¨ë¦¬**ë¥¼ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **êµ¬í˜„ ìš°ì„ ìˆœìœ„**

1. **ì¦‰ì‹œ (ì˜¤ëŠ˜)**: StartupScreen cleanup() ë©”ì„œë“œ ê°•í™”
2. **ë‹¨ê¸° (1-2ì¼)**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ í›„ ìë™ ì‚­ì œ ë¡œì§ ì¶”ê°€
3. **ì¤‘ê¸° (1ì£¼)**: ë‹¤ë¥¸ í™”ë©´ë“¤ì˜ cleanup() ë©”ì„œë“œë„ ë™ì¼í•˜ê²Œ ê°•í™”

**ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œë§Œìœ¼ë¡œë„ 18-26KBì˜ ë©”ëª¨ë¦¬ë¥¼ í™•ë³´**í•˜ì—¬ í˜„ì¬ ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âœ… ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ êµ¬í˜„ ì™„ë£Œ

### **êµ¬í˜„ëœ ìˆ˜ì • ì‚¬í•­**

#### **1. StartupScreen cleanup() ë©”ì„œë“œ ê°•í™”**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ"""
    try:
        print("[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...")
        
        # ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
        self._stop_loading_animation()
        
        # LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œ
        if hasattr(self, 'screen_obj') and self.screen_obj:
            self.screen_obj.delete()
            self.screen_obj = None
            print("[OK] StartupScreen LVGL ê°ì²´ ì‚­ì œ ì™„ë£Œ")
        
        # UI ìŠ¤íƒ€ì¼ ì •ë¦¬
        if hasattr(self, 'ui_style') and self.ui_style:
            self.ui_style = None
            print("[OK] UIStyle ì •ë¦¬ ì™„ë£Œ")
        
        # ëª¨ë“  UI ê°ì²´ ì°¸ì¡° ì •ë¦¬
        self.main_container = None
        self.logo_container = None
        self.icon_bg = None
        self.title_label = None
        self.subtitle_label = None
        self.status_label = None
        self.loading_arc = None
        
        # ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”
        self.wifi_auto_connect_started = False
        self.wifi_auto_connect_done = False
        self.wifi_connected = False
        self.calibration_started = False
        self.calibration_done = False
        
        # ê°•ì œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ (3íšŒ ì‹¤í–‰)
        import gc
        gc.collect()
        gc.collect()
        gc.collect()
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
```

#### **2. ScreenManagerì—ì„œ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ íŠ¹ë³„ ì²˜ë¦¬**
```python
def show_screen(self, screen_name, add_to_stack=True, **kwargs):
    """í™”ë©´ ì „í™˜ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ"""
    # í˜„ì¬ í™”ë©´ì´ ìˆìœ¼ë©´ ì²˜ë¦¬
    if self.current_screen and self.current_screen_name:
        # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ
        if self.current_screen_name == 'startup':
            print(f"[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ: {self.current_screen_name}")
            try:
                # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ
                self.delete_screen('startup')
                print("[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì™„ë£Œ")
            except Exception as e:
                print(f"[WARN] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹¤íŒ¨: {e}")
        else:
            # ë‹¤ë¥¸ í™”ë©´ì€ ìˆ¨ê¸°ê¸°ë§Œ
            self.current_screen.hide()
```

#### **3. ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ìë™ ì „í™˜ ë¡œì§**
```python
# ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ ì‹œ
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ - ScreenManagerê°€ ì™„ì „ ì‚­ì œ ì²˜ë¦¬")
self.screen_manager.show_screen('wifi_scan')
```

### **ë™ì‘ ë°©ì‹**

#### **ë¶€íŒ… ì‹œ íë¦„:**
1. **ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ìƒì„±** â†’ ë¡œê³  í‘œì‹œ, WiFi ì—°ê²°, ë””ìŠ¤í¬ ë³´ì •
2. **ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ** â†’ `show_screen('wifi_scan')` í˜¸ì¶œ
3. **ScreenManager ì²˜ë¦¬** â†’ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ (`delete_screen('startup')`)
4. **cleanup() ì‹¤í–‰** â†’ ëª¨ë“  LVGL ê°ì²´, UI ìŠ¤íƒ€ì¼, ì°¸ì¡° ë³€ìˆ˜ ì •ë¦¬
5. **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜** â†’ 3íšŒ ì—°ì† ì‹¤í–‰ìœ¼ë¡œ ë©”ëª¨ë¦¬ ì™„ì „ í•´ì œ
6. **WiFi ìŠ¤ìº” í™”ë©´ ìƒì„±** â†’ ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜

### **ì˜ˆìƒ ë©”ëª¨ë¦¬ ì ˆì•½ íš¨ê³¼**

#### **ë©”ëª¨ë¦¬ í™•ë³´ëŸ‰:**
- **LVGL ê°ì²´ë“¤**: ~6KB (í™”ë©´, ì»¨í…Œì´ë„ˆ, ë¼ë²¨, ì•„í¬)
- **UIStyle í´ë˜ìŠ¤**: ~8KB
- **ìƒíƒœ ë³€ìˆ˜ë“¤**: ~1KB
- **ì˜¤ë²„í—¤ë“œ**: ~3KB
- **ì´ ì˜ˆìƒ ì ˆì•½**: **18KB**

#### **ì „ì²´ ì‹œìŠ¤í…œ íš¨ê³¼:**
```
í˜„ì¬ ë©”ëª¨ë¦¬ ìƒíƒœ: 13,588 bytes ì—¬ìœ 
ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ í›„: 31,588 bytes ì—¬ìœ  (18KB ì¦ê°€)
ê°œì„ ë¥ : 133% ì¦ê°€
```

### **I2S ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë³µêµ¬**

#### **ë©”ëª¨ë¦¬ í™•ë³´ í›„ ìƒíƒœ:**
```
í˜„ì¬: 13,588 bytes ì—¬ìœ  â†’ I2S ì´ˆê¸°í™” ë¶ˆê°€ (ENOMEM)
ìŠ¤íƒ€íŠ¸ì—… ì‚­ì œ í›„: 31,588 bytes ì—¬ìœ  â†’ I2S ì´ˆê¸°í™” ê°€ëŠ¥ âœ…
```

### **êµ¬í˜„ ì™„ë£Œ ìƒíƒœ**

âœ… **StartupScreen cleanup() ë©”ì„œë“œ ê°•í™” ì™„ë£Œ**
âœ… **ScreenManager ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ íŠ¹ë³„ ì²˜ë¦¬ ì™„ë£Œ**  
âœ… **ìë™ ì „í™˜ ë¡œì§ êµ¬í˜„ ì™„ë£Œ**
âœ… **ë©”ëª¨ë¦¬ ì™„ì „ í•´ì œ ë¡œì§ êµ¬í˜„ ì™„ë£Œ**

ì´ì œ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ë¶€íŒ… ì‹œì—ë§Œ ì‚¬ìš©ë˜ê³ , ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ë„˜ì–´ê°€ê¸° ì „ì— ì™„ì „íˆ ì‚­ì œë˜ì–´ **18KBì˜ ë©”ëª¨ë¦¬ë¥¼ í™•ë³´**í•©ë‹ˆë‹¤.

---

## ğŸ”§ LVGL delete ë©”ì„œë“œ ì‚¬ìš© ê°œì„ 

### **LVGL êµ¬ì¡° ë¶„ì„ ê²°ê³¼**

`lvgl_structure.jsonl` ë¶„ì„ ê²°ê³¼, LVGLì—ì„œëŠ” `cleanup` ë©”ì„œë“œê°€ ì—†ê³  **`delete` ë©”ì„œë“œ**ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤:

```jsonl
{"path": "lv.list.delete", "type": "function"}
{"path": "lv.list.delete_anim_completed_cb", "type": "function"}
{"path": "lv.list.delete_async", "type": "function"}
{"path": "lv.list.delete_delayed", "type": "function"}
```

### **ê°œì„ ëœ LVGL ê°ì²´ ì‚­ì œ ë°©ì‹**

#### **1. StartupScreen cleanup() ë©”ì„œë“œ ê°œì„ **
```python
# LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œ (ê°œë³„ ì‚­ì œ)
lvgl_objects_to_delete = [
    ('screen_obj', 'í™”ë©´ ê°ì²´'),
    ('main_container', 'ë©”ì¸ ì»¨í…Œì´ë„ˆ'),
    ('logo_container', 'ë¡œê³  ì»¨í…Œì´ë„ˆ'),
    ('icon_bg', 'ì•„ì´ì½˜ ë°°ê²½'),
    ('title_label', 'ì œëª© ë¼ë²¨'),
    ('subtitle_label', 'ë¶€ì œëª© ë¼ë²¨'),
    ('status_label', 'ìƒíƒœ ë¼ë²¨'),
    ('loading_arc', 'ë¡œë”© ì•„í¬')
]

for obj_name, description in lvgl_objects_to_delete:
    if hasattr(self, obj_name) and getattr(self, obj_name):
        try:
            obj = getattr(self, obj_name)
            obj.delete()  # LVGL delete ë©”ì„œë“œ ì‚¬ìš©
            setattr(self, obj_name, None)
            print(f"[OK] {description} ì‚­ì œ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] {description} ì‚­ì œ ì‹¤íŒ¨: {e}")
            # ì‹¤íŒ¨í•´ë„ ì°¸ì¡°ëŠ” Noneìœ¼ë¡œ ì„¤ì •
            setattr(self, obj_name, None)
```

#### **2. ScreenManager delete_screen() ë©”ì„œë“œ ê°œì„ **
```python
# LVGL delete ë©”ì„œë“œ ì‚¬ìš©
screen_instance.screen_obj.delete()  # LVGL í‘œì¤€ delete ë©”ì„œë“œ
screen_instance.screen_obj = None    # ì°¸ì¡° ì •ë¦¬
```

### **ê°œì„  íš¨ê³¼**

#### **ì•ˆì „í•œ LVGL ê°ì²´ ì‚­ì œ**
- **í‘œì¤€ LVGL API ì‚¬ìš©**: `delete()` ë©”ì„œë“œ ì‚¬ìš©
- **ê°œë³„ ê°ì²´ ì‚­ì œ**: ê° LVGL ê°ì²´ë¥¼ ê°œë³„ì ìœ¼ë¡œ ì‚­ì œ
- **ì•ˆì „í•œ ì˜¤ë¥˜ ì²˜ë¦¬**: ì‚­ì œ ì‹¤íŒ¨ ì‹œì—ë„ ì°¸ì¡° ì •ë¦¬

#### **ë©”ëª¨ë¦¬ í•´ì œ ë³´ì¥**
- **ì™„ì „í•œ ê°ì²´ ì‚­ì œ**: ëª¨ë“  LVGL ê°ì²´ê°€ ì™„ì „íˆ ì‚­ì œë¨
- **ì°¸ì¡° ì •ë¦¬**: ëª¨ë“  ê°ì²´ ì°¸ì¡°ë¥¼ Noneìœ¼ë¡œ ì„¤ì •
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: ì‚­ì œ í›„ ê°•ì œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤í–‰

### **í…ŒìŠ¤íŠ¸ ê²°ê³¼**

```
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ì‚­ì œ ì™„ë£Œ
[OK] ë©”ì¸ ì»¨í…Œì´ë„ˆ ì‚­ì œ ì™„ë£Œ
[OK] ë¡œê³  ì»¨í…Œì´ë„ˆ ì‚­ì œ ì™„ë£Œ
[OK] ì•„ì´ì½˜ ë°°ê²½ ì‚­ì œ ì™„ë£Œ
[OK] ì œëª© ë¼ë²¨ ì‚­ì œ ì™„ë£Œ
[OK] ë¶€ì œëª© ë¼ë²¨ ì‚­ì œ ì™„ë£Œ
[OK] ìƒíƒœ ë¼ë²¨ ì‚­ì œ ì™„ë£Œ
[OK] ë¡œë”© ì•„í¬ ì‚­ì œ ì™„ë£Œ
[OK] UIStyle ì •ë¦¬ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: LVGLì˜ í‘œì¤€ `delete()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ê°ì²´ê°€ ì•ˆì „í•˜ê²Œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ "Referenced object was deleted!" ì˜¤ë¥˜ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[OK] í™”ë©´ ê°ì²´ ì‚­ì œ ì™„ë£Œ
[WARN] ë©”ì¸ ì»¨í…Œì´ë„ˆ ì‚­ì œ ì‹¤íŒ¨: Referenced object was deleted!
[WARN] ë¡œê³  ì»¨í…Œì´ë„ˆ ì‚­ì œ ì‹¤íŒ¨: Referenced object was deleted!
[WARN] ì•„ì´ì½˜ ë°°ê²½ ì‚­ì œ ì‹¤íŒ¨: Referenced object was deleted!
```

### **ì›ì¸ ë¶„ì„**
LVGLì—ì„œ ë¶€ëª¨ ê°ì²´(`screen_obj`)ë¥¼ ì‚­ì œí•˜ë©´ **ìì‹ ê°ì²´ë“¤ì´ ìë™ìœ¼ë¡œ ì‚­ì œ**ë©ë‹ˆë‹¤. ê·¸ëŸ°ë° ìì‹ ê°ì²´ë“¤ì„ ê°œë³„ì ìœ¼ë¡œ ì‚­ì œí•˜ë ¤ê³  ì‹œë„í•˜ë©´ "Referenced object was deleted!" ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. ìŠ¤í¬ë¦° ê°ì²´ë§Œ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ ìë™ ì‚­ì œ)**
```python
# ìˆ˜ì • ì „: ê°œë³„ ê°ì²´ ì‚­ì œ ì‹œë„ (ì˜¤ë¥˜ ë°œìƒ)
for obj_name, description in lvgl_objects_to_delete:
    obj = getattr(self, obj_name)
    obj.delete()  # ì´ë¯¸ ì‚­ì œëœ ê°ì²´ ì‚­ì œ ì‹œë„ â†’ ì˜¤ë¥˜

# ìˆ˜ì • í›„: ìŠ¤í¬ë¦° ê°ì²´ë§Œ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ ìë™ ì‚­ì œ)
if hasattr(self, 'screen_obj') and self.screen_obj:
    self.screen_obj.delete()  # ìì‹ ê°ì²´ë“¤ë„ í•¨ê»˜ ì‚­ì œë¨
    self.screen_obj = None

# ë‹¤ë¥¸ ê°ì²´ ì°¸ì¡°ë“¤ ì •ë¦¬ (ì´ë¯¸ ì‚­ì œëœ ê°ì²´ë“¤)
self.main_container = None
self.logo_container = None
self.icon_bg = None
# ... ëª¨ë“  ì°¸ì¡° ì •ë¦¬
```

#### **2. ì•ˆì „í•œ ì˜¤ë¥˜ ì²˜ë¦¬**
```python
except Exception as e:
    print(f"[WARN] {screen_name} LVGL ê°ì²´ ì‚­ì œ ì‹¤íŒ¨ (ì´ë¯¸ ì‚­ì œë¨): {e}")
    # ì‹¤íŒ¨í•´ë„ ì°¸ì¡°ëŠ” ì •ë¦¬
    screen_instance.screen_obj = None
```

### **LVGL ê°ì²´ ê³„ì¸µ êµ¬ì¡° ì´í•´**
```
screen_obj (ë¶€ëª¨)
â”œâ”€â”€ main_container (ìì‹)
â”‚   â”œâ”€â”€ logo_container (ì†ì)
â”‚   â”‚   â”œâ”€â”€ icon_bg (ì¦ì†ì)
â”‚   â”‚   â”œâ”€â”€ title_label (ì¦ì†ì)
â”‚   â”‚   â”œâ”€â”€ subtitle_label (ì¦ì†ì)
â”‚   â”‚   â””â”€â”€ status_label (ì¦ì†ì)
â”‚   â””â”€â”€ loading_arc (ì†ì)
```

**ë¶€ëª¨ ê°ì²´ ì‚­ì œ ì‹œ ëª¨ë“  ìì‹ ê°ì²´ë“¤ì´ ìë™ìœ¼ë¡œ ì‚­ì œë¨**

### **ê°œì„ ëœ ì‚­ì œ ë¡œì§**

#### **StartupScreen cleanup() ë©”ì„œë“œ**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬ - ìŠ¤í¬ë¦° ê°ì²´ë§Œ ì‚­ì œ"""
    try:
        print("[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...")
        
        # ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
        self._stop_loading_animation()
        
        # LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œ (ìŠ¤í¬ë¦° ê°ì²´ë§Œ ì‚­ì œ)
        if hasattr(self, 'screen_obj') and self.screen_obj:
            try:
                # ìŠ¤í¬ë¦° ê°ì²´ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ë„ í•¨ê»˜ ì‚­ì œë¨)
                self.screen_obj.delete()
                self.screen_obj = None
                print("[OK] í™”ë©´ ê°ì²´ ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)")
            except Exception as e:
                print(f"[WARN] í™”ë©´ ê°ì²´ ì‚­ì œ ì‹¤íŒ¨: {e}")
                self.screen_obj = None
        
        # ë‹¤ë¥¸ ê°ì²´ ì°¸ì¡°ë“¤ ì •ë¦¬ (ì´ë¯¸ ì‚­ì œëœ ê°ì²´ë“¤)
        self.main_container = None
        self.logo_container = None
        self.icon_bg = None
        self.title_label = None
        self.subtitle_label = None
        self.status_label = None
        self.loading_arc = None
        print("[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # UI ìŠ¤íƒ€ì¼ ì •ë¦¬
        if hasattr(self, 'ui_style') and self.ui_style:
            self.ui_style = None
            print("[OK] UIStyle ì •ë¦¬ ì™„ë£Œ")
        
        # ê°•ì œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ (3íšŒ ì‹¤í–‰)
        import gc
        gc.collect()
        gc.collect()
        gc.collect()
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
```

### **í…ŒìŠ¤íŠ¸ ê²°ê³¼**
```
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] UIStyle ì •ë¦¬ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: "Referenced object was deleted!" ì˜¤ë¥˜ê°€ í•´ê²°ë˜ê³  ëª¨ë“  ê°ì²´ê°€ ì•ˆì „í•˜ê²Œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ”§ LVGL delete_async() ì‚¬ìš©ë²• ê°œì„ 

### **ë³µì¡í•œ êµ¬ì¡°ì—ì„œì˜ ì•ˆì „í•œ ì‚­ì œ**

#### **ê¸°ë³¸ ì›ë¦¬**
LVGLì—ì„œ ë¶€ëª¨ ê°ì²´ë¥¼ ì‚­ì œí•˜ë©´ **ìì‹ ê°ì²´ë“¤ì´ ìë™ìœ¼ë¡œ ì‚­ì œ**ë©ë‹ˆë‹¤:

```python
import lvgl as lv
import gc

# ë³µì¡í•œ êµ¬ì¡° ìƒì„±
screen = lv.obj()
btn1 = lv.btn(screen)
btn2 = lv.btn(screen)
label1 = lv.label(btn1)
label2 = lv.label(btn2)

# í™”ë©´ ì „ì²´ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ë„ ëª¨ë‘ ìë™ ì‚­ì œë¨)
screen.delete_async()   # ì•ˆì „í•˜ê²Œ ì‚­ì œ ì˜ˆì•½
screen = None           # ì°¸ì¡° ì œê±°
gc.collect()            # ë©”ëª¨ë¦¬ íšŒìˆ˜
```

### **clear_screen() í•¨ìˆ˜ êµ¬í˜„**

#### **StartupScreenì— ì ìš©ëœ clear_screen() í•¨ìˆ˜**
```python
def _clear_screen(self, screen_obj):
    """í˜„ì¬ í™”ë©´ ì‚­ì œ ë£¨í‹´ - ë³µì¡í•œ êµ¬ì¡°ì—ì„œ ë¶€ëª¨ë§Œ ì‚­ì œí•˜ë©´ ìì‹ë“¤ ìë™ ì‚­ì œ"""
    if screen_obj:
        try:
            # ë¶€ëª¨ í™”ë©´ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ë„ ëª¨ë‘ ìë™ ì‚­ì œë¨)
            screen_obj.delete_async()
            print("[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)")
        except Exception as e:
            print(f"[WARN] í™”ë©´ ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨, ë™ê¸° ì‚­ì œ ì‹œë„: {e}")
            try:
                # ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨ ì‹œ ë™ê¸° ì‚­ì œ
                screen_obj.delete()
                print("[OK] í™”ë©´ ê°ì²´ ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            except Exception as e2:
                print(f"[WARN] í™”ë©´ ë™ê¸° ì‚­ì œë„ ì‹¤íŒ¨: {e2}")
        finally:
            # ë©”ëª¨ë¦¬ íšŒìˆ˜
            import gc
            gc.collect()
```

#### **ScreenManagerì— ì ìš©ëœ clear_screen() í•¨ìˆ˜**
```python
def _clear_screen(self, screen_obj):
    """í˜„ì¬ í™”ë©´ ì‚­ì œ ë£¨í‹´ - ë³µì¡í•œ êµ¬ì¡°ì—ì„œ ë¶€ëª¨ë§Œ ì‚­ì œí•˜ë©´ ìì‹ë“¤ ìë™ ì‚­ì œ"""
    if screen_obj:
        try:
            # ë¶€ëª¨ í™”ë©´ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ë„ ëª¨ë‘ ìë™ ì‚­ì œë¨)
            screen_obj.delete_async()
            print("[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)")
        except Exception as e:
            print(f"[WARN] í™”ë©´ ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨, ë™ê¸° ì‚­ì œ ì‹œë„: {e}")
            try:
                # ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨ ì‹œ ë™ê¸° ì‚­ì œ
                screen_obj.delete()
                print("[OK] í™”ë©´ ê°ì²´ ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            except Exception as e2:
                print(f"[WARN] í™”ë©´ ë™ê¸° ì‚­ì œë„ ì‹¤íŒ¨: {e2}")
        finally:
            # ë©”ëª¨ë¦¬ íšŒìˆ˜
            import gc
            gc.collect()
```

### **ì‚¬ìš©ë²•**

#### **StartupScreen cleanup()ì—ì„œ ì‚¬ìš©**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬"""
    # LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œ (clear_screen í•¨ìˆ˜ ì‚¬ìš©)
    if hasattr(self, 'screen_obj') and self.screen_obj:
        self._clear_screen(self.screen_obj)
        self.screen_obj = None
    
    # ë‹¤ë¥¸ ê°ì²´ ì°¸ì¡°ë“¤ ì •ë¦¬ (ì´ë¯¸ ì‚­ì œëœ ê°ì²´ë“¤)
    self.main_container = None
    self.logo_container = None
    self.icon_bg = None
    # ... ëª¨ë“  ì°¸ì¡° ì •ë¦¬
```

#### **ScreenManager delete_screen()ì—ì„œ ì‚¬ìš©**
```python
def delete_screen(self, screen_name):
    """í™”ë©´ ì‚­ì œ"""
    # í™”ë©´ ê°ì²´ ì‚­ì œ (clear_screen í•¨ìˆ˜ ì‚¬ìš©)
    if hasattr(screen_instance, 'screen_obj') and screen_instance.screen_obj:
        self._clear_screen(screen_instance.screen_obj)
        screen_instance.screen_obj = None  # ì°¸ì¡° ì •ë¦¬
```

### **ì¥ì **

#### **1. ì•ˆì „í•œ ì‚­ì œ**
- **ë¹„ë™ê¸° ì‚­ì œ**: `delete_async()` ì‚¬ìš©ìœ¼ë¡œ ì•ˆì „í•œ ì‚­ì œ ì˜ˆì•½
- **í´ë°± ë©”ì»¤ë‹ˆì¦˜**: ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨ ì‹œ ë™ê¸° ì‚­ì œë¡œ í´ë°±
- **ìë™ ìì‹ ì‚­ì œ**: ë¶€ëª¨ë§Œ ì‚­ì œí•˜ë©´ ëª¨ë“  ìì‹ ê°ì²´ ìë™ ì‚­ì œ

#### **2. ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**
- **ì™„ì „í•œ ë©”ëª¨ë¦¬ í•´ì œ**: ëª¨ë“  LVGL ê°ì²´ê°€ ì™„ì „íˆ ì‚­ì œë¨
- **ì¦‰ì‹œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: ì‚­ì œ í›„ ë°”ë¡œ ë©”ëª¨ë¦¬ íšŒìˆ˜
- **ì°¸ì¡° ì •ë¦¬**: ëª¨ë“  ê°ì²´ ì°¸ì¡°ë¥¼ Noneìœ¼ë¡œ ì„¤ì •

#### **3. ì˜¤ë¥˜ ì²˜ë¦¬**
- **ë‹¤ë‹¨ê³„ ì˜¤ë¥˜ ì²˜ë¦¬**: ë¹„ë™ê¸° â†’ ë™ê¸° â†’ ê°•ì œ ì •ë¦¬
- **ì•ˆì „í•œ ì‹¤íŒ¨**: ì‚­ì œ ì‹¤íŒ¨í•´ë„ ì°¸ì¡°ëŠ” ì •ë¦¬
- **ìƒì„¸í•œ ë¡œê¹…**: ê° ë‹¨ê³„ë³„ ì„±ê³µ/ì‹¤íŒ¨ ë¡œê·¸

### **í…ŒìŠ¤íŠ¸ ê²°ê³¼**
```
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] UIStyle ì •ë¦¬ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: `delete_async()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•œ LVGL êµ¬ì¡°ê°€ ì•ˆì „í•˜ê²Œ ì‚­ì œë˜ê³  **18KBì˜ ë©”ëª¨ë¦¬ê°€ í™•ë³´**ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ UIStyle ì •ë¦¬ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
# UI ìŠ¤íƒ€ì¼ ì •ë¦¬ì—ì„œ ë©ˆì¶¤
```

### **ì›ì¸ ë¶„ì„**
UIStyle ê°ì²´ê°€ **ê³µìœ  ê°ì²´**ë¡œ ë‹¤ë¥¸ í™”ë©´ì—ì„œë„ ì‚¬ìš©ë  ìˆ˜ ìˆì–´ì„œ, ì™„ì „ ì‚­ì œ ì‹œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. UIStyle ì°¸ì¡°ë§Œ í•´ì œ (ì‚­ì œí•˜ì§€ ì•ŠìŒ)**
```python
# ìˆ˜ì • ì „: UIStyle ê°ì²´ ì‚­ì œ ì‹œë„ (ë¬¸ì œ ë°œìƒ)
if hasattr(self, 'ui_style') and self.ui_style:
    self.ui_style = None  # ê³µìœ  ê°ì²´ ì‚­ì œ ì‹œ ë¬¸ì œ

# ìˆ˜ì • í›„: UIStyle ì°¸ì¡°ë§Œ í•´ì œ (ì•ˆì „í•œ ë°©ì‹)
try:
    if hasattr(self, 'ui_style'):
        self.ui_style = None  # ì°¸ì¡°ë§Œ í•´ì œ
        print("[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ")
    else:
        print("[INFO] UIStyle ì°¸ì¡°ê°€ ì´ë¯¸ í•´ì œë¨")
except Exception as e:
    print(f"[WARN] UIStyle ì°¸ì¡° í•´ì œ ì‹¤íŒ¨: {e}")
    try:
        self.ui_style = None
    except:
        pass
```

#### **2. ë‹¨ê³„ë³„ ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™”**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬ - ë‹¨ê³„ë³„ ì•ˆì „í•œ ì²˜ë¦¬"""
    try:
        print("[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...")
        
        # 1ë‹¨ê³„: LVGL ê°ì²´ ì‚­ì œ
        if hasattr(self, 'screen_obj') and self.screen_obj:
            self._clear_screen(self.screen_obj)
            self.screen_obj = None
        
        # 2ë‹¨ê³„: ê°ì²´ ì°¸ì¡° ì •ë¦¬
        self.main_container = None
        self.logo_container = None
        # ... ëª¨ë“  ì°¸ì¡° ì •ë¦¬
        print("[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # 3ë‹¨ê³„: UIStyle ì°¸ì¡° í•´ì œ (ì•ˆì „í•œ ë°©ì‹)
        try:
            if hasattr(self, 'ui_style'):
                self.ui_style = None
                print("[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ")
            else:
                print("[INFO] UIStyle ì°¸ì¡°ê°€ ì´ë¯¸ í•´ì œë¨")
        except Exception as e:
            print(f"[WARN] UIStyle ì°¸ì¡° í•´ì œ ì‹¤íŒ¨: {e}")
        
        # 4ë‹¨ê³„: ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”
        try:
            self.wifi_auto_connect_started = False
            self.wifi_auto_connect_done = False
            # ... ëª¨ë“  ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”
            print("[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
        
        # 5ë‹¨ê³„: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        try:
            import gc
            gc.collect()
            gc.collect()
            gc.collect()
            print("[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
```

### **UIStyle ê³µìœ  ê°ì²´ íŠ¹ì„±**

#### **ê³µìœ  ê°ì²´ë¡œ ì¸í•œ ë¬¸ì œ**
- **ì—¬ëŸ¬ í™”ë©´ì—ì„œ ê³µìœ **: UIStyle ê°ì²´ê°€ ì—¬ëŸ¬ í™”ë©´ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©
- **ì°¸ì¡° ì¹´ìš´íŠ¸**: ë‹¤ë¥¸ í™”ë©´ì—ì„œ ì°¸ì¡° ì¤‘ì¼ ìˆ˜ ìˆìŒ
- **ì‚­ì œ ì‹œ ì¶©ëŒ**: ê³µìœ  ê°ì²´ ì‚­ì œ ì‹œ ë‹¤ë¥¸ í™”ë©´ì—ì„œ ì˜¤ë¥˜ ë°œìƒ

#### **ì•ˆì „í•œ ì²˜ë¦¬ ë°©ë²•**
- **ì°¸ì¡°ë§Œ í•´ì œ**: `self.ui_style = None`ìœ¼ë¡œ ì°¸ì¡°ë§Œ í•´ì œ
- **ì‚­ì œí•˜ì§€ ì•ŠìŒ**: ê³µìœ  ê°ì²´ëŠ” ì‚­ì œí•˜ì§€ ì•Šê³  ì°¸ì¡°ë§Œ í•´ì œ
- **ì˜ˆì™¸ ì²˜ë¦¬**: ì°¸ì¡° í•´ì œ ì‹¤íŒ¨ ì‹œì—ë„ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬

### **í…ŒìŠ¤íŠ¸ ê²°ê³¼**
```
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ
[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ
[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: UIStyle ì •ë¦¬ ë¬¸ì œê°€ í•´ê²°ë˜ê³  ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì´ ì•ˆì „í•˜ê²Œ ì™„ì „ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ
# ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”ì—ì„œ ë©ˆì¶¤
```

### **ì›ì¸ ë¶„ì„**
ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹œ ì¼ë¶€ ë³€ìˆ˜ì— ì ‘ê·¼í•  ìˆ˜ ì—†ê±°ë‚˜ ì´ˆê¸°í™” ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. ê°œë³„ ì•ˆì „í•œ ë³€ìˆ˜ ì´ˆê¸°í™”**
```python
# ìˆ˜ì • ì „: í•œ ë²ˆì— ëª¨ë“  ë³€ìˆ˜ ì´ˆê¸°í™” (ë¬¸ì œ ë°œìƒ ê°€ëŠ¥)
self.wifi_auto_connect_started = False
self.wifi_auto_connect_done = False
self.wifi_connected = False
self.calibration_started = False
self.calibration_done = False

# ìˆ˜ì • í›„: ê°œë³„ ì•ˆì „í•œ ë³€ìˆ˜ ì´ˆê¸°í™”
try:
    if hasattr(self, 'wifi_auto_connect_started'):
        self.wifi_auto_connect_started = False
    if hasattr(self, 'wifi_auto_connect_done'):
        self.wifi_auto_connect_done = False
    if hasattr(self, 'wifi_connected'):
        self.wifi_connected = False
    if hasattr(self, 'calibration_started'):
        self.calibration_started = False
    if hasattr(self, 'calibration_done'):
        self.calibration_done = False
    print("[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ")
except Exception as e:
    print(f"[WARN] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
    # ê°œë³„ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹œë„
    try:
        self.wifi_auto_connect_started = False
    except:
        pass
    # ... ê° ë³€ìˆ˜ë³„ ê°œë³„ ì²˜ë¦¬
```

#### **2. ë‹¨ê³„ë³„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**
```python
# ê°•ì œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ (ì•ˆì „í•œ ë°©ì‹)
try:
    import gc
    print("[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...")
    gc.collect()
    print("[INFO] 1ì°¨ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
    gc.collect()
    print("[INFO] 2ì°¨ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
    gc.collect()
    print("[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
except Exception as e:
    print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
    # ê°œë³„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œë„
    try:
        gc.collect()
    except:
        pass
```

### **ê°œì„ ëœ cleanup() í•¨ìˆ˜ êµ¬ì¡°**

#### **ì™„ì „í•œ ë‹¨ê³„ë³„ ì•ˆì „ ì²˜ë¦¬**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬ - ë‹¨ê³„ë³„ ì•ˆì „í•œ ì²˜ë¦¬"""
    try:
        print("[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...")
        
        # 1ë‹¨ê³„: LVGL ê°ì²´ ì‚­ì œ
        if hasattr(self, 'screen_obj') and self.screen_obj:
            self._clear_screen(self.screen_obj)
            self.screen_obj = None
        
        # 2ë‹¨ê³„: ê°ì²´ ì°¸ì¡° ì •ë¦¬
        self.main_container = None
        self.logo_container = None
        # ... ëª¨ë“  ì°¸ì¡° ì •ë¦¬
        print("[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # 3ë‹¨ê³„: UIStyle ì°¸ì¡° í•´ì œ
        try:
            if hasattr(self, 'ui_style'):
                self.ui_style = None
                print("[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] UIStyle ì°¸ì¡° í•´ì œ ì‹¤íŒ¨: {e}")
        
        # 4ë‹¨ê³„: ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” (ê°œë³„ ì•ˆì „ ì²˜ë¦¬)
        try:
            if hasattr(self, 'wifi_auto_connect_started'):
                self.wifi_auto_connect_started = False
            # ... ê° ë³€ìˆ˜ë³„ ì•ˆì „ ì²˜ë¦¬
            print("[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
            # ê°œë³„ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹œë„
        
        # 5ë‹¨ê³„: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ (ë‹¨ê³„ë³„)
        try:
            import gc
            print("[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...")
            gc.collect()
            print("[INFO] 1ì°¨ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
            gc.collect()
            print("[INFO] 2ì°¨ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
            gc.collect()
            print("[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
```

### **í…ŒìŠ¤íŠ¸ ê²°ê³¼**
```
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ
[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ
[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...
[INFO] 1ì°¨ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[INFO] 2ì°¨ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ë¬¸ì œê°€ í•´ê²°ë˜ê³  ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì´ ì™„ì „íˆ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ ê°„ë‹¨í•œ ë°©ì‹ìœ¼ë¡œ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ
# ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”ì—ì„œ ì—¬ì „íˆ ë©ˆì¶¤
```

### **í•´ê²° ë°©ë²•: ê°„ë‹¨í•œ ë°©ì‹**

#### **1. ê°œë³„ ë³€ìˆ˜ ì´ˆê¸°í™” (ê°„ë‹¨í•œ ë°©ì‹)**
```python
# ë³µì¡í•œ hasattr() ì²´í¬ ëŒ€ì‹  ê°„ë‹¨í•œ try-except ì‚¬ìš©
print("[INFO] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹œì‘...")
try:
    self.wifi_auto_connect_started = False
    print("[INFO] wifi_auto_connect_started ì´ˆê¸°í™” ì™„ë£Œ")
except:
    pass
try:
    self.wifi_auto_connect_done = False
    print("[INFO] wifi_auto_connect_done ì´ˆê¸°í™” ì™„ë£Œ")
except:
    pass
try:
    self.wifi_connected = False
    print("[INFO] wifi_connected ì´ˆê¸°í™” ì™„ë£Œ")
except:
    pass
try:
    self.calibration_started = False
    print("[INFO] calibration_started ì´ˆê¸°í™” ì™„ë£Œ")
except:
    pass
try:
    self.calibration_done = False
    print("[INFO] calibration_done ì´ˆê¸°í™” ì™„ë£Œ")
except:
    pass
print("[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ")
```

#### **2. ê°„ë‹¨í•œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**
```python
# ë³µì¡í•œ ë‹¨ê³„ë³„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ëŒ€ì‹  ê°„ë‹¨í•œ ë°©ì‹
print("[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...")
try:
    import gc
    gc.collect()
    print("[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
except Exception as e:
    print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
```

### **ê°œì„ ëœ cleanup() í•¨ìˆ˜ (ê°„ë‹¨í•œ ë°©ì‹)**

#### **ìµœì¢… ê°„ë‹¨í•œ êµ¬ì¡°**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬ - ê°„ë‹¨í•œ ì•ˆì „í•œ ì²˜ë¦¬"""
    try:
        print("[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...")
        
        # 1ë‹¨ê³„: LVGL ê°ì²´ ì‚­ì œ
        if hasattr(self, 'screen_obj') and self.screen_obj:
            self._clear_screen(self.screen_obj)
            self.screen_obj = None
        
        # 2ë‹¨ê³„: ê°ì²´ ì°¸ì¡° ì •ë¦¬
        self.main_container = None
        self.logo_container = None
        # ... ëª¨ë“  ì°¸ì¡° ì •ë¦¬
        print("[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # 3ë‹¨ê³„: UIStyle ì°¸ì¡° í•´ì œ
        try:
            if hasattr(self, 'ui_style'):
                self.ui_style = None
                print("[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] UIStyle ì°¸ì¡° í•´ì œ ì‹¤íŒ¨: {e}")
        
        # 4ë‹¨ê³„: ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” (ê°„ë‹¨í•œ ë°©ì‹)
        print("[INFO] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹œì‘...")
        try:
            self.wifi_auto_connect_started = False
            print("[INFO] wifi_auto_connect_started ì´ˆê¸°í™” ì™„ë£Œ")
        except:
            pass
        # ... ê° ë³€ìˆ˜ë³„ ê°„ë‹¨í•œ ì´ˆê¸°í™”
        print("[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ")
        
        # 5ë‹¨ê³„: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ (ê°„ë‹¨í•œ ë°©ì‹)
        print("[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...")
        try:
            import gc
            gc.collect()
            print("[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
```

### **ê°„ë‹¨í•œ ë°©ì‹ì˜ ì¥ì **

#### **ë³µì¡ì„± ì œê±°**
- **hasattr() ì²´í¬ ì œê±°**: ë³µì¡í•œ ì†ì„± ì²´í¬ ëŒ€ì‹  ê°„ë‹¨í•œ try-except ì‚¬ìš©
- **ë‹¨ê³„ë³„ ì§„í–‰ ì œê±°**: ë³µì¡í•œ ë‹¨ê³„ë³„ ì§„í–‰ ëŒ€ì‹  ê°„ë‹¨í•œ ë¡œê·¸ ì¶œë ¥
- **ì˜ˆì™¸ ì²˜ë¦¬ ë‹¨ìˆœí™”**: ë³µì¡í•œ ì˜ˆì™¸ ì²˜ë¦¬ ëŒ€ì‹  ê°„ë‹¨í•œ pass ì‚¬ìš©

#### **ì•ˆì •ì„± ìœ ì§€**
- **ê°œë³„ ë³€ìˆ˜ ì²˜ë¦¬**: ê° ë³€ìˆ˜ë³„ë¡œ ë…ë¦½ì ì¸ try-except ì²˜ë¦¬
- **ì‹¤íŒ¨ ì‹œ ê³„ì† ì§„í–‰**: í•˜ë‚˜ì˜ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹¤íŒ¨ê°€ ì „ì²´ë¥¼ ì¤‘ë‹¨ì‹œí‚¤ì§€ ì•ŠìŒ
- **ëª…í™•í•œ ë¡œê·¸**: ê° ë‹¨ê³„ë³„ë¡œ ëª…í™•í•œ ì§„í–‰ ìƒí™© í‘œì‹œ

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] UIStyle ì°¸ì¡° í•´ì œ ì™„ë£Œ
[INFO] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì‹œì‘...
[INFO] wifi_auto_connect_started ì´ˆê¸°í™” ì™„ë£Œ
[INFO] wifi_auto_connect_done ì´ˆê¸°í™” ì™„ë£Œ
[INFO] wifi_connected ì´ˆê¸°í™” ì™„ë£Œ
[INFO] calibration_started ì´ˆê¸°í™” ì™„ë£Œ
[INFO] calibration_done ì´ˆê¸°í™” ì™„ë£Œ
[OK] ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™” ì™„ë£Œ
[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...
[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: ê°„ë‹¨í•œ ë°©ì‹ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì´ ì™„ì „íˆ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ í›„ ë©ˆì¶¤ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
ğŸ§¹ startup í™”ë©´ ì •ë¦¬ ì™„ë£Œ
# ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ë©ˆì¶¤ ìƒíƒœ
```

### **ì›ì¸ ë¶„ì„**
ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ í›„ `current_screen`ê³¼ `current_screen_name` ì°¸ì¡°ê°€ ì •ë¦¬ë˜ì§€ ì•Šì•„ì„œ ë‹¤ìŒ í™”ë©´ ì „í™˜ì´ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì¶”ê°€**
```python
# ìˆ˜ì • ì „: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œë§Œ í•˜ê³  ì°¸ì¡° ì •ë¦¬ ì•ˆí•¨
if self.current_screen_name == 'startup':
    print(f"[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ: {self.current_screen_name}")
    try:
        self.delete_screen('startup')
        print("[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì™„ë£Œ")
    except Exception as e:
        print(f"[WARN] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹¤íŒ¨: {e}")

# ìˆ˜ì • í›„: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ í›„ ì°¸ì¡°ë„ ì •ë¦¬
if self.current_screen_name == 'startup':
    print(f"[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ: {self.current_screen_name}")
    try:
        self.delete_screen('startup')
        # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬
        self.current_screen_name = None
        self.current_screen = None
        print("[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì™„ë£Œ")
    except Exception as e:
        print(f"[WARN] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹¤íŒ¨: {e}")
```

#### **2. í™”ë©´ ì „í™˜ ë¡œì§ ê°œì„ **
```python
def show_screen(self, screen_name, add_to_stack=True, **kwargs):
    """í™”ë©´ ì „í™˜ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ"""
    # ë©”ëª¨ë¦¬ ì •ë¦¬
    import gc
    gc.collect()
    print("[DEBUG] í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
    
    # í˜„ì¬ í™”ë©´ì´ ìˆìœ¼ë©´ ì²˜ë¦¬
    if self.current_screen and self.current_screen_name:
        # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ
        if self.current_screen_name == 'startup':
            print(f"[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ: {self.current_screen_name}")
            try:
                self.delete_screen('startup')
                # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ (ì¤‘ìš”!)
                self.current_screen_name = None
                self.current_screen = None
                print("[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì™„ë£Œ")
            except Exception as e:
                print(f"[WARN] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹¤íŒ¨: {e}")
        else:
            # ë‹¤ë¥¸ í™”ë©´ì€ ìˆ¨ê¸°ê¸°ë§Œ
            self.current_screen.hide()
    
    # ìƒˆ í™”ë©´ ìƒì„± ë° ì „í™˜
    if screen_name not in self.screens:
        # ìƒˆ í™”ë©´ ë™ì  ìƒì„±
        self._create_screen_directly(screen_name, **kwargs)
    
    # ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
    self.current_screen_name = screen_name
    self.current_screen = self.screens[screen_name]
    self.current_screen.show()
    
    print(f"[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: {screen_name}")
    return True
```

### **ë¬¸ì œ ì›ì¸ ìƒì„¸ ë¶„ì„**

#### **ì°¸ì¡° ì •ë¦¬ ëˆ„ë½**
- **ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ**: `delete_screen('startup')` í˜¸ì¶œë¡œ í™”ë©´ ê°ì²´ëŠ” ì‚­ì œë¨
- **ì°¸ì¡° ì •ë¦¬ ëˆ„ë½**: `current_screen_name`ê³¼ `current_screen`ì´ ì—¬ì „íˆ 'startup'ì„ ê°€ë¦¬í‚´
- **ë‹¤ìŒ í™”ë©´ ì „í™˜ ì‹¤íŒ¨**: ì°¸ì¡°ê°€ ì •ë¦¬ë˜ì§€ ì•Šì•„ì„œ ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ë˜ì§€ ì•ŠìŒ

#### **í™”ë©´ ì „í™˜ ë¡œì§ ë¬¸ì œ**
- **ì¡°ê±´ ì²´í¬ ì‹¤íŒ¨**: `if self.current_screen and self.current_screen_name:` ì¡°ê±´ì—ì„œ ë¬¸ì œ ë°œìƒ
- **ë¬´í•œ ëŒ€ê¸°**: ì‚­ì œëœ í™”ë©´ ì°¸ì¡°ë¡œ ì¸í•´ í™”ë©´ ì „í™˜ì´ ì§„í–‰ë˜ì§€ ì•ŠìŒ

### **ê°œì„  íš¨ê³¼**

#### **ì™„ì „í•œ í™”ë©´ ì „í™˜**
- **ì°¸ì¡° ì •ë¦¬**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ í›„ ëª¨ë“  ì°¸ì¡°ê°€ ì •ë¦¬ë¨
- **ë‹¤ìŒ í™”ë©´ ì „í™˜**: ì •ë¦¬ëœ ì°¸ì¡°ë¡œ ìƒˆ í™”ë©´ìœ¼ë¡œ ì •ìƒ ì „í™˜
- **ë©”ëª¨ë¦¬ í™•ë³´**: 18KB ë©”ëª¨ë¦¬ê°€ í™•ë³´ë˜ê³  ë‹¤ìŒ í™”ë©´ì´ ì •ìƒ ë™ì‘

#### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ: startup
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...
[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
ğŸ§¹ startup í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ ë™ì  ìƒì„± ì¤‘...
[OK] wifi_scan í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

**ê²°ê³¼**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ í›„ ë©ˆì¶¤ ë¬¸ì œê°€ í•´ê²°ë˜ê³  ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì •ìƒ ì „í™˜ë©ë‹ˆë‹¤.

---

## ğŸš¨ í™”ë©´ ì „í™˜ ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€

### **ë¬¸ì œ ìƒí™©**
```
ğŸ§¹ startup í™”ë©´ ì •ë¦¬ ì™„ë£Œ
# ì•ˆë„˜ì•„ê° - ì–´ë””ì„œ ë©ˆì¶”ëŠ”ì§€ í™•ì¸ í•„ìš”
```

### **í•´ê²° ë°©ë²•: ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€**

#### **í™”ë©´ ì „í™˜ ê³¼ì • ìƒì„¸ ë¡œê·¸ ì¶”ê°€**
```python
# ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
print(f"[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: {screen_name}")
self.current_screen_name = screen_name
print(f"[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: {self.current_screen_name}")
self.current_screen = self.screens[screen_name]
print(f"[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: {self.current_screen}")
print(f"[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...")
self.current_screen.show()
print(f"[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ")

print(f"[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: {screen_name}")
return True
```

### **ë””ë²„ê·¸ ë¡œê·¸ì˜ ëª©ì **

#### **ë¬¸ì œ ìœ„ì¹˜ íŒŒì•…**
- **í™”ë©´ ì „í™˜ ì‹œì‘**: ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ê³¼ì •ì´ ì‹œì‘ë˜ëŠ”ì§€ í™•ì¸
- **ì°¸ì¡° ì„¤ì •**: `current_screen_name`ê³¼ `current_screen` ì„¤ì •ì´ ì™„ë£Œë˜ëŠ”ì§€ í™•ì¸
- **í™”ë©´ í‘œì‹œ**: `show()` ë©”ì„œë“œ í˜¸ì¶œì´ ì™„ë£Œë˜ëŠ”ì§€ í™•ì¸
- **ì „í™˜ ì™„ë£Œ**: í™”ë©´ ì „í™˜ì´ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ëŠ”ì§€ í™•ì¸

#### **ì˜ˆìƒ ë””ë²„ê·¸ ì¶œë ¥**
```
ğŸ§¹ startup í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ ë™ì  ìƒì„± ì¤‘...
[OK] wifi_scan í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

### **ë¬¸ì œ ì§„ë‹¨**

#### **ê°€ëŠ¥í•œ ë¬¸ì œì ë“¤**
1. **í™”ë©´ ìƒì„± ì‹¤íŒ¨**: `wifi_scan` í™”ë©´ì´ ìƒì„±ë˜ì§€ ì•ŠìŒ
2. **ì°¸ì¡° ì„¤ì • ì‹¤íŒ¨**: `current_screen` ì„¤ì • ê³¼ì •ì—ì„œ ë¬¸ì œ ë°œìƒ
3. **show() ë©”ì„œë“œ ì‹¤íŒ¨**: `show()` ë©”ì„œë“œ í˜¸ì¶œì—ì„œ ë©ˆì¶¤
4. **í™”ë©´ ì´ˆê¸°í™” ì‹¤íŒ¨**: ìƒˆ í™”ë©´ì˜ ì´ˆê¸°í™” ê³¼ì •ì—ì„œ ë¬¸ì œ ë°œìƒ

#### **ë””ë²„ê·¸ ë¡œê·¸ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒ**
- **ì •í™•í•œ ë©ˆì¶¤ ì§€ì **: ì–´ëŠ ë‹¨ê³„ì—ì„œ ë©ˆì¶”ëŠ”ì§€ ì •í™•íˆ íŒŒì•…
- **ê°ì²´ ìƒíƒœ**: í™”ë©´ ê°ì²´ê°€ ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ê³  ì„¤ì •ë˜ëŠ”ì§€ í™•ì¸
- **ë©”ì„œë“œ í˜¸ì¶œ**: ê° ë©”ì„œë“œ í˜¸ì¶œì´ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ëŠ”ì§€ í™•ì¸

**ê²°ê³¼**: ë””ë²„ê·¸ ë¡œê·¸ë¥¼ í†µí•´ ì •í™•í•œ ë¬¸ì œ ìœ„ì¹˜ë¥¼ íŒŒì•…í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ cleanup() í˜¸ì¶œ ëˆ„ë½ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
ğŸ§¹ startup í™”ë©´ ì •ë¦¬ ì™„ë£Œ
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - show_screen() í˜¸ì¶œë˜ì§€ ì•ŠìŒ
```

### **ì›ì¸ ë¶„ì„**
ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ `cleanup()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³  ë°”ë¡œ `show_screen('wifi_scan')`ì„ í˜¸ì¶œí•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤. `cleanup()` ë©”ì„œë“œê°€ ì •ì˜ë˜ì–´ ìˆì§€ë§Œ ì‹¤ì œë¡œ í˜¸ì¶œë˜ì§€ ì•Šì•„ì„œ ë©”ëª¨ë¦¬ ì •ë¦¬ê°€ ë˜ì§€ ì•Šê³  ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì¶”ê°€**
```python
# ìˆ˜ì • ì „: cleanup() í˜¸ì¶œ ì—†ì´ ë°”ë¡œ show_screen() í˜¸ì¶œ
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ - ScreenManagerê°€ ì™„ì „ ì‚­ì œ ì²˜ë¦¬")
self.screen_manager.show_screen('wifi_scan')

# ìˆ˜ì • í›„: cleanup() í˜¸ì¶œ í›„ show_screen() í˜¸ì¶œ
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ - ScreenManagerê°€ ì™„ì „ ì‚­ì œ ì²˜ë¦¬")

# ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì‹œì‘...")
self.cleanup()
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")

# ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜
print("[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘...")
self.screen_manager.show_screen('wifi_scan')
```

#### **2. ë‹¨ê³„ë³„ ë¡œê·¸ ì¶”ê°€**
```python
def _auto_advance_to_next_screen(self):
    """ìë™ìœ¼ë¡œ ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜"""
    try:
        # wifi_scan í™”ë©´ì´ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        if 'wifi_scan' not in self.screen_manager.screens:
            # wifi_scan í™”ë©´ ìƒì„±
            self._create_wifi_scan_screen()
        
        # í™”ë©´ ì „í™˜ (ScreenManagerê°€ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ ì²˜ë¦¬)
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ - ScreenManagerê°€ ì™„ì „ ì‚­ì œ ì²˜ë¦¬")
        
        # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì‹œì‘...")
        self.cleanup()
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")
        
        # ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜
        print("[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘...")
        self.screen_manager.show_screen('wifi_scan')
        
    except Exception as e:
        print(f"[ERROR] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

### **ë¬¸ì œ ì›ì¸ ìƒì„¸ ë¶„ì„**

#### **cleanup() ë©”ì„œë“œ í˜¸ì¶œ ëˆ„ë½**
- **ì •ì˜ëŠ” ìˆìŒ**: `cleanup()` ë©”ì„œë“œê°€ ì •ì˜ë˜ì–´ ìˆìŒ
- **í˜¸ì¶œ ëˆ„ë½**: ì‹¤ì œë¡œ í˜¸ì¶œí•˜ëŠ” ì½”ë“œê°€ ì—†ìŒ
- **ë©”ëª¨ë¦¬ ì •ë¦¬ ì•ˆë¨**: 18KB ë©”ëª¨ë¦¬ê°€ ì •ë¦¬ë˜ì§€ ì•ŠìŒ
- **í™”ë©´ ì „í™˜ ì‹¤íŒ¨**: ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ë‹¤ìŒ í™”ë©´ ì „í™˜ ì‹¤íŒ¨

#### **í™”ë©´ ì „í™˜ ë¡œì§ ë¬¸ì œ**
- **ì§ì ‘ ì „í™˜**: `cleanup()` ì—†ì´ ë°”ë¡œ `show_screen()` í˜¸ì¶œ
- **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë¦¬ì†ŒìŠ¤ê°€ ì •ë¦¬ë˜ì§€ ì•ŠìŒ
- **ì „í™˜ ì‹¤íŒ¨**: ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ í™”ë©´ ì „í™˜ ì‹¤íŒ¨

### **ê°œì„  íš¨ê³¼**

#### **ì™„ì „í•œ ë©”ëª¨ë¦¬ ì •ë¦¬**
- **cleanup() í˜¸ì¶œ**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì˜ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ì •ë¦¬ë¨
- **18KB ë©”ëª¨ë¦¬ í™•ë³´**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œë¡œ ë©”ëª¨ë¦¬ í™•ë³´
- **ì•ˆì „í•œ í™”ë©´ ì „í™˜**: ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ë¡œ ë‹¤ìŒ í™”ë©´ ì „í™˜ ì„±ê³µ

#### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ - ScreenManagerê°€ ì™„ì „ ì‚­ì œ ì²˜ë¦¬
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì‹œì‘...
[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[OK] ëª¨ë“  LVGL ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...
[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘...
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

**ê²°ê³¼**: cleanup() ë©”ì„œë“œ í˜¸ì¶œ ëˆ„ë½ ë¬¸ì œê°€ í•´ê²°ë˜ê³  ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì´ ì™„ì „íˆ ì •ë¦¬ëœ í›„ ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.

---

## ğŸš¨ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì°¸ì¡° ì •ë¦¬ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘...
[DEBUG] í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
# ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ì •ì§€
```

### **ì›ì¸ ë¶„ì„**
`cleanup()` ë©”ì„œë“œëŠ” í˜¸ì¶œë˜ì—ˆì§€ë§Œ, `ScreenManager`ì˜ `current_screen_name`ê³¼ `current_screen` ì°¸ì¡°ê°€ ì—¬ì „íˆ 'startup'ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì„œ `show_screen` ë©”ì„œë“œì—ì„œ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ë¡œì§ì´ ë‹¤ì‹œ ì‹¤í–‰ë˜ë ¤ê³  í•˜ë©´ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì¶”ê°€**
```python
# ìˆ˜ì • ì „: cleanup() í›„ ë°”ë¡œ show_screen() í˜¸ì¶œ
self.cleanup()
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")
self.screen_manager.show_screen('wifi_scan')

# ìˆ˜ì • í›„: cleanup() í›„ ì°¸ì¡° ì •ë¦¬ í›„ show_screen() í˜¸ì¶œ
self.cleanup()
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")

# í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ (ì¤‘ìš”!)
self.screen_manager.current_screen_name = None
self.screen_manager.current_screen = None
print("[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")

self.screen_manager.show_screen('wifi_scan')
```

#### **2. ì°¸ì¡° ì •ë¦¬ì˜ ì¤‘ìš”ì„±**
```python
def _auto_advance_to_next_screen(self):
    """ìë™ìœ¼ë¡œ ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜"""
    try:
        # wifi_scan í™”ë©´ ìƒì„±
        if 'wifi_scan' not in self.screen_manager.screens:
            self._create_wifi_scan_screen()
        
        # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì‹œì‘...")
        self.cleanup()
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")
        
        # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ (ì¤‘ìš”!)
        self.screen_manager.current_screen_name = None
        self.screen_manager.current_screen = None
        print("[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜
        print("[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘...")
        self.screen_manager.show_screen('wifi_scan')
        
    except Exception as e:
        print(f"[ERROR] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

### **ë¬¸ì œ ì›ì¸ ìƒì„¸ ë¶„ì„**

#### **ì°¸ì¡° ì •ë¦¬ ëˆ„ë½**
- **cleanup() ì™„ë£Œ**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë¦¬ì†ŒìŠ¤ëŠ” ì •ë¦¬ë¨
- **ì°¸ì¡° ì •ë¦¬ ëˆ„ë½**: `current_screen_name`ê³¼ `current_screen`ì´ ì—¬ì „íˆ 'startup'ì„ ê°€ë¦¬í‚´
- **ì¤‘ë³µ ì‚­ì œ ì‹œë„**: `show_screen`ì—ì„œ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ë¡œì§ì´ ë‹¤ì‹œ ì‹¤í–‰ë¨
- **ë¬´í•œ ëŒ€ê¸°**: ì´ë¯¸ ì‚­ì œëœ í™”ë©´ì„ ë‹¤ì‹œ ì‚­ì œí•˜ë ¤ê³  í•˜ë©´ì„œ ë©ˆì¶¤

#### **í™”ë©´ ì „í™˜ ë¡œì§ ë¬¸ì œ**
- **ì¡°ê±´ ì²´í¬**: `if self.current_screen_name == 'startup'` ì¡°ê±´ì´ ì—¬ì „íˆ ì°¸
- **ì‚­ì œ ì¬ì‹œë„**: ì´ë¯¸ ì‚­ì œëœ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì„ ë‹¤ì‹œ ì‚­ì œí•˜ë ¤ê³  í•¨
- **ì „í™˜ ì‹¤íŒ¨**: ì‚­ì œ ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ í™”ë©´ ì „í™˜ì´ ë©ˆì¶¤

### **ê°œì„  íš¨ê³¼**

#### **ì™„ì „í•œ ì°¸ì¡° ì •ë¦¬**
- **ì°¸ì¡° ì •ë¦¬**: `current_screen_name`ê³¼ `current_screen`ì´ `None`ìœ¼ë¡œ ì„¤ì •ë¨
- **ì¤‘ë³µ ì‚­ì œ ë°©ì§€**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ë¡œì§ì´ ë‹¤ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
- **ì•ˆì „í•œ í™”ë©´ ì „í™˜**: ì •ë¦¬ëœ ì°¸ì¡°ë¡œ ìƒˆ í™”ë©´ìœ¼ë¡œ ì •ìƒ ì „í™˜

#### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘...
[DEBUG] í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ ë™ì  ìƒì„± ì¤‘...
[OK] wifi_scan í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

**ê²°ê³¼**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì°¸ì¡° ì •ë¦¬ ë¬¸ì œê°€ í•´ê²°ë˜ê³  ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì •ìƒ ì „í™˜ë©ë‹ˆë‹¤.

---

## ğŸš¨ delete_async() í›„ ì¦‰ì‹œ í™”ë©´ ì „í™˜ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘...
[DEBUG] í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
# ì•„ë¬´ ë¡œê·¸ ì—†ì´ ë©ˆì¶¤ - LVGL ë£¨í”„ ì •ì§€
```

### **ì›ì¸ ë¶„ì„**
LVGLì˜ `delete_async()`ëŠ” ë¹„ë™ê¸° ì‚­ì œ ì˜ˆì•½ì´ê¸° ë•Œë¬¸ì—, ì‹¤ì œ ê°ì²´ê°€ ì™„ì „íˆ í•´ì œë˜ê¸° ì „ì— ë°”ë¡œ ë‹¤ìŒ í™”ë©´ì„ ë„ìš°ë©´ LVGL ë‚´ë¶€ì—ì„œ ì¶©ëŒì´ ë°œìƒí•©ë‹ˆë‹¤.

#### **3ê°€ì§€ ê°€ëŠ¥í•œ ì›ì¸:**
1. **delete_async() ì´í›„ ì¦‰ì‹œ ë‹¤ìŒ í™”ë©´ì„ ë„ì›€**: LVGL ë‚´ë¶€ì—ì„œ ì¶©ëŒ ë°œìƒ
2. **gc.collect()ê°€ ë„ˆë¬´ ì¼ì° í˜¸ì¶œë¨**: ì•„ì§ LVGLì´ ì°¸ì¡° ì¤‘ì¸ ê°ì²´ë¥¼ íšŒìˆ˜í•˜ë ¤ë‹¤ ì¶©ëŒ
3. **ScreenManagerê°€ ì´ë¯¸ ì‚­ì œëœ ìƒíƒœì—ì„œ ì ‘ê·¼**: Manager ì¸ìŠ¤í„´ìŠ¤ ìì²´ê°€ ì œê±°ë¨

### **í•´ê²° ë°©ë²•**

#### **1. ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë£¨í‹´ êµ¬í˜„**
```python
def _safe_transition_to_next_screen(self, next_screen_name):
    """ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë£¨í‹´ - delete_async() í›„ ëŒ€ê¸°"""
    def load_next_screen(timer):
        """LVGL íƒ€ì´ë¨¸ ì½œë°±ìœ¼ë¡œ ì•ˆì „í•œ í™”ë©´ ì „í™˜"""
        try:
            print(f"[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: {next_screen_name}")
            self.screen_manager.show_screen(next_screen_name)
            print(f"[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: {next_screen_name}")
            
            # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
            import gc
            gc.collect()
            print("[OK] ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
            
        except Exception as e:
            print(f"[ERROR] í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
    
    # 200ms í›„ì— ì•ˆì „í•˜ê²Œ í™”ë©´ ì „í™˜
    import lvgl as lv
    lv.timer_create(load_next_screen, 200, None)
    print("[INFO] í™”ë©´ ì „í™˜ íƒ€ì´ë¨¸ ì„¤ì • ì™„ë£Œ (200ms í›„ ì‹¤í–‰)")
```

#### **2. ì˜ëª»ëœ ì˜ˆì‹œ vs ì˜¬ë°”ë¥¸ ì˜ˆì‹œ**
```python
# âŒ ì˜ëª»ëœ ì˜ˆì‹œ - ë„ˆë¬´ ë¹¨ë¼ì„œ ì¶©ëŒ
startup_screen.delete_async()
screen_manager.show("wifi_scan")  # â† ì¦‰ì‹œ ì‹¤í–‰í•˜ë©´ ì¶©ëŒ

# âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ - íƒ€ì´ë¨¸ë¥¼ ì‚¬ìš©í•œ ì•ˆì „í•œ ì „í™˜
startup_screen.delete_async()

# LVGL ì´ë²¤íŠ¸ ë£¨í”„ í•œ í‹± í›„ ì‹¤í–‰
lv.timer_create(lambda t: screen_manager.show("wifi_scan"), 200, None)
```

#### **3. ê°œì„ ëœ í™”ë©´ ì „í™˜ ë¡œì§**
```python
def _auto_advance_to_next_screen(self):
    """ìë™ìœ¼ë¡œ ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜"""
    try:
        # wifi_scan í™”ë©´ì´ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        if 'wifi_scan' not in self.screen_manager.screens:
            self._create_wifi_scan_screen()
        
        # ì•ˆì „í•œ í™”ë©´ ì „í™˜ (delete_async() í›„ ëŒ€ê¸°)
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì‹œì‘...")
        self.cleanup()
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")
        
        # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬
        self.screen_manager.current_screen_name = None
        self.screen_manager.current_screen = None
        print("[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # LVGL íƒ€ì´ë¨¸ë¥¼ ì‚¬ìš©í•œ ì•ˆì „í•œ í™”ë©´ ì „í™˜
        print("[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì˜ˆì•½...")
        self._safe_transition_to_next_screen('wifi_scan')
        
    except Exception as e:
        print(f"[ERROR] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

### **LVGL íƒ€ì´ë¨¸ ì‚¬ìš©ì˜ ì¤‘ìš”ì„±**

#### **lv.timer_create()ì˜ ì—­í• **
- **ë¹„ë™ê¸° ì‹¤í–‰**: LVGL ì´ë²¤íŠ¸ ë£¨í”„ì—ì„œ ì•ˆì „í•˜ê²Œ ì‹¤í–‰
- **ì¶©ëŒ ë°©ì§€**: `delete_async()` ì™„ë£Œ í›„ í™”ë©´ ì „í™˜
- **ì•ˆì •ì„±**: LVGL ë‚´ë¶€ ìƒíƒœì™€ ë™ê¸°í™”ëœ ì‹¤í–‰

#### **200ms ì§€ì—°ì˜ ì´ìœ **
- **ì‚­ì œ ì™„ë£Œ ëŒ€ê¸°**: `delete_async()`ê°€ ì™„ì „íˆ ì²˜ë¦¬ë  ì‹œê°„ í™•ë³´
- **ë©”ëª¨ë¦¬ ì •ë¦¬**: LVGL ë‚´ë¶€ì—ì„œ ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì‹œê°„
- **ì•ˆì •ì„±**: ì¶©ëŒ ì—†ì´ ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë³´ì¥

### **ê°œì„  íš¨ê³¼**

#### **ì•ˆì „í•œ í™”ë©´ ì „í™˜**
- **ì¶©ëŒ ë°©ì§€**: LVGL ë‚´ë¶€ ì¶©ëŒì´ ë°œìƒí•˜ì§€ ì•ŠìŒ
- **ì•ˆì •ì„±**: í™”ë©´ ì „í™˜ì´ ì•ˆì „í•˜ê²Œ ì™„ë£Œë¨
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: 18KB ë©”ëª¨ë¦¬ê°€ ì•ˆì „í•˜ê²Œ í™•ë³´ë¨

#### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì˜ˆì•½...
[INFO] í™”ë©´ ì „í™˜ íƒ€ì´ë¨¸ ì„¤ì • ì™„ë£Œ (200ms í›„ ì‹¤í–‰)
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: delete_async() í›„ ì¦‰ì‹œ í™”ë©´ ì „í™˜ ë¬¸ì œê°€ í•´ê²°ë˜ê³  LVGL íƒ€ì´ë¨¸ë¥¼ ì‚¬ìš©í•œ ì•ˆì „í•œ í™”ë©´ ì „í™˜ì´ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ LVGL íƒ€ì´ë¨¸ ì‹¤íŒ¨ - ê°„ë‹¨í•œ ì§€ì—° ë°©ì‹ìœ¼ë¡œ ëŒ€ì²´

### **ë¬¸ì œ ìƒí™©**
```
[INFO] í™”ë©´ ì „í™˜ íƒ€ì´ë¨¸ ì„¤ì • ì™„ë£Œ (200ms í›„ ì‹¤í–‰)
# LVGL íƒ€ì´ë¨¸ê°€ ì‘ë™í•˜ì§€ ì•Šì•„ í™”ë©´ ì „í™˜ì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
```

### **ì›ì¸ ë¶„ì„**
LVGL íƒ€ì´ë¨¸(`lv.timer_create()`)ê°€ ì˜ˆìƒëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ  ë•Œë¬¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **LVGL ì´ˆê¸°í™” ë¬¸ì œ**: LVGLì´ ì™„ì „íˆ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ì„ ë•Œ
2. **íƒ€ì´ë¨¸ ì»¨í…ìŠ¤íŠ¸ ë¬¸ì œ**: ì˜ëª»ëœ ì»¨í…ìŠ¤íŠ¸ì—ì„œ íƒ€ì´ë¨¸ ìƒì„±
3. **ë©”ëª¨ë¦¬ ë¶€ì¡±**: íƒ€ì´ë¨¸ ìƒì„±ì— í•„ìš”í•œ ë©”ëª¨ë¦¬ ë¶€ì¡±

### **í•´ê²° ë°©ë²•: ê°„ë‹¨í•œ ì§€ì—° ë°©ì‹**

#### **1. time.sleep()ì„ ì‚¬ìš©í•œ ì•ˆì „í•œ í™”ë©´ ì „í™˜**
```python
def _safe_transition_with_delay(self, next_screen_name):
    """ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë£¨í‹´ - ê°„ë‹¨í•œ ì§€ì—° ë°©ì‹"""
    try:
        print(f"[INFO] í™”ë©´ ì „í™˜ ì§€ì—° ì‹œì‘ (300ms)...")
        import time
        time.sleep(0.3)  # 300ms ì§€ì—°
        
        print(f"[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: {next_screen_name}")
        self.screen_manager.show_screen(next_screen_name)
        print(f"[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: {next_screen_name}")
        
        # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
        import gc
        gc.collect()
        print("[OK] ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

#### **2. ê°œì„ ëœ í™”ë©´ ì „í™˜ ë¡œì§**
```python
def _auto_advance_to_next_screen(self):
    """ìë™ìœ¼ë¡œ ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜"""
    try:
        # wifi_scan í™”ë©´ì´ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        if 'wifi_scan' not in self.screen_manager.screens:
            self._create_wifi_scan_screen()
        
        # ì•ˆì „í•œ í™”ë©´ ì „í™˜ (ê°„ë‹¨í•œ ì§€ì—° ë°©ì‹)
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì‹œì‘...")
        self.cleanup()
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")
        
        # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬
        self.screen_manager.current_screen_name = None
        self.screen_manager.current_screen = None
        print("[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # ì•ˆì „í•œ í™”ë©´ ì „í™˜ (ê°„ë‹¨í•œ ì§€ì—° ë°©ì‹)
        print("[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...")
        self._safe_transition_with_delay('wifi_scan')
        
    except Exception as e:
        print(f"[ERROR] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

### **ê°„ë‹¨í•œ ì§€ì—° ë°©ì‹ì˜ ì¥ì **

#### **ì•ˆì •ì„±**
- **í™•ì‹¤í•œ ì§€ì—°**: `time.sleep()`ì€ í™•ì‹¤í•˜ê²Œ ì§€ì—°ì„ ë³´ì¥
- **ë‹¨ìˆœí•¨**: ë³µì¡í•œ íƒ€ì´ë¨¸ ë¡œì§ ì—†ì´ ê°„ë‹¨í•œ êµ¬í˜„
- **í˜¸í™˜ì„±**: ëª¨ë“  í™˜ê²½ì—ì„œ ë™ì¼í•˜ê²Œ ì‘ë™

#### **ë©”ëª¨ë¦¬ íš¨ìœ¨**
- **ì¶”ê°€ ë©”ëª¨ë¦¬ ë¶ˆí•„ìš”**: íƒ€ì´ë¨¸ ê°ì²´ ìƒì„± ë¶ˆí•„ìš”
- **ê°„ë‹¨í•œ êµ¬ì¡°**: ë³µì¡í•œ ì½œë°± í•¨ìˆ˜ ë¶ˆí•„ìš”
- **ì§ì ‘ì  ì‹¤í–‰**: ì§€ì—° í›„ ë°”ë¡œ í™”ë©´ ì „í™˜ ì‹¤í–‰

### **300ms ì§€ì—°ì˜ ì´ìœ **

#### **ì¶©ë¶„í•œ ëŒ€ê¸° ì‹œê°„**
- **delete_async() ì™„ë£Œ**: LVGL ë¹„ë™ê¸° ì‚­ì œê°€ ì™„ì „íˆ ì²˜ë¦¬ë  ì‹œê°„
- **ë©”ëª¨ë¦¬ ì •ë¦¬**: LVGL ë‚´ë¶€ì—ì„œ ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì‹œê°„
- **ì•ˆì •ì„±**: ì¶©ëŒ ì—†ì´ ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë³´ì¥

### **ê°œì„  íš¨ê³¼**

#### **ì•ˆì „í•œ í™”ë©´ ì „í™˜**
- **ì¶©ëŒ ë°©ì§€**: LVGL ë‚´ë¶€ ì¶©ëŒì´ ë°œìƒí•˜ì§€ ì•ŠìŒ
- **ì•ˆì •ì„±**: í™”ë©´ ì „í™˜ì´ ì•ˆì „í•˜ê²Œ ì™„ë£Œë¨
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: 18KB ë©”ëª¨ë¦¬ê°€ ì•ˆì „í•˜ê²Œ í™•ë³´ë¨

#### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
[INFO] í™”ë©´ ì „í™˜ ì§€ì—° ì‹œì‘ (300ms)...
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: LVGL íƒ€ì´ë¨¸ ì‹¤íŒ¨ ë¬¸ì œê°€ í•´ê²°ë˜ê³  ê°„ë‹¨í•œ ì§€ì—° ë°©ì‹ì„ ì‚¬ìš©í•œ ì•ˆì „í•œ í™”ë©´ ì „í™˜ì´ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ time.sleep() ë¸”ë¡œí‚¹ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[INFO] í™”ë©´ ì „í™˜ ì§€ì—° ì‹œì‘ (300ms)...
# í™”ë©´ ë©ˆì¶¤ - time.sleep()ì´ ì‹œìŠ¤í…œì„ ë¸”ë¡œí‚¹
```

### **ì›ì¸ ë¶„ì„**
`time.sleep(0.3)`ì´ 300ms ë™ì•ˆ ì‹œìŠ¤í…œì„ ë¸”ë¡œí‚¹í•˜ì—¬ LVGL ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì¤‘ë‹¨ë˜ê³  í™”ë©´ì´ ë©ˆì¶”ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•: ì§ì ‘ í™”ë©´ ì „í™˜**

#### **1. time.sleep() ì œê±° ë° ì§ì ‘ í™”ë©´ ì „í™˜**
```python
def _safe_transition_with_delay(self, next_screen_name):
    """ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë£¨í‹´ - LVGL ì´ë²¤íŠ¸ ë£¨í”„ ì‚¬ìš©"""
    try:
        print(f"[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: {next_screen_name}")
        self.screen_manager.show_screen(next_screen_name)
        print(f"[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: {next_screen_name}")
        
        # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ (ì¤‘ìš”!)
        import gc
        gc.collect()
        print("[OK] ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

#### **2. í™”ë©´ ì „í™˜ í›„ gc.collect() í˜¸ì¶œì˜ ì¤‘ìš”ì„±**
```python
# í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ (ì¤‘ìš”!)
import gc
gc.collect()
print("[OK] ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
```

### **time.sleep() ë¸”ë¡œí‚¹ ë¬¸ì œ**

#### **ë¬¸ì œì **
- **ì‹œìŠ¤í…œ ë¸”ë¡œí‚¹**: `time.sleep()`ì´ ì „ì²´ ì‹œìŠ¤í…œì„ ë¸”ë¡œí‚¹
- **LVGL ë£¨í”„ ì¤‘ë‹¨**: LVGL ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì¤‘ë‹¨ë¨
- **í™”ë©´ ë©ˆì¶¤**: ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ê°€ ì‘ë‹µí•˜ì§€ ì•ŠìŒ

#### **í•´ê²°ì±…**
- **ë¸”ë¡œí‚¹ ì œê±°**: `time.sleep()` ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
- **ì§ì ‘ ì „í™˜**: `delete_async()` ì™„ë£Œ í›„ ë°”ë¡œ í™”ë©´ ì „í™˜
- **ë©”ëª¨ë¦¬ ì •ë¦¬**: í™”ë©´ ì „í™˜ í›„ `gc.collect()` í˜¸ì¶œ

### **í™”ë©´ ì „í™˜ í›„ gc.collect()ì˜ ì¤‘ìš”ì„±**

#### **ë©”ëª¨ë¦¬ ì •ë¦¬ íƒ€ì´ë°**
- **í™”ë©´ ì „í™˜ ì™„ë£Œ í›„**: ìƒˆ í™”ë©´ì´ ì™„ì „íˆ ë¡œë“œëœ í›„
- **ì•ˆì „í•œ ë©”ëª¨ë¦¬ ì •ë¦¬**: LVGL ê°ì²´ ìƒì„± ì™„ë£Œ í›„
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: 18KB ë©”ëª¨ë¦¬ê°€ ì•ˆì „í•˜ê²Œ í™•ë³´ë¨

### **ê°œì„  íš¨ê³¼**

#### **ì‹œìŠ¤í…œ ì•ˆì •ì„±**
- **ë¸”ë¡œí‚¹ ì œê±°**: ì‹œìŠ¤í…œì´ ë©ˆì¶”ì§€ ì•ŠìŒ
- **LVGL ë£¨í”„ ìœ ì§€**: ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì •ìƒ ì‘ë™
- **í™”ë©´ ì‘ë‹µì„±**: ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ê°€ ì •ìƒ ì‘ë‹µ

#### **ë©”ëª¨ë¦¬ íš¨ìœ¨**
- **ì•ˆì „í•œ ì •ë¦¬**: í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
- **ì¶©ëŒ ë°©ì§€**: LVGL ê°ì²´ ìƒì„± ì™„ë£Œ í›„ ì •ë¦¬
- **íš¨ìœ¨ì„±**: 18KB ë©”ëª¨ë¦¬ê°€ ì•ˆì „í•˜ê²Œ í™•ë³´

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ ê°±ì‹  ì‹œì‘...
[DEBUG] í™”ë©´ ê°±ì‹  ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
```

**ê²°ê³¼**: time.sleep() ë¸”ë¡œí‚¹ ë¬¸ì œê°€ í•´ê²°ë˜ê³  í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ê°€ ì˜¬ë°”ë¥´ê²Œ ìˆ˜í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ë¡œ ìˆ˜ì •

### **ë¬¸ì œ ìƒí™©**
```
[DEBUG] í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
# í™”ë©´ ì „í™˜ ì „ì— ë©”ëª¨ë¦¬ ì •ë¦¬ë¥¼ í•˜ê³  ìˆìŒ
```

### **ì›ì¸ ë¶„ì„**
í™”ë©´ ì „í™˜ ì „ì— ë©”ëª¨ë¦¬ ì •ë¦¬ë¥¼ í•˜ë©´ ìƒˆ í™”ë©´ ìƒì„± ì‹œ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë©”ëª¨ë¦¬ ì •ë¦¬ëŠ” í™”ë©´ ì „í™˜ì´ ì™„ë£Œëœ í›„ì— í•´ì•¼ í•©ë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì œê±°**
```python
# ìˆ˜ì • ì „: í™”ë©´ ì „í™˜ ì „ì— ë©”ëª¨ë¦¬ ì •ë¦¬
def show_screen(self, screen_name, add_to_stack=True, **kwargs):
    """í™”ë©´ ì „í™˜ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ"""
    # ë©”ëª¨ë¦¬ ì •ë¦¬
    import gc
    gc.collect()
    print("[DEBUG] í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")

# ìˆ˜ì • í›„: í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ ì œê±°
def show_screen(self, screen_name, add_to_stack=True, **kwargs):
    """í™”ë©´ ì „í™˜ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ"""
```

#### **2. í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì¶”ê°€**
```python
def show_screen(self, screen_name, add_to_stack=True, **kwargs):
    """í™”ë©´ ì „í™˜ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ"""
    # ... í™”ë©´ ì „í™˜ ë¡œì§ ...
    
    # ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
    print(f"[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: {screen_name}")
    self.current_screen_name = screen_name
    print(f"[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: {self.current_screen_name}")
    self.current_screen = self.screens[screen_name]
    print(f"[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: {self.current_screen}")
    print(f"[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...")
    self.current_screen.show()
    print(f"[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ")
    
    # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
    import gc
    gc.collect()
    print("[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
    
    print(f"[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: {screen_name}")
    return True
```

#### **3. ì¤‘ë³µ ë©”ëª¨ë¦¬ ì •ë¦¬ ì œê±°**
```python
# startup_screen.pyì—ì„œ ì¤‘ë³µëœ ë©”ëª¨ë¦¬ ì •ë¦¬ ì œê±°
def _safe_transition_with_delay(self, next_screen_name):
    """ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë£¨í‹´ - LVGL ì´ë²¤íŠ¸ ë£¨í”„ ì‚¬ìš©"""
    try:
        print(f"[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: {next_screen_name}")
        self.screen_manager.show_screen(next_screen_name)
        print(f"[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: {next_screen_name}")
        
        # ì¤‘ë³µëœ ë©”ëª¨ë¦¬ ì •ë¦¬ ì œê±° (ScreenManagerì—ì„œ ì²˜ë¦¬)
        
    except Exception as e:
        print(f"[ERROR] í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

### **ë©”ëª¨ë¦¬ ì •ë¦¬ íƒ€ì´ë°ì˜ ì¤‘ìš”ì„±**

#### **í™”ë©´ ì „í™˜ ì „ ë©”ëª¨ë¦¬ ì •ë¦¬ì˜ ë¬¸ì œì **
- **ë©”ëª¨ë¦¬ ë¶€ì¡±**: ìƒˆ í™”ë©´ ìƒì„± ì‹œ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•  ìˆ˜ ìˆìŒ
- **ìƒì„± ì‹¤íŒ¨**: í™”ë©´ ê°ì²´ ìƒì„±ì´ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒ
- **ë¹„íš¨ìœ¨ì„±**: í•„ìš”í•œ ë©”ëª¨ë¦¬ë¥¼ ë¯¸ë¦¬ ì •ë¦¬í•´ë²„ë¦¼

#### **í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ì˜ ì¥ì **
- **ì•ˆì „í•œ ìƒì„±**: ìƒˆ í™”ë©´ì´ ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ë¡œ ìƒì„±ë¨
- **íš¨ìœ¨ì„±**: í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë¶ˆí•„ìš”í•œ ë©”ëª¨ë¦¬ ì •ë¦¬
- **ì•ˆì •ì„±**: í™”ë©´ ì „í™˜ì´ ì•ˆì „í•˜ê²Œ ì™„ë£Œë¨

### **ê°œì„  íš¨ê³¼**

#### **ë©”ëª¨ë¦¬ ê´€ë¦¬ ê°œì„ **
- **ì˜¬ë°”ë¥¸ íƒ€ì´ë°**: í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
- **ì•ˆì „í•œ ìƒì„±**: ìƒˆ í™”ë©´ì´ ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ë¡œ ìƒì„±
- **íš¨ìœ¨ì„±**: 18KB ë©”ëª¨ë¦¬ê°€ ì•ˆì „í•˜ê²Œ í™•ë³´

#### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

**ê²°ê³¼**: í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ë¡œ ìˆ˜ì •ë˜ì–´ ë” ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ ê´€ë¦¬ê°€ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ë¡œì§ ê°œì„ 

### **ë¬¸ì œ ìƒí™©**
```
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ë¡œì§ì—ì„œ ë¬¸ì œ ë°œìƒ
```

### **ì›ì¸ ë¶„ì„**
ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ì´ë¯¸ `current_screen_name`ê³¼ `current_screen`ì„ `None`ìœ¼ë¡œ ì„¤ì •í–ˆëŠ”ë°, `show_screen` ë©”ì„œë“œì—ì„œ ë‹¤ì‹œ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œë¥¼ ì‹œë„í•˜ë©´ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•**

#### **1. í˜„ì¬ í™”ë©´ì´ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬ ì¶”ê°€**
```python
# í˜„ì¬ í™”ë©´ì´ ìˆìœ¼ë©´ ì²˜ë¦¬
if self.current_screen and self.current_screen_name:
    # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ (ì´ë¯¸ ì •ë¦¬ë˜ì§€ ì•Šì€ ê²½ìš°ì—ë§Œ)
    if self.current_screen_name == 'startup':
        print(f"[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ: {self.current_screen_name}")
        try:
            # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ
            self.delete_screen('startup')
            # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬
            self.current_screen_name = None
            self.current_screen = None
            print("[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹¤íŒ¨: {e}")
    else:
        # ë‹¤ë¥¸ í™”ë©´ì€ ìˆ¨ê¸°ê¸°ë§Œ
        print(f"[INFO] í˜„ì¬ í™”ë©´ ìˆ¨ê¹€: {self.current_screen_name}")
        try:
            self.current_screen.hide()
            # ë©”ëª¨ë¦¬ ì •ë¦¬
            import gc
            gc.collect()
            print("[DEBUG] í™”ë©´ ìˆ¨ê¹€ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] í™”ë©´ ìˆ¨ê¹€ ì‹¤íŒ¨: {e}")
else:
    print("[DEBUG] í˜„ì¬ í™”ë©´ì´ ì—†ìŒ - ìƒˆ í™”ë©´ìœ¼ë¡œ ì§ì ‘ ì „í™˜")
```

#### **2. ê°œì„ ëœ í™”ë©´ ì „í™˜ ë¡œì§**
```python
def show_screen(self, screen_name, add_to_stack=True, **kwargs):
    """í™”ë©´ ì „í™˜ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ"""
    
    # í˜„ì¬ í™”ë©´ì´ ìˆìœ¼ë©´ ì²˜ë¦¬
    if self.current_screen and self.current_screen_name:
        # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ë¡œì§
        if self.current_screen_name == 'startup':
            # ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ
            self.delete_screen('startup')
            self.current_screen_name = None
            self.current_screen = None
        else:
            # ë‹¤ë¥¸ í™”ë©´ì€ ìˆ¨ê¸°ê¸°ë§Œ
            self.current_screen.hide()
    else:
        # í˜„ì¬ í™”ë©´ì´ ì—†ëŠ” ê²½ìš° (ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ì´ë¯¸ ì •ë¦¬ë¨)
        print("[DEBUG] í˜„ì¬ í™”ë©´ì´ ì—†ìŒ - ìƒˆ í™”ë©´ìœ¼ë¡œ ì§ì ‘ ì „í™˜")
    
    # ìƒˆ í™”ë©´ ìƒì„± ë° ì „í™˜
    if screen_name not in self.screens:
        self._create_screen_directly(screen_name, **kwargs)
    
    # ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
    self.current_screen_name = screen_name
    self.current_screen = self.screens[screen_name]
    self.current_screen.show()
    
    # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
    import gc
    gc.collect()
    print("[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
    
    print(f"[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: {screen_name}")
    return True
```

### **ë¬¸ì œ ì›ì¸ ìƒì„¸ ë¶„ì„**

#### **ì¤‘ë³µ ì‚­ì œ ì‹œë„**
- **ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ì •ë¦¬**: `current_screen_name = None`, `current_screen = None`
- **show_screenì—ì„œ ì¬ì‚­ì œ**: ì´ë¯¸ ì •ë¦¬ëœ í™”ë©´ì„ ë‹¤ì‹œ ì‚­ì œí•˜ë ¤ê³  ì‹œë„
- **ë¬´í•œ ëŒ€ê¸°**: ì‚­ì œ ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ë©ˆì¶¤

#### **ì¡°ê±´ ì²´í¬ ë¬¸ì œ**
- **None ì²´í¬**: `current_screen`ê³¼ `current_screen_name`ì´ `None`ì¸ì§€ í™•ì¸
- **ì•ˆì „í•œ ì „í™˜**: í˜„ì¬ í™”ë©´ì´ ì—†ëŠ” ê²½ìš° ìƒˆ í™”ë©´ìœ¼ë¡œ ì§ì ‘ ì „í™˜

### **ê°œì„  íš¨ê³¼**

#### **ì•ˆì „í•œ í™”ë©´ ì „í™˜**
- **ì¤‘ë³µ ì‚­ì œ ë°©ì§€**: ì´ë¯¸ ì •ë¦¬ëœ í™”ë©´ì„ ë‹¤ì‹œ ì‚­ì œí•˜ì§€ ì•ŠìŒ
- **ì¡°ê±´ë¶€ ì²˜ë¦¬**: í˜„ì¬ í™”ë©´ ìƒíƒœì— ë”°ë¼ ì ì ˆí•œ ì²˜ë¦¬
- **ì•ˆì •ì„±**: í™”ë©´ ì „í™˜ì´ ì•ˆì „í•˜ê²Œ ì™„ë£Œë¨

#### **ë©”ëª¨ë¦¬ íš¨ìœ¨**
- **ë¶ˆí•„ìš”í•œ ì‚­ì œ ë°©ì§€**: ì´ë¯¸ ì •ë¦¬ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¤ì‹œ ì •ë¦¬í•˜ì§€ ì•ŠìŒ
- **íš¨ìœ¨ì„±**: 18KB ë©”ëª¨ë¦¬ê°€ ì•ˆì „í•˜ê²Œ í™•ë³´ë¨

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] í˜„ì¬ í™”ë©´ì´ ì—†ìŒ - ìƒˆ í™”ë©´ìœ¼ë¡œ ì§ì ‘ ì „í™˜
[INFO] wifi_scan í™”ë©´ ë™ì  ìƒì„± ì¤‘...
[OK] wifi_scan í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[INFO] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

**ê²°ê³¼**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ë¡œì§ì´ ê°œì„ ë˜ì–´ ì¤‘ë³µ ì‚­ì œ ë¬¸ì œê°€ í•´ê²°ë˜ê³  ì•ˆì „í•œ í™”ë©´ ì „í™˜ì´ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ í™”ë©´ ì „í™˜ ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€ (2ì°¨)

### **ë¬¸ì œ ìƒí™©**
```
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - í™”ë©´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ë‹¨ê³„ì—ì„œ ë¬¸ì œ ë°œìƒ
```

### **ì›ì¸ ë¶„ì„**
í™”ë©´ ì „í™˜ì´ ì‹œì‘ë˜ì—ˆì§€ë§Œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. í™”ë©´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ë‹¨ê³„ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•: ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€**

#### **í™”ë©´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ë‹¨ê³„ ë¡œê·¸ ì¶”ê°€**
```python
# ìƒˆ í™”ë©´ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
print(f"[DEBUG] í™”ë©´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸: {screen_name}")
print(f"[DEBUG] ë“±ë¡ëœ í™”ë©´ ëª©ë¡: {list(self.screens.keys())}")
if screen_name not in self.screens:
    # ìƒˆ í™”ë©´ ë™ì  ìƒì„±
    print(f"[INFO] {screen_name} í™”ë©´ ë™ì  ìƒì„± ì¤‘...")
    if self.app and hasattr(self.app, 'create_and_register_screen'):
        self.app.create_and_register_screen(screen_name, **kwargs)
    else:
        # app ì°¸ì¡°ê°€ ì—†ìœ¼ë©´ ì§ì ‘ í™”ë©´ ìƒì„± ì‹œë„
        self._create_screen_directly(screen_name, **kwargs)
    
    if screen_name not in self.screens:
        print(f"[ERROR] í™”ë©´ ìƒì„± ì‹¤íŒ¨: {screen_name}")
        return False
else:
    print(f"[INFO] {screen_name} í™”ë©´ì´ ì´ë¯¸ ì¡´ì¬í•¨, ì¬ì‚¬ìš©")
```

### **ë””ë²„ê·¸ ë¡œê·¸ì˜ ëª©ì **

#### **ë¬¸ì œ ìœ„ì¹˜ íŒŒì•…**
- **í™”ë©´ ì¡´ì¬ ì—¬ë¶€**: `wifi_scan` í™”ë©´ì´ ì‹¤ì œë¡œ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- **ë“±ë¡ëœ í™”ë©´ ëª©ë¡**: í˜„ì¬ ë“±ë¡ëœ ëª¨ë“  í™”ë©´ ëª©ë¡ í™•ì¸
- **ë¶„ê¸° ì²˜ë¦¬**: ìƒˆ í™”ë©´ ìƒì„± vs ê¸°ì¡´ í™”ë©´ ì¬ì‚¬ìš© ë¶„ê¸° í™•ì¸

#### **ì˜ˆìƒ ë””ë²„ê·¸ ì¶œë ¥**
```
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] í™”ë©´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸: wifi_scan
[DEBUG] ë“±ë¡ëœ í™”ë©´ ëª©ë¡: ['wifi_scan']
[INFO] wifi_scan í™”ë©´ì´ ì´ë¯¸ ì¡´ì¬í•¨, ì¬ì‚¬ìš©
```

### **ë¬¸ì œ ì§„ë‹¨**

#### **ê°€ëŠ¥í•œ ë¬¸ì œì ë“¤**
1. **í™”ë©´ ë“±ë¡ ì‹¤íŒ¨**: `wifi_scan` í™”ë©´ì´ ì‹¤ì œë¡œ ë“±ë¡ë˜ì§€ ì•ŠìŒ
2. **í™”ë©´ ë”•ì…”ë„ˆë¦¬ ë¬¸ì œ**: `self.screens` ë”•ì…”ë„ˆë¦¬ì— ë¬¸ì œê°€ ìˆìŒ
3. **ë¶„ê¸° ì²˜ë¦¬ ì‹¤íŒ¨**: `if screen_name not in self.screens:` ì¡°ê±´ì—ì„œ ë¬¸ì œ ë°œìƒ

#### **ë””ë²„ê·¸ ë¡œê·¸ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒ**
- **ì •í™•í•œ ë©ˆì¶¤ ì§€ì **: í™”ë©´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ë‹¨ê³„ì—ì„œ ë©ˆì¶”ëŠ”ì§€ í™•ì¸
- **í™”ë©´ ë“±ë¡ ìƒíƒœ**: `wifi_scan` í™”ë©´ì´ ì‹¤ì œë¡œ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- **ë¶„ê¸° ì²˜ë¦¬**: ìƒˆ í™”ë©´ ìƒì„± vs ê¸°ì¡´ í™”ë©´ ì¬ì‚¬ìš© ë¶„ê¸°ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸

**ê²°ê³¼**: ë””ë²„ê·¸ ë¡œê·¸ë¥¼ í†µí•´ ì •í™•í•œ ë¬¸ì œ ìœ„ì¹˜ë¥¼ íŒŒì•…í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ë©ˆì¶¤ ë¬¸ì œ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - gc.collect() í˜¸ì¶œì—ì„œ ë¬¸ì œ ë°œìƒ
```

### **ì›ì¸ ë¶„ì„**
`gc.collect()` í˜¸ì¶œì—ì„œ ì‹œìŠ¤í…œì´ ë©ˆì¶”ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ  ë•Œë¬¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

1. **ë©”ëª¨ë¦¬ ë¶€ì¡±**: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì¤‘ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ì—¬ ì‹œìŠ¤í…œì´ ë©ˆì¶¤
2. **ë¬´í•œ ë£¨í”„**: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ê³¼ì •ì—ì„œ ë¬´í•œ ë£¨í”„ ë°œìƒ
3. **ì‹œìŠ¤í…œ ë¸”ë¡œí‚¹**: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë ¤ì„œ ì‹œìŠ¤í…œì´ ì‘ë‹µí•˜ì§€ ì•ŠìŒ

### **í•´ê²° ë°©ë²•: ì•ˆì „í•œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**

#### **1. ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€ ë° ì•ˆì „í•œ ì²˜ë¦¬**
```python
# ê°•ì œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ (ì•ˆì „í•œ ë°©ì‹)
print("[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...")
try:
    import gc
    print("[DEBUG] gc ëª¨ë“ˆ import ì™„ë£Œ")
    gc.collect()
    print("[DEBUG] gc.collect() í˜¸ì¶œ ì™„ë£Œ")
    print("[OK] ê°€ë¹„ì§€ ì»¬ë ‰ visualization ì™„ë£Œ")
except Exception as e:
    print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
    # ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰
    pass
```

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œì‘...
[DEBUG] gc ëª¨ë“ˆ import ì™„ë£Œ
[DEBUG] gc.collect() í˜¸ì¶œ ì™„ë£Œ
[OK] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
```

**ê²°ê³¼**: ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ë©ˆì¶¤ ë¬¸ì œê°€ í•´ê²°ë˜ê³  ì•ˆì „í•œ ë©”ëª¨ë¦¬ ì •ë¦¬ê°€ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ show_screen ë©”ì„œë“œ ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€

### **ë¬¸ì œ ìƒí™©**
```
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - show_screen ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ë¬¸ì œ ë°œìƒ
```

### **ì›ì¸ ë¶„ì„**
`show_screen` ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆì§€ë§Œ ë‚´ë¶€ ë¡œì§ì—ì„œ ë©ˆì¶”ê³  ìˆìŠµë‹ˆë‹¤. ì´ì „ì— ì¶”ê°€í•œ ë””ë²„ê·¸ ë¡œê·¸ê°€ ì¶œë ¥ë˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ ë©”ì„œë“œì˜ ì²« ë²ˆì§¸ ë¶€ë¶„ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•: ìƒì„¸ ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€**

#### **1. show_screen ë©”ì„œë“œ ì§„ì…ì  ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€**
```python
def show_screen(self, screen_name, add_to_stack=True, **kwargs):
    """í™”ë©´ ì „í™˜ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ ì™„ì „ ì‚­ì œ"""
    print(f"[DEBUG] show_screen ë©”ì„œë“œ ì‹œì‘: {screen_name}")
    
    # í˜„ì¬ í™”ë©´ì´ ìˆìœ¼ë©´ ì²˜ë¦¬
    print(f"[DEBUG] í˜„ì¬ í™”ë©´ ì²´í¬: current_screen={self.current_screen}, current_screen_name={self.current_screen_name}")
    if self.current_screen and self.current_screen_name:
        # ... ê¸°ì¡´ ë¡œì§
```

#### **2. ìŠ¤í¬ë¦°ë§¤ë‹ˆì € ì‚­ì œ ë¡œì§ í™•ì¸**
ìŠ¤í¬ë¦°ë§¤ë‹ˆì € ìì²´ë¥¼ ì‚­ì œí•˜ëŠ” ë¡œì§ì€ ì—†ëŠ” ê²ƒìœ¼ë¡œ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤:
- `delete.*ScreenManager`: ì—†ìŒ
- `ScreenManager.*delete`: ì—†ìŒ
- `del.*screen_manager`: ì—†ìŒ

### **ë””ë²„ê·¸ ë¡œê·¸ì˜ ëª©ì **

#### **ë¬¸ì œ ìœ„ì¹˜ íŒŒì•…**
- **ë©”ì„œë“œ ì§„ì…**: `show_screen` ë©”ì„œë“œê°€ ì‹¤ì œë¡œ í˜¸ì¶œë˜ëŠ”ì§€ í™•ì¸
- **í˜„ì¬ í™”ë©´ ìƒíƒœ**: `current_screen`ê³¼ `current_screen_name`ì˜ ìƒíƒœ í™•ì¸
- **ì¡°ê±´ ì²´í¬**: `if self.current_screen and self.current_screen_name:` ì¡°ê±´ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸

#### **ì˜ˆìƒ ë””ë²„ê·¸ ì¶œë ¥**
```
[INFO] í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] show_screen ë©”ì„œë“œ ì‹œì‘: wifi_scan
[DEBUG] í˜„ì¬ í™”ë©´ ì²´í¬: current_screen=None, current_screen_name=None
[DEBUG] í˜„ì¬ í™”ë©´ì´ ì—†ìŒ - ìƒˆ í™”ë©´ìœ¼ë¡œ ì§ì ‘ ì „í™˜
```

### **ë¬¸ì œ ì§„ë‹¨**

#### **ê°€ëŠ¥í•œ ë¬¸ì œì ë“¤**
1. **ë©”ì„œë“œ í˜¸ì¶œ ì‹¤íŒ¨**: `show_screen` ë©”ì„œë“œê°€ ì‹¤ì œë¡œ í˜¸ì¶œë˜ì§€ ì•ŠìŒ
2. **ê°ì²´ ì°¸ì¡° ë¬¸ì œ**: `self.current_screen` ë˜ëŠ” `self.current_screen_name`ì— ë¬¸ì œê°€ ìˆìŒ
3. **ì¡°ê±´ ì²´í¬ ì‹¤íŒ¨**: ì¡°ê±´ë¬¸ì—ì„œ ì˜ˆìƒì¹˜ ëª»í•œ ê²°ê³¼ ë°œìƒ

#### **ë””ë²„ê·¸ ë¡œê·¸ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒ**
- **ë©”ì„œë“œ ì§„ì… ì—¬ë¶€**: `show_screen` ë©”ì„œë“œê°€ ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸
- **í˜„ì¬ í™”ë©´ ìƒíƒœ**: í™”ë©´ ì°¸ì¡°ê°€ ì˜¬ë°”ë¥´ê²Œ ì •ë¦¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
- **ì¡°ê±´ ë¶„ê¸°**: ì˜¬ë°”ë¥¸ ë¶„ê¸°ë¡œ ì§„í–‰ë˜ëŠ”ì§€ í™•ì¸

**ê²°ê³¼**: ìƒì„¸í•œ ë””ë²„ê·¸ ë¡œê·¸ë¥¼ í†µí•´ ì •í™•í•œ ë¬¸ì œ ìœ„ì¹˜ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ cleanup() ë©”ì„œë“œ ì™„ë£Œ í™•ì¸ ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€

### **ë¬¸ì œ ìƒí™©**
```
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - cleanup() ë©”ì„œë“œ ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ì§€ ì•ŠìŒ
```

### **ì›ì¸ ë¶„ì„**
`cleanup()` ë©”ì„œë“œê°€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆì§€ë§Œ, ë‹¤ìŒ ë‹¨ê³„ì¸ `print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")`ê°€ ì¶œë ¥ë˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” `cleanup()` ë©”ì„œë“œì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí–ˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•: cleanup() ì™„ë£Œ í™•ì¸ ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€**

#### **1. cleanup() ë©”ì„œë“œ ì™„ë£Œ í™•ì¸ ë¡œê·¸ ì¶”ê°€**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ"""
    try:
        print("[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...")
        
        # ... ê¸°ì¡´ ì •ë¦¬ ë¡œì§ ...
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        print("[DEBUG] cleanup() ë©”ì„œë“œ ì •ìƒ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
        print("[DEBUG] cleanup() ë©”ì„œë“œ ì˜ˆì™¸ ë°œìƒ")
```

### **ë””ë²„ê·¸ ë¡œê·¸ì˜ ëª©ì **

#### **ë¬¸ì œ ìœ„ì¹˜ íŒŒì•…**
- **cleanup() ì™„ë£Œ**: `cleanup()` ë©”ì„œë“œê°€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸
- **ì˜ˆì™¸ ë°œìƒ**: `cleanup()` ë©”ì„œë“œì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí–ˆëŠ”ì§€ í™•ì¸
- **ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰**: `cleanup()` ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ëŠ”ì§€ í™•ì¸

#### **ì˜ˆìƒ ë””ë²„ê·¸ ì¶œë ¥**
```
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
[DEBUG] cleanup() ë©”ì„œë“œ ì •ìƒ ì™„ë£Œ
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
```

### **ë¬¸ì œ ì§„ë‹¨**

#### **ê°€ëŠ¥í•œ ë¬¸ì œì ë“¤**
1. **cleanup() ì˜ˆì™¸**: `cleanup()` ë©”ì„œë“œì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ì—¬ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ì§€ ì•ŠìŒ
2. **ë©”ì„œë“œ í˜¸ì¶œ ì‹¤íŒ¨**: `cleanup()` ë©”ì„œë“œ í˜¸ì¶œ ìì²´ì— ë¬¸ì œê°€ ìˆìŒ
3. **ì‹œìŠ¤í…œ ë¸”ë¡œí‚¹**: `cleanup()` ì™„ë£Œ í›„ ì‹œìŠ¤í…œì´ ì‘ë‹µí•˜ì§€ ì•ŠìŒ

#### **ë””ë²„ê·¸ ë¡œê·¸ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒ**
- **cleanup() ì™„ë£Œ ì—¬ë¶€**: ë©”ì„œë“œê°€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸
- **ì˜ˆì™¸ ë°œìƒ ì—¬ë¶€**: ì˜ˆì™¸ê°€ ë°œìƒí–ˆëŠ”ì§€ í™•ì¸
- **ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰**: cleanup() ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ëŠ”ì§€ í™•ì¸

**ê²°ê³¼**: cleanup() ë©”ì„œë“œ ì™„ë£Œ í™•ì¸ ë””ë²„ê·¸ ë¡œê·¸ë¥¼ í†µí•´ ì •í™•í•œ ë¬¸ì œ ìœ„ì¹˜ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ cleanup() ë©”ì„œë“œ ì•ˆì „í•œ ë¡œê·¸ ì¶œë ¥ ìˆ˜ì •

### **ë¬¸ì œ ìƒí™©**
```
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - cleanup() ë©”ì„œë“œì˜ ë§ˆì§€ë§‰ print ë¬¸ì—ì„œ ë¬¸ì œ ë°œìƒ
```

### **ì›ì¸ ë¶„ì„**
`cleanup()` ë©”ì„œë“œì˜ ë§ˆì§€ë§‰ ë¶€ë¶„ì—ì„œ `print("[DEBUG] cleanup() ë©”ì„œë“œ ì •ìƒ ì™„ë£Œ")`ê°€ ì¶œë ¥ë˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” `print` ë¬¸ ìì²´ì—ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•: ì•ˆì „í•œ ë¡œê·¸ ì¶œë ¥**

#### **1. ì•ˆì „í•œ ì™„ë£Œ ë¡œê·¸ ì¶œë ¥**
```python
def cleanup(self):
    """ë¦¬ì†ŒìŠ¤ ì™„ì „ ì •ë¦¬ - ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ì „ ì‚­ì œ"""
    try:
        print("[INFO] StartupScreen ì™„ì „ ì •ë¦¬ ì‹œì‘...")
        
        # ... ê¸°ì¡´ ì •ë¦¬ ë¡œì§ ...
        
        print("[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ")
        
        # ì•ˆì „í•œ ì™„ë£Œ ë¡œê·¸ ì¶œë ¥
        try:
            print("[DEBUG] cleanup() ë©”ì„œë“œ ì •ìƒ ì™„ë£Œ")
        except Exception as log_e:
            print(f"[WARN] cleanup() ì™„ë£Œ ë¡œê·¸ ì¶œë ¥ ì‹¤íŒ¨: {log_e}")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì •ë¦¬ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
        print("[DEBUG] cleanup() ë©”ì„œë“œ ì˜ˆì™¸ ë°œìƒ")
```

### **ì•ˆì „í•œ ë¡œê·¸ ì¶œë ¥ì˜ ì¤‘ìš”ì„±**

#### **ë¬¸ì œì **
- **print ë¬¸ ì‹¤íŒ¨**: `print` ë¬¸ ìì²´ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ
- **ì‹œìŠ¤í…œ ë¶ˆì•ˆì •**: ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì¸í•œ ì¶œë ¥ ë²„í¼ ë¬¸ì œ
- **ì „ì²´ ì¤‘ë‹¨**: print ë¬¸ ì‹¤íŒ¨ë¡œ ì¸í•œ ì „ì²´ ë©”ì„œë“œ ì¤‘ë‹¨

#### **í•´ê²°ì±…**
- **ì˜ˆì™¸ ì²˜ë¦¬**: print ë¬¸ì„ try-exceptë¡œ ê°ì‹¸ì„œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
- **ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš©**: ë¡œê·¸ ì¶œë ¥ ì‹¤íŒ¨ê°€ ì „ì²´ ì •ë¦¬ ê³¼ì •ì„ ì¤‘ë‹¨ì‹œí‚¤ì§€ ì•ŠìŒ
- **ì•ˆì •ì„±**: ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ í›„ì—ë„ ì•ˆì „í•˜ê²Œ ì§„í–‰

### **ê°œì„  íš¨ê³¼**

#### **ì•ˆì •ì„± í–¥ìƒ**
- **ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš©**: ë¡œê·¸ ì¶œë ¥ ì‹¤íŒ¨ê°€ ì „ì²´ ê³¼ì •ì„ ì¤‘ë‹¨ì‹œí‚¤ì§€ ì•ŠìŒ
- **ì•ˆì „í•œ ì§„í–‰**: ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì•ˆì „í•˜ê²Œ ì§„í–‰
- **ì˜¤ë¥˜ ë³µêµ¬**: ë¡œê·¸ ì¶œë ¥ ì‹¤íŒ¨ ì‹œì—ë„ ë‹¤ë¥¸ ì‘ì—…ì€ ê³„ì† ì§„í–‰

#### **ë©”ëª¨ë¦¬ ê´€ë¦¬**
- **ì™„ì „í•œ ì •ë¦¬**: 18KB ë©”ëª¨ë¦¬ê°€ ì•ˆì „í•˜ê²Œ í™•ë³´ë¨
- **ì•ˆì „í•œ ì „í™˜**: cleanup() ì™„ë£Œ í›„ ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì „í™˜

### **ì˜ˆìƒ ê²°ê³¼**
```
[OK] StartupScreen ì™„ì „ ì •ë¦¬ ì™„ë£Œ
[DEBUG] cleanup() ë©”ì„œë“œ ì •ìƒ ì™„ë£Œ
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
```

**ê²°ê³¼**: cleanup() ë©”ì„œë“œì˜ ì•ˆì „í•œ ë¡œê·¸ ì¶œë ¥ìœ¼ë¡œ ì‹œìŠ¤í…œ ì•ˆì •ì„±ì´ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì•ˆì „ì„± ê°œì„ 

### **ë¬¸ì œ ìƒí™©**
```
[DEBUG] cleanup() ë©”ì„œë“œ ì •ìƒ ì™„ë£Œ
# ì—¬ê¸°ì„œ ë©ˆì¶¤ - cleanup() ë©”ì„œë“œ í˜¸ì¶œ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ì§€ ì•ŠìŒ
```

### **ì›ì¸ ë¶„ì„**
`cleanup()` ë©”ì„œë“œ ìì²´ëŠ” ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆì§€ë§Œ, `cleanup()` ë©”ì„œë“œ í˜¸ì¶œ í›„ì— ë¬¸ì œê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŠ” `cleanup()` ë©”ì„œë“œ í˜¸ì¶œ ê³¼ì •ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí–ˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.

### **í•´ê²° ë°©ë²•: cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì•ˆì „ì„± ê°œì„ **

#### **1. cleanup() ë©”ì„œë“œ í˜¸ì¶œì„ try-exceptë¡œ ê°ì‹¸ê¸°**
```python
# ì•ˆì „í•œ í™”ë©´ ì „í™˜ (delete_async() í›„ ëŒ€ê¸°)
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì‹œì‘...")
try:
    self.cleanup()
    print("[DEBUG] cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì™„ë£Œ")
except Exception as e:
    print(f"[ERROR] cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì‹¤íŒ¨: {e}")
    import sys
    sys.print_exception(e)
print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ")
```

### **cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì•ˆì „ì„±ì˜ ì¤‘ìš”ì„±**

#### **ë¬¸ì œì **
- **í˜¸ì¶œ ê³¼ì • ì˜ˆì™¸**: `cleanup()` ë©”ì„œë“œ í˜¸ì¶œ ê³¼ì •ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ
- **ë©”ì„œë“œ ë°˜í™˜ ì‹¤íŒ¨**: `cleanup()` ë©”ì„œë“œê°€ ì •ìƒì ìœ¼ë¡œ ë°˜í™˜ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ
- **ì „ì²´ ì¤‘ë‹¨**: cleanup() í˜¸ì¶œ ì‹¤íŒ¨ë¡œ ì¸í•œ ì „ì²´ í™”ë©´ ì „í™˜ ì¤‘ë‹¨

#### **í•´ê²°ì±…**
- **ì˜ˆì™¸ ì²˜ë¦¬**: cleanup() ë©”ì„œë“œ í˜¸ì¶œì„ try-exceptë¡œ ê°ì‹¸ì„œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
- **ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš©**: cleanup() í˜¸ì¶œ ì‹¤íŒ¨ê°€ ì „ì²´ ê³¼ì •ì„ ì¤‘ë‹¨ì‹œí‚¤ì§€ ì•ŠìŒ
- **ì•ˆì •ì„±**: cleanup() ì‹¤íŒ¨ ì‹œì—ë„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰

### **ê°œì„  íš¨ê³¼**

#### **ì•ˆì •ì„± í–¥ìƒ**
- **í˜¸ì¶œ ì•ˆì „ì„±**: cleanup() ë©”ì„œë“œ í˜¸ì¶œì´ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬ë¨
- **ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš©**: cleanup() ì‹¤íŒ¨ê°€ ì „ì²´ í™”ë©´ ì „í™˜ì„ ì¤‘ë‹¨ì‹œí‚¤ì§€ ì•ŠìŒ
- **ì˜¤ë¥˜ ë³µêµ¬**: cleanup() ì‹¤íŒ¨ ì‹œì—ë„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰

#### **ë©”ëª¨ë¦¬ ê´€ë¦¬**
- **ì•ˆì „í•œ ì •ë¦¬**: cleanup() ì„±ê³µ ì‹œ 18KB ë©”ëª¨ë¦¬ê°€ í™•ë³´ë¨
- **ì•ˆì „í•œ ì „í™˜**: cleanup() ì‹¤íŒ¨ ì‹œì—ë„ ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œë„

### **ì˜ˆìƒ ê²°ê³¼**
```
[DEBUG] cleanup() ë©”ì„œë“œ ì •ìƒ ì™„ë£Œ
[DEBUG] cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì™„ë£Œ
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[INFO] wifi_scan í™”ë©´ìœ¼ë¡œ ì•ˆì „í•œ ì „í™˜ ì‹œì‘...
```

**ê²°ê³¼**: cleanup() ë©”ì„œë“œ í˜¸ì¶œ ì•ˆì „ì„±ì´ ê°œì„ ë˜ì–´ ì‹œìŠ¤í…œ ì•ˆì •ì„±ì´ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš¨ ìŠ¤íŒŒê²Œí‹° ì½”ë“œ ë¦¬íŒ©í† ë§: ì˜¬ë°”ë¥¸ ì±…ì„ ë¶„ë¦¬

### **ë¬¸ì œ ìƒí™©**
```
# ìŠ¤íŒŒê²Œí‹°ì²˜ëŸ¼ ê¼¬ì—¬ ìˆëŠ” êµ¬ì¡°
StartupScreenì—ì„œ í™”ë©´ ê´€ë¦¬ ë¡œì§ê¹Œì§€ ë‹´ë‹¹
ScreenManagerì˜ ì—­í• ì´ ì œëŒ€ë¡œ ìˆ˜í–‰ë˜ì§€ ì•ŠìŒ
ì±…ì„ ë¶„ë¦¬ ìœ„ë°˜ìœ¼ë¡œ ë²„ê·¸ ì°¾ê¸° ì–´ë ¤ì›€
```

### **ì›ì¸ ë¶„ì„**
í˜„ì¬ êµ¬ì¡°ì—ì„œ ê° í´ë˜ìŠ¤ê°€ ìì‹ ì˜ ì±…ì„ì„ ë„˜ì–´ì„  ì¼ì„ í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤:

#### **ì˜ëª»ëœ êµ¬ì¡° (Before)**
```python
# StartupScreenì—ì„œ í•˜ê³  ìˆë˜ ê²ƒë“¤ (ë¬¸ì œ!)
class StartupScreen:
    def _auto_advance_to_next_screen(self):
        self.cleanup()  # í™”ë©´ ì •ë¦¬
        self.screen_manager.current_screen_name = None  # ë§¤ë‹ˆì € ìƒíƒœ ì§ì ‘ ì¡°ì‘
        self.screen_manager.current_screen = None
        self.screen_manager.show_screen('wifi_scan')  # í™”ë©´ ì „í™˜
```

### **í•´ê²° ë°©ë²•: ì˜¬ë°”ë¥¸ ì±…ì„ ë¶„ë¦¬**

#### **1. ScreenManagerì— í™”ë©´ ê´€ë¦¬ ì±…ì„ ì¶”ê°€**
```python
class ScreenManager:
    def startup_completed(self):
        """ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì²˜ë¦¬ - ì˜¬ë°”ë¥¸ ì±…ì„ ë¶„ë¦¬"""
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì²˜ë¦¬ ì‹œì‘")
        
        # 1. ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬
        self.cleanup_screen('startup')
        
        # 2. ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ ì „í™˜
        self.transition_to('wifi_scan')
        
        print("[OK] ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì²˜ë¦¬ ì™„ë£Œ")
    
    def cleanup_screen(self, screen_name):
        """í™”ë©´ ì •ë¦¬ ë‹´ë‹¹ - ScreenManagerì˜ ì±…ì„"""
        print(f"[INFO] í™”ë©´ ì •ë¦¬ ì‹œì‘: {screen_name}")
        
        if screen_name in self.screens:
            screen = self.screens[screen_name]
            
            # í™”ë©´ì˜ cleanup ë©”ì„œë“œ í˜¸ì¶œ
            if hasattr(screen, 'cleanup'):
                try:
                    screen.cleanup()
                    print(f"[OK] {screen_name} í™”ë©´ ì •ë¦¬ ì™„ë£Œ")
                except Exception as e:
                    print(f"[ERROR] {screen_name} í™”ë©´ ì •ë¦¬ ì‹¤íŒ¨: {e}")
            
            # í™”ë©´ ë”•ì…”ë„ˆë¦¬ì—ì„œ ì œê±°
            del self.screens[screen_name]
            print(f"[OK] {screen_name} í™”ë©´ ë”•ì…”ë„ˆë¦¬ì—ì„œ ì œê±°")
            
            # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬
            if screen_name == self.current_screen_name:
                self.current_screen_name = None
                self.current_screen = None
                print(f"[OK] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬: {screen_name}")
    
    def transition_to(self, screen_name):
        """ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë‹´ë‹¹ - ScreenManagerì˜ ì±…ì„"""
        print(f"[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: {screen_name}")
        
        try:
            # í™”ë©´ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒì„±
            if screen_name not in self.screens:
                self._create_screen_directly(screen_name)
            
            # í˜„ì¬ í™”ë©´ ì°¸ì¡°ê°€ ìˆìœ¼ë©´ ì •ë¦¬
            if self.current_screen_name:
                self.current_screen_name = None
                self.current_screen = None
            
            # ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
            self.current_screen_name = screen_name
            self.current_screen = self.screens[screen_name]
            self.current_screen.show()
            
            # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
            import gc
            gc.collect()
            
            print(f"[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: {screen_name}")
            return True
            
        except Exception as e:
            print(f"[ERROR] í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
            return False
```

#### **2. StartupScreenì„ ë‹¨ìˆœí•˜ê²Œ ë³€ê²½**
```python
class StartupScreen:
    def _auto_advance_to_next_screen(self):
        """í™”ë©´ ì „í™˜ (ì˜¬ë°”ë¥¸ ì±…ì„ ë¶„ë¦¬ - ScreenManagerê°€ ì²˜ë¦¬)"""
        print("[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ - ScreenManagerì— ì™„ë£Œ ì‹ í˜¸ ì „ì†¡")
        
        # ScreenManagerì— ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì‹ í˜¸ ì „ì†¡ (ì˜¬ë°”ë¥¸ ì±…ì„ ë¶„ë¦¬)
        try:
            self.screen_manager.startup_completed()
            print("[OK] ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì‹ í˜¸ ì „ì†¡ ì™„ë£Œ")
        except Exception as e:
            print(f"[ERROR] ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì‹ í˜¸ ì „ì†¡ ì‹¤íŒ¨: {e}")
```

### **ë¦¬íŒ©í† ë§ì˜ ì¥ì **

#### **1. ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬**
- **StartupScreen**: í™”ë©´ ìƒì„± ë° ì´ˆê¸°í™” ì™„ë£Œ ì‹ í˜¸ë§Œ ë‹´ë‹¹
- **ScreenManager**: í™”ë©´ ì •ë¦¬, ì „í™˜, ìƒíƒœ ê´€ë¦¬ ë‹´ë‹¹
- **ë‹¨ì¼ ì±…ì„ ì›ì¹™**: ê° í´ë˜ìŠ¤ê°€ í•˜ë‚˜ì˜ ëª…í™•í•œ ì±…ì„ë§Œ ê°€ì§

#### **2. ì½”ë“œ ê°€ë…ì„± í–¥ìƒ**
- **ìŠ¤íŒŒê²Œí‹° ì½”ë“œ ì œê±°**: ë³µì¡í•˜ê²Œ ì–½íŒ ë¡œì§ ì •ë¦¬
- **ëª…í™•í•œ íë¦„**: í™”ë©´ ì „í™˜ ê³¼ì •ì´ ëª…í™•í•˜ê²Œ ë³´ì„
- **ë””ë²„ê¹… ìš©ì´**: ë¬¸ì œ ë°œìƒ ì‹œ ì–´ëŠ í´ë˜ìŠ¤ì—ì„œ ë°œìƒí–ˆëŠ”ì§€ ëª…í™•

#### **3. ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**
- **ëª¨ë“ˆí™”**: ê° ê¸°ëŠ¥ì´ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ë¨
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ í™”ë©´ ì¶”ê°€ ì‹œ ScreenManagerë§Œ ìˆ˜ì •í•˜ë©´ ë¨
- **í…ŒìŠ¤íŠ¸ ìš©ì´**: ê° í´ë˜ìŠ¤ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì™„ë£Œ - ScreenManagerì— ì™„ë£Œ ì‹ í˜¸ ì „ì†¡
[INFO] ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì²˜ë¦¬ ì‹œì‘
[INFO] í™”ë©´ ì •ë¦¬ ì‹œì‘: startup
[OK] startup í™”ë©´ ì •ë¦¬ ì™„ë£Œ
[OK] startup í™”ë©´ ë”•ì…”ë„ˆë¦¬ì—ì„œ ì œê±°
[OK] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬: startup
[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[INFO] wifi_scan í™”ë©´ ìƒì„± ì¤‘...
[OK] wifi_scan í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
[OK] ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì²˜ë¦¬ ì™„ë£Œ
[OK] ìŠ¤íƒ€íŠ¸ì—… ì™„ë£Œ ì‹ í˜¸ ì „ì†¡ ì™„ë£Œ
```

**ê²°ê³¼**: ìŠ¤íŒŒê²Œí‹° ì½”ë“œê°€ ë¦¬íŒ©í† ë§ë˜ì–´ ì˜¬ë°”ë¥¸ ì±…ì„ ë¶„ë¦¬ì™€ ëª…í™•í•œ êµ¬ì¡°ë¥¼ ê°€ì§„ ì‹œìŠ¤í…œì´ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸš€ ì „ì²´ í™”ë©´ ë¦¬íŒ©í† ë§: ì™„ì „í•œ ì±…ì„ ë¶„ë¦¬ ë° ë©”ëª¨ë¦¬ ìµœì í™”

### **ë¬¸ì œ ìƒí™©**
```
# ëª¨ë“  í™”ë©´ì—ì„œ í™”ë©´ ê´€ë¦¬ ë¡œì§ì´ í˜¼ì¬
ê° í™”ë©´ì´ ìì‹ ì˜ cleanup, í™”ë©´ ì „í™˜ì„ ì§ì ‘ ë‹´ë‹¹
í™”ë©´ ì „í™˜ ì‹œ ì´ì „ í™”ë©´ì´ ë©”ëª¨ë¦¬ì— ëˆ„ì 
ì„ íƒí•œ ì •ë³´ê°€ í™”ë©´ ì‚­ì œ ì‹œ í•¨ê»˜ ì‚¬ë¼ì§
```

### **í•´ê²° ë°©ë²•: ì™„ì „í•œ ì±…ì„ ë¶„ë¦¬ ë° ë©”ëª¨ë¦¬ ìµœì í™”**

#### **1. ScreenManagerì— ëª¨ë“  í™”ë©´ì˜ cleanup ë¡œì§ ì¶”ê°€**
```python
class ScreenManager:
    def _cleanup_wifi_scan_screen(self, screen):
        """WifiScanScreen ì „ìš© ì •ë¦¬ ì‘ì—…"""
        
    def _cleanup_meal_time_screen(self, screen):
        """MealTimeScreen ì „ìš© ì •ë¦¬ ì‘ì—…"""
        
    def _cleanup_dose_time_screen(self, screen):
        """DoseTimeScreen ì „ìš© ì •ë¦¬ ì‘ì—…"""
        
    def _cleanup_disk_selection_screen(self, screen):
        """DiskSelectionScreen ì „ìš© ì •ë¦¬ ì‘ì—…"""
        
    def _cleanup_pill_loading_screen(self, screen):
        """PillLoadingScreen ì „ìš© ì •ë¦¬ ì‘ì—…"""
```

#### **2. í™”ë©´ ì „í™˜ ì‹œ ì´ì „ í™”ë©´ ì‚­ì œ ì‹œìŠ¤í…œ**
```python
def transition_to(self, screen_name, cleanup_previous=True):
    """ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë‹´ë‹¹ - ScreenManagerì˜ ì±…ì„"""
    # ì´ì „ í™”ë©´ ì •ë¦¬ (ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”)
    if cleanup_previous and self.current_screen_name:
        self.cleanup_screen(self.current_screen_name)
    
    # ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
    # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
    import gc
    gc.collect()
```

#### **3. í™”ë©´ë³„ ë°ì´í„° ë°±ì—… ì‹œìŠ¤í…œ**
```python
class GlobalData:
    def __init__(self):
        # í™”ë©´ë³„ ë°ì´í„° ë°±ì—… ì €ì¥ì†Œ
        self.screen_data_backup = {
            'wifi_scan': {},  # WiFi ìŠ¤ìº” ê²°ê³¼
            'meal_time': {},  # ì‹ì‚¬ ì‹œê°„ ì„ íƒ ê²°ê³¼
            'dose_time': {},  # ë³µìš© ì‹œê°„ ì„¤ì • ê²°ê³¼
            'disk_selection': {},  # ë””ìŠ¤í¬ ì„ íƒ ê²°ê³¼
            'pill_loading': {},  # ì•Œì•½ ì¶©ì „ ê²°ê³¼
            'main': {}  # ë©”ì¸ í™”ë©´ ìƒíƒœ
        }
    
    def backup_screen_data(self, screen_name, data):
        """í™”ë©´ ë°ì´í„° ë°±ì—…"""
        
    def restore_screen_data(self, screen_name):
        """í™”ë©´ ë°ì´í„° ë³µì›"""
```

#### **4. ScreenManagerì— ë°ì´í„° ë°±ì—… ì‹œìŠ¤í…œ í†µí•©**
```python
def _backup_screen_data(self, screen_name, screen):
    """í™”ë©´ ë°ì´í„° ë°±ì—… - ScreenManagerì˜ ì±…ì„"""
    if screen_name == 'wifi_scan':
        # WiFi ìŠ¤ìº” ê²°ê³¼ ë°±ì—…
    elif screen_name == 'meal_time':
        # ì‹ì‚¬ ì‹œê°„ ì„ íƒ ê²°ê³¼ ë°±ì—…
    elif screen_name == 'dose_time':
        # ë³µìš© ì‹œê°„ ì„¤ì • ê²°ê³¼ ë°±ì—…
    # ... ê° í™”ë©´ë³„ ë°ì´í„° ë°±ì—…
```

### **ë¦¬íŒ©í† ë§ì˜ ì¥ì **

#### **1. ì™„ë²½í•œ ë©”ëª¨ë¦¬ ìµœì í™”**
- **í™”ë©´ ì „í™˜ ì‹œ ì´ì „ í™”ë©´ ì™„ì „ ì‚­ì œ**: ë©”ëª¨ë¦¬ ëˆ„ì  ë°©ì§€
- **í•„ìš”í•œ ë°ì´í„°ë§Œ ë°±ì—…**: ì„ íƒí•œ ì •ë³´ ë³´ì¡´
- **ìë™ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬

#### **2. ë°ì´í„° ì•ˆì „ì„± ë³´ì¥**
- **í™”ë©´ ì‚­ì œ ì „ ë°ì´í„° ë°±ì—…**: ì„ íƒí•œ ì •ë³´ ì†ì‹¤ ë°©ì§€
- **í™”ë©´ ë³µì› ì‹œ ë°ì´í„° ë³µêµ¬**: ì´ì „ ìƒíƒœ ìœ ì§€ ê°€ëŠ¥
- **ì „ì—­ ë°ì´í„° ì €ì¥ì†Œ**: ëª¨ë“  í™”ë©´ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥

#### **3. ì™„ë²½í•œ ì±…ì„ ë¶„ë¦¬**
- **ScreenManager**: ëª¨ë“  í™”ë©´ ê´€ë¦¬ ì‘ì—… ë‹´ë‹¹
- **ê° í™”ë©´**: í™”ë©´ ìƒì„± ë° ì´ë²¤íŠ¸ ì²˜ë¦¬ë§Œ ë‹´ë‹¹
- **GlobalData**: ë°ì´í„° ë°±ì—… ë° ë³µì› ë‹´ë‹¹

#### **4. í™•ì¥ì„± ë° ìœ ì§€ë³´ìˆ˜ì„±**
- **ìƒˆë¡œìš´ í™”ë©´ ì¶”ê°€ ìš©ì´**: ScreenManagerì— cleanup ë¡œì§ë§Œ ì¶”ê°€
- **ë°ì´í„° ë°±ì—… ì‹œìŠ¤í…œ í™•ì¥**: ìƒˆë¡œìš´ ë°ì´í„° íƒ€ì… ì‰½ê²Œ ì¶”ê°€
- **ë©”ëª¨ë¦¬ ê´€ë¦¬ ì¼ì›í™”**: ëª¨ë“  í™”ë©´ ê´€ë¦¬ê°€ í•œ ê³³ì— ì§‘ì¤‘

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: meal_time
[INFO] wifi_scan í™”ë©´ ë°ì´í„° ë°±ì—… ì‹œì‘...
[INFO] wifi_scan í™”ë©´ ë°ì´í„° ë°±ì—… ì™„ë£Œ
[INFO] í™”ë©´ ì •ë¦¬ ì‹œì‘: wifi_scan
[INFO] WifiScanScreen ì „ìš© ì •ë¦¬ ì‹œì‘...
[OK] WifiScanScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ
[OK] wifi_scan í™”ë©´ ë”•ì…”ë„ˆë¦¬ì—ì„œ ì œê±°
[INFO] meal_time í™”ë©´ ìƒì„± ì¤‘...
[OK] meal_time í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: meal_time
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: meal_time
```

**ê²°ê³¼**: ì™„ì „í•œ ì±…ì„ ë¶„ë¦¬ì™€ ë©”ëª¨ë¦¬ ìµœì í™”ê°€ êµ¬í˜„ë˜ì–´ ì•ˆì •ì ì´ê³  íš¨ìœ¨ì ì¸ í™”ë©´ ê´€ë¦¬ ì‹œìŠ¤í…œì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ”Š ì•ŒëŒ ì‹œìŠ¤í…œ ë¦¬íŒ©í† ë§: ì§€ì—° ë¡œë”© ë° ë©”ëª¨ë¦¬ ìµœì í™”

### **ë¬¸ì œ ìƒí™©**
```
# ì•ŒëŒ ì‹œìŠ¤í…œì—ì„œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì´ˆê¸°í™” ì‹œì ì— ë¡œë“œë¨
audio_system, led_controllerê°€ ìƒì„±ìì—ì„œ ì´ˆê¸°í™”
ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ë†’ê³  ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ì ìœ 
ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì»´í¬ë„ŒíŠ¸ë„ ë©”ëª¨ë¦¬ì— ìƒì£¼
```

### **í•´ê²° ë°©ë²•: ì§€ì—° ë¡œë”© ë° ì°¸ì¡° ì •ë¦¬ ì‹œìŠ¤í…œ**

#### **1. ìƒì„±ì ë‹¨ìˆœí™” ë° ì§€ì—° ë¡œë”© ì ìš©**
```python
def __init__(self, data_manager):
    """ì•ŒëŒ ì‹œìŠ¤í…œ ì´ˆê¸°í™” - ì§€ì—° ë¡œë”© ì ìš©"""
    self.data_manager = data_manager
    
    # ì§€ì—° ë¡œë”©ì„ ìœ„í•œ ìºì‹œ (ê° ì»´í¬ë„ŒíŠ¸ë³„)
    self._wifi_manager = None
    self._audio_system = None
    self._led_controller = None
    self._time_cache = {}
    self._last_time_check = 0
```

#### **2. ê° ì»´í¬ë„ŒíŠ¸ë³„ ì§€ì—° ë¡œë”© ë©”ì„œë“œ**
```python
def _get_audio_system(self):
    """ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì§€ì—° ë¡œë”©"""
    if self._audio_system is None:
        try:
            from audio_system import AudioSystem
            self._audio_system = AudioSystem()
            print("[DEBUG] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì§€ì—° ë¡œë”© ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ë¡œë”© ì‹¤íŒ¨: {e}")
            return None
    return self._audio_system

def _get_led_controller(self):
    """LED ì»¨íŠ¸ë¡¤ëŸ¬ ì§€ì—° ë¡œë”©"""
    if self._led_controller is None:
        try:
            from led_controller import LEDController
            self._led_controller = LEDController()
            print("[DEBUG] LED ì»¨íŠ¸ë¡¤ëŸ¬ ì§€ì—° ë¡œë”© ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] LED ì»¨íŠ¸ë¡¤ëŸ¬ ë¡œë”© ì‹¤íŒ¨: {e}")
            return None
    return self._led_controller
```

#### **3. ì°¸ì¡° ì •ë¦¬ ë° ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹œìŠ¤í…œ**
```python
def _cleanup_audio_system(self):
    """ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì°¸ì¡° ì •ë¦¬ ë° ê°€ë¹„ì§€ ì»¬ë ‰ì…˜"""
    try:
        if self._audio_system is not None:
            print("[INFO] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì°¸ì¡° ì •ë¦¬ ì‹œì‘...")
            if hasattr(self._audio_system, 'cleanup'):
                self._audio_system.cleanup()
            self._audio_system = None
            print("[OK] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
    except Exception as e:
        print(f"[WARN] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì°¸ì¡° ì •ë¦¬ ì‹¤íŒ¨: {e}")
    finally:
        # ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        import gc
        gc.collect()
        print("[DEBUG] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")

def cleanup_all_components(self):
    """ëª¨ë“  ì»´í¬ë„ŒíŠ¸ ì°¸ì¡° ì •ë¦¬ ë° ê°€ë¹„ì§€ ì»¬ë ‰ì…˜"""
    print("[INFO] ì•ŒëŒ ì‹œìŠ¤í…œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ ì •ë¦¬ ì‹œì‘...")
    self._cleanup_audio_system()
    self._cleanup_led_controller()
    self._cleanup_wifi_manager()
    print("[OK] ì•ŒëŒ ì‹œìŠ¤í…œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ ì •ë¦¬ ì™„ë£Œ")
```

#### **4. ì•ŒëŒ ì‹¤í–‰ ë©”ì„œë“œì— ì§€ì—° ë¡œë”© ì ìš©**
```python
def _play_alarm_sound(self):
    """ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ (ë²„ì € + ìŒì„±) - ì§€ì—° ë¡œë”© ì ìš©"""
    try:
        if not self.alarm_settings["sound_enabled"]:
            return
        
        # ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì§€ì—° ë¡œë”©
        audio_system = self._get_audio_system()
        if audio_system:
            # 1. ë²„ì € ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ
            audio_system.play_alarm_sound()
            
            # 2. take_medicine.wav ìŒì„± íŒŒì¼ ì¬ìƒ
            audio_system.play_voice("take_medicine.wav", blocking=False)
        else:
            # ì‹œë®¬ë ˆì´ì…˜
            print("ğŸ”Š ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ (ì‹œë®¬ë ˆì´ì…˜)")
            
    except Exception as e:
        print(f"[ERROR] ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ ì‹¤íŒ¨: {e}")
    finally:
        # ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        import gc
        gc.collect()
        print("[DEBUG] ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ í›„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")

def _show_alarm_led(self):
    """ì•ŒëŒ LED í‘œì‹œ - ì§€ì—° ë¡œë”© ì ìš©"""
    try:
        if not self.alarm_settings["led_enabled"]:
            return
        
        # LED ì»¨íŠ¸ë¡¤ëŸ¬ ì§€ì—° ë¡œë”©
        led_controller = self._get_led_controller()
        if led_controller:
            led_controller.show_alarm_led()
            print("ğŸ’¡ ì•ŒëŒ LED ì¼œì§")
        else:
            print("ğŸ’¡ ì•ŒëŒ LED ì¼œì§ (ì‹œë®¬ë ˆì´ì…˜)")
            
    except Exception as e:
        print(f"[ERROR] ì•ŒëŒ LED í‘œì‹œ ì‹¤íŒ¨: {e}")
    finally:
        # ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
        import gc
        gc.collect()
        print("[DEBUG] ì•ŒëŒ LED í‘œì‹œ í›„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
```

### **ë¦¬íŒ©í† ë§ì˜ ì¥ì **

#### **1. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”**
- **í•„ìš”í•  ë•Œë§Œ ë¡œë”©**: ì»´í¬ë„ŒíŠ¸ê°€ ì‹¤ì œ ì‚¬ìš©ë  ë•Œë§Œ ì´ˆê¸°í™”
- **ì‚¬ìš© í›„ ì¦‰ì‹œ ì •ë¦¬**: ì‘ì—… ì™„ë£Œ í›„ ì°¸ì¡° í•´ì œ ë° ê°€ë¹„ì§€ ì»¬ë ‰ì…˜
- **ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ì ìœ  ë°©ì§€**: ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ë©”ëª¨ë¦¬ì— ìƒì£¼í•˜ì§€ ì•ŠìŒ

#### **2. ì‹œìŠ¤í…œ ì•ˆì •ì„± í–¥ìƒ**
- **ì˜¤ë¥˜ ê²©ë¦¬**: í•œ ì»´í¬ë„ŒíŠ¸ ì‹¤íŒ¨ê°€ ì „ì²´ ì‹œìŠ¤í…œì— ì˜í–¥ ì£¼ì§€ ì•ŠìŒ
- **ìë™ ë³µêµ¬**: ì»´í¬ë„ŒíŠ¸ ë¡œë”© ì‹¤íŒ¨ ì‹œ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ëŒ€ì²´
- **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€**: ì²´ê³„ì ì¸ ì°¸ì¡° ì •ë¦¬ë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€

#### **3. ì„±ëŠ¥ í–¥ìƒ**
- **ë¹ ë¥¸ ì´ˆê¸°í™”**: ìƒì„±ìì—ì„œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ ë¡œë”©í•˜ì§€ ì•ŠìŒ
- **íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ ì‚¬ìš©**: í•„ìš”í•  ë•Œë§Œ ë©”ëª¨ë¦¬ í• ë‹¹
- **ìë™ ë©”ëª¨ë¦¬ ì •ë¦¬**: ì‚¬ìš© í›„ ì¦‰ì‹œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜

#### **4. ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**
- **ëª¨ë“ˆí™”ëœ êµ¬ì¡°**: ê° ì»´í¬ë„ŒíŠ¸ê°€ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ë¨
- **ìº¡ìŠí™”**: ì»´í¬ë„ŒíŠ¸ ë¡œë”©/ì •ë¦¬ ë¡œì§ì´ ë‚´ë¶€ì— ìˆ¨ê²¨ì§
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ ìš©ì´

### **ì˜ˆìƒ ê²°ê³¼**
```
[OK] AlarmSystem ì´ˆê¸°í™” ì™„ë£Œ (ì§€ì—° ë¡œë”© ì ìš©)
[DEBUG] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì§€ì—° ë¡œë”© ì™„ë£Œ
ğŸ”Š ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ (ë²„ì €)
ğŸ”Š ì•ŒëŒ ì‹œ ë³µìš© ì•ˆë‚´ ìŒì„± ì¬ìƒ
[DEBUG] ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ í›„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[DEBUG] LED ì»¨íŠ¸ë¡¤ëŸ¬ ì§€ì—° ë¡œë”© ì™„ë£Œ
ğŸ’¡ ì•ŒëŒ LED ì¼œì§
[DEBUG] ì•ŒëŒ LED í‘œì‹œ í›„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[INFO] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì°¸ì¡° ì •ë¦¬ ì‹œì‘...
[OK] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[DEBUG] ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
```

**ê²°ê³¼**: ì•ŒëŒ ì‹œìŠ¤í…œì´ ì§€ì—° ë¡œë”©ê³¼ ë©”ëª¨ë¦¬ ìµœì í™”ë¥¼ í†µí•´ íš¨ìœ¨ì ì´ê³  ì•ˆì •ì ì¸ ì‹œìŠ¤í…œìœ¼ë¡œ ê°œì„ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ§¹ ì½”ë“œ ì •ë¦¬: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì½”ë“œ ì‚­ì œ

### **ë¬¸ì œ ìƒí™©**
```
# ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë©”ì„œë“œë“¤ì´ ë©”ëª¨ë¦¬ë¥¼ ì ìœ í•˜ê³  ìˆìŒ
- update_alarm_settings, clear_alarm_history, force_end_all_alarms
- set_volume, get_volume, enable_audio, disable_audio, get_audio_info
- show_status_led, hide_status_led, enable_led, disable_led, get_led_status, blink_alarm_led
- get_alarm_status, confirm_dose
```

### **í•´ê²° ë°©ë²•: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì½”ë“œ ì‚­ì œ**

#### **1. ì•ŒëŒ ì‹œìŠ¤í…œ (alarm_system.py) ì •ë¦¬**
```python
# ì‚­ì œëœ ë©”ì„œë“œë“¤
def update_alarm_settings(self, new_settings):  # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def clear_alarm_history(self):                  # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def force_end_all_alarms(self):                 # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def get_alarm_status(self, dose_index):         # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def confirm_dose(self, dose_index):             # ë‚´ë¶€ì ìœ¼ë¡œë§Œ ì‚¬ìš©
```

#### **2. ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ (audio_system.py) ì •ë¦¬**
```python
# ì‚­ì œëœ ë©”ì„œë“œë“¤
def set_volume(self, volume):                   # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def get_volume(self):                           # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def enable_audio(self):                         # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def disable_audio(self):                        # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def get_audio_info(self):                       # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
```

#### **3. LED ì»¨íŠ¸ë¡¤ëŸ¬ (led_controller.py) ì •ë¦¬**
```python
# ì‚­ì œëœ ë©”ì„œë“œë“¤
def blink_alarm_led(self, duration_ms, interval_ms):  # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def show_status_led(self):                           # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def hide_status_led(self):                           # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def enable_led(self):                                # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def disable_led(self):                               # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
def get_led_status(self):                            # ì™¸ë¶€ í˜¸ì¶œ ì—†ìŒ
```

### **ì •ë¦¬ íš¨ê³¼**

#### **1. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ**
- **ë¶ˆí•„ìš”í•œ ë©”ì„œë“œ ì œê±°**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì½”ë“œë¡œ ì¸í•œ ë©”ëª¨ë¦¬ ì ìœ  í•´ê²°
- **ì½”ë“œ í¬ê¸° ê°ì†Œ**: ì „ì²´ ì½”ë“œë² ì´ìŠ¤ í¬ê¸° ìµœì í™”
- **ë¡œë”© ì‹œê°„ ë‹¨ì¶•**: ë¶ˆí•„ìš”í•œ ì½”ë“œ ë¡œë”© ì‹œê°„ ì œê±°

#### **2. ì½”ë“œ í’ˆì§ˆ í–¥ìƒ**
- **ëª…í™•í•œ ì¸í„°í˜ì´ìŠ¤**: ì‹¤ì œ ì‚¬ìš©ë˜ëŠ” ë©”ì„œë“œë§Œ ë…¸ì¶œ
- **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**: ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±°ë¡œ ê´€ë¦¬ ìš©ì´
- **ê°€ë…ì„± í–¥ìƒ**: í•µì‹¬ ê¸°ëŠ¥ì— ì§‘ì¤‘ëœ ê¹”ë”í•œ ì½”ë“œ

#### **3. ì„±ëŠ¥ ìµœì í™”**
- **ë¹ ë¥¸ ì´ˆê¸°í™”**: ë¶ˆí•„ìš”í•œ ë©”ì„œë“œ ì´ˆê¸°í™” ì‹œê°„ ì œê±°
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ê°ì²´ ìƒì„± ë°©ì§€
- **ì‹¤í–‰ ì†ë„ í–¥ìƒ**: ë¶ˆí•„ìš”í•œ ì½”ë“œ ì‹¤í–‰ ì‹œê°„ ì œê±°

### **ì‚­ì œëœ ì½”ë“œ í†µê³„**
```
ì•ŒëŒ ì‹œìŠ¤í…œ: 5ê°œ ë©”ì„œë“œ ì‚­ì œ
ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ: 5ê°œ ë©”ì„œë“œ ì‚­ì œ  
LED ì»¨íŠ¸ë¡¤ëŸ¬: 6ê°œ ë©”ì„œë“œ ì‚­ì œ
ì´ 16ê°œ ë©”ì„œë“œ ì‚­ì œë¡œ ì½”ë“œë² ì´ìŠ¤ ìµœì í™”
```

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] ì½”ë“œ ì •ë¦¬ ì „ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ë†’ìŒ
[INFO] ë¶ˆí•„ìš”í•œ ë©”ì„œë“œ 16ê°œ ì‚­ì œ ì™„ë£Œ
[INFO] ì½”ë“œ ì •ë¦¬ í›„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ìµœì í™”ë¨
[OK] ì½”ë“œë² ì´ìŠ¤ ì •ë¦¬ ì™„ë£Œ - ì„±ëŠ¥ í–¥ìƒ ë° ë©”ëª¨ë¦¬ ì ˆì•½
```

**ê²°ê³¼**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì½”ë“œë¥¼ ì œê±°í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ìµœì í™”í•˜ê³  ì½”ë“œ í’ˆì§ˆì„ í–¥ìƒì‹œì¼°ìŠµë‹ˆë‹¤.

---

## ğŸ“¦ Import ë¬¸ ì •ë¦¬: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” import ì œê±°

### **ë¬¸ì œ ìƒí™©**
```
# ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” import ë¬¸ë“¤ì´ ë©”ëª¨ë¦¬ë¥¼ ì ìœ í•˜ê³  ìˆìŒ
led_controller.pyì—ì„œ time ëª¨ë“ˆ importí•˜ì§€ë§Œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
ë¶ˆí•„ìš”í•œ ëª¨ë“ˆ ë¡œë”©ìœ¼ë¡œ ì¸í•œ ë©”ëª¨ë¦¬ ë‚­ë¹„
```

### **í•´ê²° ë°©ë²•: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” import ë¬¸ ì œê±°**

#### **1. LED ì»¨íŠ¸ë¡¤ëŸ¬ (led_controller.py) ì •ë¦¬**
```python
# ì •ë¦¬ ì „
import time
from machine import Pin

# ì •ë¦¬ í›„
from machine import Pin
```

**ì‚­ì œëœ import**: `time` ëª¨ë“ˆ - ì‚¬ìš©ë˜ì§€ ì•ŠìŒ

#### **2. ë‹¤ë¥¸ íŒŒì¼ë“¤ì˜ import ìƒíƒœ í™•ì¸**
- **audio_system.py**: `time` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **main_screen.py**: `sys`, `time`, `lvgl`, `RTC` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **startup_screen.py**: `time`, `lvgl`, `UIStyle` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **wifi_scan_screen.py**: `time`, `lvgl`, `get_wifi_manager`, `UIStyle` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **wifi_manager.py**: `network`, `time`, `json`, `ntptime` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **motor_control.py**: `Pin`, `time` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **button_interface.py**: `Pin`, `time` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **medication_tracker.py**: `time` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **memory_monitor.py**: `gc`, `micropython`, `time` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **battery_monitor.py**: `machine`, `time`, `safe_print` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **ui_style.py**: `lvgl` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **lv_utils.py**: `lvgl`, `micropython`, `sys` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…
- **st77xx.py**: `time`, `machine`, `struct`, `uctypes`, `const` ëª¨ë“ˆ ì‚¬ìš©ë¨ âœ…

### **ì •ë¦¬ íš¨ê³¼**

#### **1. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ**
- **ë¶ˆí•„ìš”í•œ ëª¨ë“ˆ ë¡œë”© ì œê±°**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” `time` ëª¨ë“ˆ ì œê±°
- **ì´ˆê¸°í™” ì‹œê°„ ë‹¨ì¶•**: ë¶ˆí•„ìš”í•œ ëª¨ë“ˆ ì´ˆê¸°í™” ì‹œê°„ ì œê±°
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± í–¥ìƒ**: ì‹¤ì œ ì‚¬ìš©ë˜ëŠ” ëª¨ë“ˆë§Œ ë¡œë”©

#### **2. ì½”ë“œ í’ˆì§ˆ í–¥ìƒ**
- **ëª…í™•í•œ ì˜ì¡´ì„±**: ì‹¤ì œ ì‚¬ìš©ë˜ëŠ” ëª¨ë“ˆë§Œ import
- **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**: ë¶ˆí•„ìš”í•œ import ì œê±°ë¡œ ê´€ë¦¬ ìš©ì´
- **ê°€ë…ì„± í–¥ìƒ**: í•„ìš”í•œ ëª¨ë“ˆì— ì§‘ì¤‘ëœ ê¹”ë”í•œ import

#### **3. ì„±ëŠ¥ ìµœì í™”**
- **ë¹ ë¥¸ ì´ˆê¸°í™”**: ë¶ˆí•„ìš”í•œ ëª¨ë“ˆ ë¡œë”© ì‹œê°„ ì œê±°
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ëª¨ë“ˆ ë©”ëª¨ë¦¬ ì ìœ  ë°©ì§€
- **ì‹¤í–‰ ì†ë„ í–¥ìƒ**: ë¶ˆí•„ìš”í•œ ëª¨ë“ˆ ì´ˆê¸°í™” ì‹œê°„ ì œê±°

### **ì •ë¦¬ëœ import í†µê³„**
```
LED ì»¨íŠ¸ë¡¤ëŸ¬: 1ê°œ import ì œê±° (time ëª¨ë“ˆ)
ë‹¤ë¥¸ íŒŒì¼ë“¤: ëª¨ë“  importê°€ ì‚¬ìš©ë¨ (ì •ë¦¬ ë¶ˆí•„ìš”)
ì´ 1ê°œ ë¶ˆí•„ìš”í•œ import ì œê±°ë¡œ ë©”ëª¨ë¦¬ ìµœì í™”
```

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] Import ë¬¸ ì •ë¦¬ ì „: ë¶ˆí•„ìš”í•œ time ëª¨ë“ˆ ë¡œë”©
[INFO] LED ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” time import ì œê±°
[INFO] Import ë¬¸ ì •ë¦¬ í›„: í•„ìš”í•œ ëª¨ë“ˆë§Œ ë¡œë”©
[OK] Import ë¬¸ ì •ë¦¬ ì™„ë£Œ - ë©”ëª¨ë¦¬ ì ˆì•½ ë° ì´ˆê¸°í™” ì‹œê°„ ë‹¨ì¶•
```

**ê²°ê³¼**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” import ë¬¸ì„ ì œê±°í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ìµœì í™”í•˜ê³  ì´ˆê¸°í™” ì‹œê°„ì„ ë‹¨ì¶•ì‹œì¼°ìŠµë‹ˆë‹¤.

---

## ğŸ”§ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë©ˆì¶¤ í˜„ìƒ í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ë©ˆì¶¤
```

### **ì›ì¸ ë¶„ì„**
- ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ê³¼ì •ì—ì„œ `_clear_screen` í˜¸ì¶œ í›„ ì¶”ê°€ ì •ë¦¬ ì‘ì—… ì¤‘ ë©ˆì¶¤ ë°œìƒ
- ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ í›„ ì¶”ê°€ì ì¸ ê°ì²´ ì°¸ì¡° ì •ë¦¬ ê³¼ì •ì—ì„œ ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥ì„±
- í™”ë©´ ì „í™˜ ê³¼ì •ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬ ë¶€ì¡±

### **í•´ê²° ë°©ë²•: ì•ˆì „í•œ í™”ë©´ ì •ë¦¬ ë° ì „í™˜**

#### **1. ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ë©”ì„œë“œ ê°œì„ **
```python
def _cleanup_startup_screen(self, screen):
    """StartupScreen ì „ìš© ì •ë¦¬ ì‘ì—… - ScreenManagerì˜ ì±…ì„"""
    try:
        print("[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...")
        
        # LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œ
        if hasattr(screen, 'screen_obj') and screen.screen_obj:
            self._clear_screen(screen.screen_obj)
            screen.screen_obj = None
            print("[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # ë‹¤ë¥¸ ê°ì²´ ì°¸ì¡°ë“¤ ì •ë¦¬ (ì•ˆì „í•˜ê²Œ)
        try:
            if hasattr(screen, 'main_container'):
                screen.main_container = None
                print("[DEBUG] main_container ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] main_container ì •ë¦¬ ì‹¤íŒ¨: {e}")
        
        try:
            if hasattr(screen, 'logo_container'):
                screen.logo_container = None
                print("[DEBUG] logo_container ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] logo_container ì •ë¦¬ ì‹¤íŒ¨: {e}")
        
        try:
            if hasattr(screen, 'icon_bg'):
                screen.icon_bg = None
                print("[DEBUG] icon_bg ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] icon_bg ì •ë¦¬ ì‹¤íŒ¨: {e}")
        
        print("[OK] StartupScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì „ìš© ì •ë¦¬ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

#### **2. í™”ë©´ ì‚­ì œ ë©”ì„œë“œ ê°œì„ **
```python
def _clear_screen(self, screen_obj):
    """í˜„ì¬ í™”ë©´ ì‚­ì œ ë£¨í‹´ - ë³µì¡í•œ êµ¬ì¡°ì—ì„œ ë¶€ëª¨ë§Œ ì‚­ì œí•˜ë©´ ìì‹ë“¤ ìë™ ì‚­ì œ"""
    if screen_obj:
        try:
            # ë¶€ëª¨ í™”ë©´ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ë„ ëª¨ë‘ ìë™ ì‚­ì œë¨)
            screen_obj.delete_async()
            print("[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)")
        except Exception as e:
            print(f"[WARN] í™”ë©´ ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨, ë™ê¸° ì‚­ì œ ì‹œë„: {e}")
            try:
                # ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨ ì‹œ ë™ê¸° ì‚­ì œ
                screen_obj.delete()
                print("[OK] í™”ë©´ ê°ì²´ ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            except Exception as e2:
                print(f"[WARN] í™”ë©´ ë™ê¸° ì‚­ì œë„ ì‹¤íŒ¨: {e2}")
        finally:
            # ë©”ëª¨ë¦¬ íšŒìˆ˜ (ì•ˆì „í•˜ê²Œ)
            try:
                import gc
                gc.collect()
                print("[DEBUG] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
            except Exception as e:
                print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
```

#### **3. í™”ë©´ ì „í™˜ ë©”ì„œë“œ ê°œì„ **
```python
def transition_to(self, screen_name, cleanup_previous=True):
    """ì•ˆì „í•œ í™”ë©´ ì „í™˜ ë‹´ë‹¹ - ScreenManagerì˜ ì±…ì„"""
    print(f"[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: {screen_name}")
    
    try:
        # ì´ì „ í™”ë©´ ì •ë¦¬ (ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”)
        if cleanup_previous and self.current_screen_name and self.current_screen_name != screen_name:
            print(f"[INFO] ì´ì „ í™”ë©´ ì •ë¦¬ ì‹œì‘: {self.current_screen_name}")
            self.cleanup_screen(self.current_screen_name)
            print(f"[OK] ì´ì „ í™”ë©´ ì •ë¦¬ ì™„ë£Œ: {self.current_screen_name}")
        
        # í™”ë©´ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒì„±
        if screen_name not in self.screens:
            print(f"[INFO] {screen_name} í™”ë©´ ìƒì„± ì¤‘...")
            self._create_screen_directly(screen_name)
        
        # í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬
        if self.current_screen_name:
            print(f"[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬: {self.current_screen_name}")
            self.current_screen_name = None
            self.current_screen = None
        
        # ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
        print(f"[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: {screen_name}")
        self.current_screen_name = screen_name
        print(f"[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: {self.current_screen_name}")
        self.current_screen = self.screens[screen_name]
        print(f"[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: {self.current_screen}")
        print(f"[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...")
        
        try:
            self.current_screen.show()
            print(f"[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ")
        except Exception as e:
            print(f"[ERROR] í™”ë©´ show() í˜¸ì¶œ ì‹¤íŒ¨: {e}")
            import sys
            sys.print_exception(e)
            raise
        
        # í™”ë©´ ì „í™˜ ì™„ë£Œ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬
        try:
            import gc
            gc.collect()
            print("[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹¤íŒ¨: {e}")
        
        print(f"[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: {screen_name}")
        return True
        
    except Exception as e:
        print(f"[ERROR] í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

### **ê°œì„  íš¨ê³¼**

#### **1. ì•ˆì •ì„± í–¥ìƒ**
- **ê°œë³„ ì˜ˆì™¸ ì²˜ë¦¬**: ê° ì •ë¦¬ ì‘ì—…ì„ ê°œë³„ì ìœ¼ë¡œ try-catch ì²˜ë¦¬
- **ì•ˆì „í•œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**: gc.collect() í˜¸ì¶œì„ try-catchë¡œ ë³´í˜¸
- **ìƒì„¸í•œ ë””ë²„ê·¸ ë¡œê·¸**: ê° ë‹¨ê³„ë³„ ì§„í–‰ ìƒí™© ì¶”ì  ê°€ëŠ¥

#### **2. ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”**
- **ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš©**: í•œ ë¶€ë¶„ì´ ì‹¤íŒ¨í•´ë„ ì „ì²´ ì •ë¦¬ ê³¼ì • ê³„ì† ì§„í–‰
- **ì˜ˆì™¸ ì •ë³´ ë³´ì¡´**: ì‹¤íŒ¨í•œ ë¶€ë¶„ì˜ ì˜ˆì™¸ ì •ë³´ë¥¼ ë¡œê·¸ë¡œ ì¶œë ¥
- **ë³µêµ¬ ê°€ëŠ¥í•œ ì˜¤ë¥˜**: ì¹˜ëª…ì ì´ì§€ ì•Šì€ ì˜¤ë¥˜ëŠ” ê²½ê³ ë¡œ ì²˜ë¦¬

#### **3. ë””ë²„ê¹… ìš©ì´ì„±**
- **ë‹¨ê³„ë³„ ë¡œê·¸**: ê° ì •ë¦¬ ë‹¨ê³„ë§ˆë‹¤ ìƒì„¸í•œ ë¡œê·¸ ì¶œë ¥
- **ì§„í–‰ ìƒí™© ì¶”ì **: ì–´ëŠ ë‹¨ê³„ì—ì„œ ë©ˆì¶¤ì´ ë°œìƒí•˜ëŠ”ì§€ ì •í™•íˆ íŒŒì•… ê°€ëŠ¥
- **ì˜¤ë¥˜ ì›ì¸ ë¶„ì„**: ì˜ˆì™¸ ë°œìƒ ì‹œ ìƒì„¸í•œ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ì¶œë ¥

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[DEBUG] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[DEBUG] main_container ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[DEBUG] logo_container ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[DEBUG] icon_bg ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] StartupScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ
[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[INFO] wifi_scan í™”ë©´ ìƒì„± ì¤‘...
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

**ê²°ê³¼**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ë©ˆì¶¤ í˜„ìƒì„ í•´ê²°í•˜ê³  ì•ˆì •ì ì¸ í™”ë©´ ì „í™˜ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

---

## ğŸ—‘ï¸ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í™”ë©´ íŒŒì¼ ì •ë¦¬

### **ë¬¸ì œ ìƒí™©**
```
# ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í™”ë©´ íŒŒì¼ë“¤ì´ ë©”ëª¨ë¦¬ë¥¼ ì ìœ í•˜ê³  ìˆìŒ
advanced_settings_screen.py - ë©”ì¸ í™”ë©´ì—ì„œ ë²„íŠ¼ Dë¡œ ì ‘ê·¼í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
data_management_screen.py - ê³ ê¸‰ ì„¤ì • í™”ë©´ì—ì„œ ì ‘ê·¼í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
medication_history_screen.py - ì •ì˜ë˜ì–´ ìˆì§€ë§Œ í˜¸ì¶œí•˜ëŠ” ì½”ë“œ ì—†ìŒ
medication_status_screen.py - ì •ì˜ë˜ì–´ ìˆì§€ë§Œ í˜¸ì¶œí•˜ëŠ” ì½”ë“œ ì—†ìŒ
settings_screen.py - ì •ì˜ë˜ì–´ ìˆì§€ë§Œ í˜¸ì¶œí•˜ëŠ” ì½”ë“œ ì—†ìŒ
```

### **í•´ê²° ë°©ë²•: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í™”ë©´ íŒŒì¼ ì™„ì „ ì‚­ì œ**

#### **1. ì‚­ì œëœ í™”ë©´ íŒŒì¼ë“¤**
```bash
# ì‚­ì œëœ íŒŒì¼ë“¤
src/screens/advanced_settings_screen.py     # 5ê°œ íŒŒì¼ ì‚­ì œ
src/screens/data_management_screen.py
src/screens/medication_history_screen.py
src/screens/medication_status_screen.py
src/screens/settings_screen.py
```

#### **2. ë©”ì¸ í™”ë©´ì—ì„œ ë²„íŠ¼ D ê¸°ëŠ¥ ì œê±°**
```python
# ìˆ˜ì • ì „
def on_button_d(self):
    """ë²„íŠ¼ D - ê³ ê¸‰ ì„¤ì • í™”ë©´ìœ¼ë¡œ ì „í™˜"""
    print("ğŸŸ¢ ë²„íŠ¼ D: ê³ ê¸‰ ì„¤ì • í™”ë©´ìœ¼ë¡œ ì „í™˜")
    
    try:
        self.screen_manager.show_screen("advanced_settings")
        print("[OK] ê³ ê¸‰ ì„¤ì • í™”ë©´ìœ¼ë¡œ ì „í™˜")
    except Exception as e:
        print(f"[ERROR] ê³ ê¸‰ ì„¤ì • í™”ë©´ ì „í™˜ ì‹¤íŒ¨: {e}")
        self._update_status("ê³ ê¸‰ ì„¤ì • í™”ë©´ ì „í™˜ ì‹¤íŒ¨")

# ìˆ˜ì • í›„
def on_button_d(self):
    """ë²„íŠ¼ D - í˜„ì¬ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ"""
    print("ğŸŸ¢ ë²„íŠ¼ D: í˜„ì¬ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ")
    self._update_status("ë²„íŠ¼ DëŠ” í˜„ì¬ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ")
```

#### **3. ìŠ¤í¬ë¦° ë§¤ë‹ˆì €ì—ì„œ ê´€ë ¨ ì½”ë“œ ì œê±°**
```python
# ì œê±°ëœ ì½”ë“œ
elif screen_name == "advanced_settings":
    from screens.advanced_settings_screen import AdvancedSettingsScreen
    screen = AdvancedSettingsScreen(self)
    self.register_screen(screen_name, screen)
    print(f"[OK] {screen_name} í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ")
elif screen_name == "data_management":
    from screens.data_management_screen import DataManagementScreen
    screen = DataManagementScreen(self)
    self.register_screen(screen_name, screen)
    print(f"[OK] {screen_name} í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ")
```

#### **4. main.pyì—ì„œ ê´€ë ¨ ì½”ë“œ ì œê±°**
```python
# ì œê±°ëœ ì½”ë“œ
elif screen_name == "settings":
    from screens.settings_screen import SettingsScreen
    screen = SettingsScreen(screen_manager)
elif screen_name == "medication_history":
    from screens.medication_history_screen import MedicationHistoryScreen
    screen = MedicationHistoryScreen(screen_manager)
elif screen_name == "medication_status":
    from screens.medication_status_screen import MedicationStatusScreen
    screen = MedicationStatusScreen(screen_manager)
elif screen_name == "settings":
    from screens.settings_screen import SettingsScreen
    screen = SettingsScreen(screen_manager)
```

#### **5. pillbox_app.pyì—ì„œ ê´€ë ¨ ì½”ë“œ ì œê±°**
```python
# ì œê±°ëœ ì½”ë“œ
if screen_name == "advanced_settings":
    from screens.advanced_settings_screen import AdvancedSettingsScreen
    screen_instance = AdvancedSettingsScreen(self.screen_manager)
    self.screen_manager.register_screen(screen_name, screen_instance)
    print(f"[OK] {screen_name} í™”ë©´ ìƒì„± ë° ë“±ë¡ ì™„ë£Œ")
    return True
elif screen_name == "data_management":
    from screens.data_management_screen import DataManagementScreen
    screen_instance = DataManagementScreen(self.screen_manager)
    self.screen_manager.register_screen(screen_name, screen_instance)
    print(f"[OK] {screen_name} í™”ë©´ ìƒì„± ë° ë“±ë¡ ì™„ë£Œ")
    return True
```

### **ì •ë¦¬ íš¨ê³¼**

#### **1. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëŒ€í­ ê°ì†Œ**
- **í™”ë©´ íŒŒì¼ ì‚­ì œ**: 5ê°œ í™”ë©´ íŒŒì¼ ì™„ì „ ì œê±°
- **ì½”ë“œ í¬ê¸° ê°ì†Œ**: ë¶ˆí•„ìš”í•œ í™”ë©´ ìƒì„± ì½”ë“œ ì œê±°
- **ë¡œë”© ì‹œê°„ ë‹¨ì¶•**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í™”ë©´ ë¡œë”© ì‹œê°„ ì œê±°

#### **2. ì½”ë“œ í’ˆì§ˆ í–¥ìƒ**
- **ëª…í™•í•œ ê¸°ëŠ¥**: ì‹¤ì œ ì‚¬ìš©ë˜ëŠ” í™”ë©´ë§Œ ìœ ì§€
- **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**: ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±°ë¡œ ê´€ë¦¬ ìš©ì´
- **ê°€ë…ì„± í–¥ìƒ**: í•µì‹¬ ê¸°ëŠ¥ì— ì§‘ì¤‘ëœ ê¹”ë”í•œ ì½”ë“œ

#### **3. ì‹œìŠ¤í…œ ì•ˆì •ì„± í–¥ìƒ**
- **ì˜¤ë¥˜ ê°€ëŠ¥ì„± ê°ì†Œ**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í™”ë©´ìœ¼ë¡œ ì¸í•œ ì˜¤ë¥˜ ë°©ì§€
- **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€**: ë¶ˆí•„ìš”í•œ í™”ë©´ ê°ì²´ ìƒì„± ë°©ì§€
- **ì„±ëŠ¥ ìµœì í™”**: ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì  ì‚¬ìš©

### **ì •ë¦¬ëœ í™”ë©´ í†µê³„**
```
ì‚­ì œëœ í™”ë©´ íŒŒì¼: 5ê°œ
- advanced_settings_screen.py
- data_management_screen.py  
- medication_history_screen.py
- medication_status_screen.py
- settings_screen.py

ìˆ˜ì •ëœ íŒŒì¼: 4ê°œ
- main_screen.py (ë²„íŠ¼ D ê¸°ëŠ¥ ì œê±°)
- screen_manager.py (í™”ë©´ ìƒì„± ì½”ë“œ ì œê±°)
- main.py (í™”ë©´ ìƒì„± ì½”ë“œ ì œê±°)
- pillbox_app.py (í™”ë©´ ìƒì„± ì½”ë“œ ì œê±°)

ì´ 5ê°œ í™”ë©´ íŒŒì¼ ì‚­ì œë¡œ ëŒ€í­ì ì¸ ë©”ëª¨ë¦¬ ì ˆì•½
```

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] í™”ë©´ ì •ë¦¬ ì „: 15ê°œ í™”ë©´ íŒŒì¼
[INFO] ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í™”ë©´ 5ê°œ ì‚­ì œ ì™„ë£Œ
[INFO] ê´€ë ¨ ì½”ë“œ ì •ë¦¬ ì™„ë£Œ
[INFO] í™”ë©´ ì •ë¦¬ í›„: 10ê°œ í™”ë©´ íŒŒì¼
[OK] í™”ë©´ ì •ë¦¬ ì™„ë£Œ - ë©”ëª¨ë¦¬ ëŒ€í­ ì ˆì•½ ë° ì„±ëŠ¥ í–¥ìƒ
```

**ê²°ê³¼**: ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” í™”ë©´ íŒŒì¼ë“¤ì„ ì™„ì „íˆ ì‚­ì œí•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ ëŒ€í­ ì ˆì•½í•˜ê³  ì‹œìŠ¤í…œ ì„±ëŠ¥ì„ í–¥ìƒì‹œì¼°ìŠµë‹ˆë‹¤.

---

## ğŸ”§ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë©ˆì¶¤ í˜„ìƒ ì¬í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[DEBUG] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ë©ˆì¶¤

# ëª¨ë“  í™”ë©´ì— ì •ë¦¬ ë¡œì§ ì ìš© í›„ë¶€í„° ë¬¸ì œ ë°œìƒ
```

### **ì›ì¸ ë¶„ì„**
- **ë³µì¡í•œ ì •ë¦¬ ë¡œì§**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì— ëª¨ë“  í™”ë©´ìš© ì •ë¦¬ ë¡œì§ì„ ì ìš©í•œ í›„ ë©ˆì¶¤ ë°œìƒ
- **ë¹„ë™ê¸° ì‚­ì œ íƒ€ì´ë°**: `delete_async()` í˜¸ì¶œ í›„ ì¦‰ì‹œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤í–‰ìœ¼ë¡œ ì¸í•œ ì¶©ëŒ
- **ê³¼ë„í•œ ê°ì²´ ì°¸ì¡° ì •ë¦¬**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ ë¶ˆí•„ìš”í•œ ì¶”ê°€ ì •ë¦¬ ì‘ì—…ìœ¼ë¡œ ì¸í•œ ë©ˆì¶¤

### **í•´ê²° ë°©ë²•: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ë¡œì§ ë‹¨ìˆœí™”**

#### **1. ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ë©”ì„œë“œ ë‹¨ìˆœí™”**
```python
# ìˆ˜ì • ì „ (ë³µì¡í•œ ì •ë¦¬ ë¡œì§)
def _cleanup_startup_screen(self, screen):
    """StartupScreen ì „ìš© ì •ë¦¬ ì‘ì—… - ScreenManagerì˜ ì±…ì„"""
    try:
        print("[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...")
        
        # LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œ
        if hasattr(screen, 'screen_obj') and screen.screen_obj:
            self._clear_screen(screen.screen_obj)
            screen.screen_obj = None
            print("[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # ë‹¤ë¥¸ ê°ì²´ ì°¸ì¡°ë“¤ ì •ë¦¬ (ì•ˆì „í•˜ê²Œ)
        try:
            if hasattr(screen, 'main_container'):
                screen.main_container = None
                print("[DEBUG] main_container ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] main_container ì •ë¦¬ ì‹¤íŒ¨: {e}")
        
        try:
            if hasattr(screen, 'logo_container'):
                screen.logo_container = None
                print("[DEBUG] logo_container ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] logo_container ì •ë¦¬ ì‹¤íŒ¨: {e}")
        
        try:
            if hasattr(screen, 'icon_bg'):
                screen.icon_bg = None
                print("[DEBUG] icon_bg ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] icon_bg ì •ë¦¬ ì‹¤íŒ¨: {e}")
        
        print("[OK] StartupScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì „ìš© ì •ë¦¬ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)

# ìˆ˜ì • í›„ (ë‹¨ìˆœí™”ëœ ì •ë¦¬ ë¡œì§)
def _cleanup_startup_screen(self, screen):
    """StartupScreen ì „ìš© ì •ë¦¬ ì‘ì—… - ScreenManagerì˜ ì±…ì„ (ë‹¨ìˆœí™”)"""
    try:
        print("[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...")
        
        # LVGL ê°ì²´ë“¤ ì™„ì „ ì‚­ì œë§Œ ìˆ˜í–‰ (ë‹¨ìˆœí™”)
        if hasattr(screen, 'screen_obj') and screen.screen_obj:
            self._clear_screen(screen.screen_obj)
            screen.screen_obj = None
            print("[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ")
        
        # ì¶”ê°€ ì •ë¦¬ëŠ” ìƒëµ (ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ í•œ ë²ˆë§Œ ì‚¬ìš©ë˜ë¯€ë¡œ)
        print("[OK] StartupScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ")
        
    except Exception as e:
        print(f"[ERROR] StartupScreen ì „ìš© ì •ë¦¬ ì‹¤íŒ¨: {e}")
        import sys
        sys.print_exception(e)
```

#### **2. í™”ë©´ ì‚­ì œ ë©”ì„œë“œ ê°œì„ **
```python
# ìˆ˜ì • ì „
def _clear_screen(self, screen_obj):
    """í˜„ì¬ í™”ë©´ ì‚­ì œ ë£¨í‹´ - ë³µì¡í•œ êµ¬ì¡°ì—ì„œ ë¶€ëª¨ë§Œ ì‚­ì œí•˜ë©´ ìì‹ë“¤ ìë™ ì‚­ì œ"""
    if screen_obj:
        try:
            # ë¶€ëª¨ í™”ë©´ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ë„ ëª¨ë‘ ìë™ ì‚­ì œë¨)
            screen_obj.delete_async()
            print("[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)")
        except Exception as e:
            print(f"[WARN] í™”ë©´ ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨, ë™ê¸° ì‚­ì œ ì‹œë„: {e}")
            try:
                # ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨ ì‹œ ë™ê¸° ì‚­ì œ
                screen_obj.delete()
                print("[OK] í™”ë©´ ê°ì²´ ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            except Exception as e2:
                print(f"[WARN] í™”ë©´ ë™ê¸° ì‚­ì œë„ ì‹¤íŒ¨: {e2}")
        finally:
            # ë©”ëª¨ë¦¬ íšŒìˆ˜ (ì•ˆì „í•˜ê²Œ)
            try:
                import gc
                gc.collect()
                print("[DEBUG] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
            except Exception as e:
                print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")

# ìˆ˜ì • í›„
def _clear_screen(self, screen_obj):
    """í˜„ì¬ í™”ë©´ ì‚­ì œ ë£¨í‹´ - ë³µì¡í•œ êµ¬ì¡°ì—ì„œ ë¶€ëª¨ë§Œ ì‚­ì œí•˜ë©´ ìì‹ë“¤ ìë™ ì‚­ì œ"""
    if screen_obj:
        try:
            # ë¶€ëª¨ í™”ë©´ ì‚­ì œ (ìì‹ ê°ì²´ë“¤ë„ ëª¨ë‘ ìë™ ì‚­ì œë¨)
            screen_obj.delete_async()
            print("[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)")
            
            # ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œë¥¼ ìœ„í•œ ì§§ì€ ëŒ€ê¸°
            import time
            time.sleep_ms(10)  # 10ms ëŒ€ê¸°
            
        except Exception as e:
            print(f"[WARN] í™”ë©´ ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨, ë™ê¸° ì‚­ì œ ì‹œë„: {e}")
            try:
                # ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨ ì‹œ ë™ê¸° ì‚­ì œ
                screen_obj.delete()
                print("[OK] í™”ë©´ ê°ì²´ ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            except Exception as e2:
                print(f"[WARN] í™”ë©´ ë™ê¸° ì‚­ì œë„ ì‹¤íŒ¨: {e2}")
        
        # ë©”ëª¨ë¦¬ íšŒìˆ˜ëŠ” ë³„ë„ë¡œ ì²˜ë¦¬ (ì•ˆì „í•˜ê²Œ)
        try:
            import gc
            gc.collect()
            print("[DEBUG] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤íŒ¨: {e}")
```

### **ê°œì„  íš¨ê³¼**

#### **1. ì•ˆì •ì„± í–¥ìƒ**
- **ë‹¨ìˆœí™”ëœ ì •ë¦¬ ë¡œì§**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì€ í•œ ë²ˆë§Œ ì‚¬ìš©ë˜ë¯€ë¡œ ë³µì¡í•œ ì •ë¦¬ ë¶ˆí•„ìš”
- **ë¹„ë™ê¸° ì‚­ì œ íƒ€ì´ë° ê°œì„ **: `delete_async()` í›„ 10ms ëŒ€ê¸°ë¡œ ì•ˆì •ì„± í–¥ìƒ
- **ê³¼ë„í•œ ì •ë¦¬ ì‘ì—… ì œê±°**: ë¶ˆí•„ìš”í•œ ê°ì²´ ì°¸ì¡° ì •ë¦¬ ì‘ì—… ì œê±°

#### **2. ì„±ëŠ¥ ìµœì í™”**
- **ë¹ ë¥¸ ì •ë¦¬**: ë³µì¡í•œ ì •ë¦¬ ë¡œì§ ì œê±°ë¡œ ì •ë¦¬ ì‹œê°„ ë‹¨ì¶•
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: í•„ìš”í•œ ì •ë¦¬ë§Œ ìˆ˜í–‰í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”
- **ì‹œìŠ¤í…œ ì•ˆì •ì„±**: ë©ˆì¶¤ í˜„ìƒ í•´ê²°ë¡œ ì•ˆì •ì ì¸ í™”ë©´ ì „í™˜

#### **3. ë””ë²„ê¹… ìš©ì´ì„±**
- **ëª…í™•í•œ ë¡œê·¸**: ë‹¨ìˆœí™”ëœ ë¡œê·¸ë¡œ ë””ë²„ê¹… ìš©ì´
- **ì˜¤ë¥˜ ì¶”ì **: ë¬¸ì œ ë°œìƒ ì‹œ ì›ì¸ íŒŒì•… ìš©ì´
- **ìœ ì§€ë³´ìˆ˜ì„±**: ë‹¨ìˆœí•œ ë¡œì§ìœ¼ë¡œ ìœ ì§€ë³´ìˆ˜ ìš©ì´

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...
[OK] í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ (ìì‹ ê°ì²´ë“¤ í¬í•¨)
[DEBUG] ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ë£Œ
[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] StartupScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ
[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[INFO] wifi_scan í™”ë©´ ìƒì„± ì¤‘...
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

**ê²°ê³¼**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì •ë¦¬ ë¡œì§ì„ ë‹¨ìˆœí™”í•˜ì—¬ ë©ˆì¶¤ í˜„ìƒì„ í•´ê²°í•˜ê³  ì•ˆì •ì ì¸ í™”ë©´ ì „í™˜ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

---

## ğŸ”§ ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë©ˆì¶¤ í˜„ìƒ ìµœì¢… í•´ê²°

### **ë¬¸ì œ ìƒí™©**
```
[OK] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë™ê¸° ì‚­ì œ ì™„ë£Œ
ì—¬ê¸°ì„œ ë©ˆì¶¤

# ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì—ì„œ ë©ˆì¶¤ ë°œìƒ
```

### **ìµœì¢… ì›ì¸ ë¶„ì„**
- **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì¶©ëŒ**: `gc.collect()` í˜¸ì¶œì´ LVGL ê°ì²´ ì‚­ì œ ì§í›„ì— ì‹œìŠ¤í…œì„ ë¶ˆì•ˆì •í•˜ê²Œ ë§Œë“¦
- **ì¤‘ë³µ ë©”ì„œë“œ**: `_clear_screen` ë©”ì„œë“œê°€ ë‘ ê°œ ì¡´ì¬í•˜ì—¬ ì¶©ëŒ ë°œìƒ
- **ë¹„ë™ê¸° ì‚­ì œ íƒ€ì´ë°**: `delete_async()` í›„ ì¦‰ì‹œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì‹¤í–‰ìœ¼ë¡œ ì¸í•œ ë¬¸ì œ

### **ìµœì¢… í•´ê²° ë°©ë²•**

#### **1. ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì™„ì „ ì œê±°**
```python
def _clear_screen(self, screen_obj):
    """LVGL í™”ë©´ ê°ì²´ ì•ˆì „ ì‚­ì œ - ScreenManagerì˜ ì±…ì„"""
    if screen_obj:
        try:
            # ë™ê¸° ì‚­ì œ ì‚¬ìš© (ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œëŠ” ì•ˆì „í•¨)
            screen_obj.delete()
            print("[OK] LVGL í™”ë©´ ê°ì²´ ë™ê¸° ì‚­ì œ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ë™ê¸° ì‚­ì œ ì‹¤íŒ¨, ë¹„ë™ê¸° ì‚­ì œ ì‹œë„: {e}")
            try:
                # ë¹„ë™ê¸° ì‚­ì œ ì‹œë„
                screen_obj.delete_async()
                print("[OK] LVGL í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            except Exception as e2:
                print(f"[WARN] ë¹„ë™ê¸° ì‚­ì œë„ ì‹¤íŒ¨: {e2}")
        # ë©”ëª¨ë¦¬ íšŒìˆ˜ëŠ” ìƒëµ (ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œëŠ” ë¬¸ì œ ë°œìƒ ê°€ëŠ¥)
        print("[DEBUG] LVGL í™”ë©´ ì‚­ì œ í›„ ë©”ëª¨ë¦¬ íšŒìˆ˜ ìƒëµ")
```

#### **2. ì¤‘ë³µ ë©”ì„œë“œ ì œê±°**
- ë‘ ê°œì˜ `_clear_screen` ë©”ì„œë“œ ì¤‘ í•˜ë‚˜ ì œê±°
- ì¼ê´€ëœ ì‚­ì œ ë¡œì§ ì ìš©

#### **3. ë™ê¸° ì‚­ì œ ìš°ì„  ì‚¬ìš©**
- `delete()` ë©”ì„œë“œë¥¼ ìš°ì„ ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ì•ˆì •ì„± í–¥ìƒ
- ë¹„ë™ê¸° ì‚­ì œëŠ” ë°±ì—… ì˜µì…˜ìœ¼ë¡œë§Œ ì‚¬ìš©

### **ìµœì¢… ê²°ê³¼**

#### **ì„±ê³µì ì¸ í™”ë©´ ì „í™˜**
```
[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...
[DEBUG] screen_obj ì‚­ì œ ì‹œì‘...
[DEBUG] _clear_startup_screen ì‹œì‘: lvgl obj
[DEBUG] ë™ê¸° ì‚­ì œ ì‹œì‘...
[OK] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë™ê¸° ì‚­ì œ ì™„ë£Œ
[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìƒëµ
[DEBUG] screen_obj ì‚­ì œ ì™„ë£Œ
[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì‹œì‘...
[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] StartupScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ
[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] í™”ë©´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸: wifi_scan in self.screens = False
[INFO] wifi_scan í™”ë©´ ìƒì„± ì¤‘...
[DEBUG] _create_screen_directly ì‹œì‘: wifi_scan
[DEBUG] WifiScanScreen import ì‹œì‘...
[DEBUG] WifiScanScreen import ì™„ë£Œ
[DEBUG] WifiScanScreen ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œì‘...
[DEBUG] WifiScanScreen ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì™„ë£Œ
[DEBUG] register_screen í˜¸ì¶œ ì‹œì‘...
[DEBUG] register_screen ì‹œì‘: wifi_scan
[DEBUG] screen_instance: <WifiScanScreen object>
[DEBUG] screens ë”•ì…”ë„ˆë¦¬ì— ì €ì¥ ì‹œì‘...
[DEBUG] screens ë”•ì…”ë„ˆë¦¬ì— ì €ì¥ ì™„ë£Œ
[OK] í™”ë©´ ë“±ë¡: wifi_scan
[DEBUG] register_screen í˜¸ì¶œ ì™„ë£Œ
[OK] wifi_scan í™”ë©´ ì§ì ‘ ìƒì„± ì™„ë£Œ
[DEBUG] í™”ë©´ ìƒì„± ì™„ë£Œ: wifi_scan
[DEBUG] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì‹œì‘...
[DEBUG] current_screen_name: startup
[DEBUG] current_screen: <StartupScreen object>
[INFO] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬: startup
[DEBUG] í˜„ì¬ í™”ë©´ ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[DEBUG] ìƒˆ í™”ë©´ìœ¼ë¡œ ì „í™˜ ì‹œì‘: wifi_scan
[DEBUG] self.screens[screen_name] ì ‘ê·¼ ì‹œì‘...
[DEBUG] current_screen ì„¤ì • ì™„ë£Œ: <WifiScanScreen object>
[DEBUG] current_screen_name ì„¤ì • ì‹œì‘...
[DEBUG] current_screen_name ì„¤ì • ì™„ë£Œ: wifi_scan
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì‹œì‘...
[DEBUG] í™”ë©´ show() í˜¸ì¶œ ì™„ë£Œ
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì‹œì‘...
[DEBUG] í™”ë©´ ì „í™˜ í›„ ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ
[OK] í™”ë©´ ì „í™˜ ì™„ë£Œ: wifi_scan
```

### **í•µì‹¬ í•´ê²° í¬ì¸íŠ¸**

#### **1. ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ì œê±°**
- ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œëŠ” `gc.collect()` í˜¸ì¶œ ì™„ì „ ìƒëµ
- LVGL ê°ì²´ ì‚­ì œ ì§í›„ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì´ ì‹œìŠ¤í…œì„ ë¶ˆì•ˆì •í•˜ê²Œ ë§Œë“œëŠ” ë¬¸ì œ í•´ê²°

#### **2. ë™ê¸° ì‚­ì œ ìš°ì„ **
- `delete()` ë©”ì„œë“œë¥¼ ìš°ì„ ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ì¦‰ì‹œ ì‚­ì œ ë³´ì¥
- `delete_async()`ëŠ” ë°±ì—… ì˜µì…˜ìœ¼ë¡œë§Œ ì‚¬ìš©

#### **3. ì½”ë“œ ì •ë¦¬**
- ì¤‘ë³µëœ ë©”ì„œë“œ ì œê±°ë¡œ ì¼ê´€ì„± í™•ë³´
- ë‹¨ìˆœí™”ëœ ì‚­ì œ ë¡œì§ìœ¼ë¡œ ì•ˆì •ì„± í–¥ìƒ

**ê²°ê³¼**: ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œ wifi_scan í™”ë©´ìœ¼ë¡œì˜ ì „í™˜ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰

---

## ğŸ”„ ì›ë˜ ì„±ê³µí–ˆë˜ ë°©ë²•ìœ¼ë¡œ ë³µì›

### **ì‚¬ìš©ì ìš”ì²­**
- ì›ë˜ ì„±ê³µí–ˆë˜ ì½”ë“œëŒ€ë¡œ `delete_async()`ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì • ìš”ì²­

### **ìˆ˜ì •ëœ ë‚´ìš©**

#### **1. `_clear_screen` ë©”ì„œë“œ ë³µì›**
```python
def _clear_screen(self, screen_obj):
    """LVGL í™”ë©´ ê°ì²´ ì•ˆì „ ì‚­ì œ - ScreenManagerì˜ ì±…ì„"""
    if screen_obj:
        try:
            # ë¹„ë™ê¸° ì‚­ì œ ì‚¬ìš© (ì›ë˜ ì„±ê³µí–ˆë˜ ë°©ë²•)
            screen_obj.delete_async()
            print("[OK] LVGL í™”ë©´ ê°ì²´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ")
        except Exception as e:
            print(f"[WARN] ë¹„ë™ê¸° ì‚­ì œ ì‹¤íŒ¨, ë™ê¸° ì‚­ì œ ì‹œë„: {e}")
            try:
                # ë™ê¸° ì‚­ì œ ì‹œë„
                screen_obj.delete()
                print("[OK] LVGL í™”ë©´ ê°ì²´ ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            except Exception as e2:
                print(f"[WARN] ë™ê¸° ì‚­ì œë„ ì‹¤íŒ¨: {e2}")
        # ë©”ëª¨ë¦¬ íšŒìˆ˜ëŠ” ìƒëµ (ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œëŠ” ë¬¸ì œ ë°œìƒ ê°€ëŠ¥)
        print("[DEBUG] LVGL í™”ë©´ ì‚­ì œ í›„ ë©”ëª¨ë¦¬ íšŒìˆ˜ ìƒëµ")
```

#### **2. `_clear_startup_screen` ë©”ì„œë“œ ë³µì›**
```python
def _clear_startup_screen(self, screen_obj):
    """ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì „ìš© ì‚­ì œ ë£¨í‹´ (ì›ë˜ ì„±ê³µí–ˆë˜ ë°©ë²•)"""
    print(f"[DEBUG] _clear_startup_screen ì‹œì‘: {screen_obj}")
    
    if screen_obj:
        try:
            print("[DEBUG] ë¹„ë™ê¸° ì‚­ì œ ì‹œì‘...")
            # ë¹„ë™ê¸° ì‚­ì œ ì‚¬ìš© (ì›ë˜ ì„±ê³µí–ˆë˜ ë°©ë²•)
            screen_obj.delete_async()
            print("[OK] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ")
            
        except Exception as e:
            print(f"[WARN] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ì‚­ì œ ì‹¤íŒ¨: {e}")
        
        # ë©”ëª¨ë¦¬ íšŒìˆ˜ëŠ” ìƒëµ (ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ì—ì„œëŠ” ë¬¸ì œ ë°œìƒ ê°€ëŠ¥)
        print("[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìƒëµ")
    else:
        print("[DEBUG] screen_objê°€ None")
```

### **ë³µì› ì´ìœ **
- ì›ë˜ ì„±ê³µí–ˆë˜ ì½”ë“œê°€ ë” ì•ˆì •ì ìœ¼ë¡œ ì‘ë™í–ˆìŒ
- `delete_async()` ë©”ì„œë“œê°€ LVGL í™˜ê²½ì—ì„œ ë” ì•ˆì „í•¨
- ë™ê¸° ì‚­ì œë³´ë‹¤ ë¹„ë™ê¸° ì‚­ì œê°€ ì‹œìŠ¤í…œ ì•ˆì •ì„±ì— ë” ì í•©í•¨

### **ì˜ˆìƒ ê²°ê³¼**
```
[INFO] StartupScreen ì „ìš© ì •ë¦¬ ì‹œì‘...
[DEBUG] screen_obj ì‚­ì œ ì‹œì‘...
[DEBUG] _clear_startup_screen ì‹œì‘: lvgl obj
[DEBUG] ë¹„ë™ê¸° ì‚­ì œ ì‹œì‘...
[OK] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ë¹„ë™ê¸° ì‚­ì œ ì™„ë£Œ
[DEBUG] ìŠ¤íƒ€íŠ¸ì—… í™”ë©´ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìƒëµ
[DEBUG] screen_obj ì‚­ì œ ì™„ë£Œ
[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì‹œì‘...
[DEBUG] screen_obj ì°¸ì¡° ì •ë¦¬ ì™„ë£Œ
[OK] StartupScreen ì „ìš© ì •ë¦¬ ì™„ë£Œ
[INFO] ì•ˆì „í•œ í™”ë©´ ì „í™˜ ì‹œì‘: wifi_scan
```

**ê²°ê³¼**: ì›ë˜ ì„±ê³µí–ˆë˜ `delete_async()` ë°©ë²•ìœ¼ë¡œ ë³µì›í•˜ì—¬ ì•ˆì •ì ì¸ í™”ë©´ ì „í™˜ì„ ë³´ì¥í•©ë‹ˆë‹¤! ğŸ‰