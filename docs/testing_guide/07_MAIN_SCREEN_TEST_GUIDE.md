# 메인 화면 테스트 가이드

> **MainScreen 테스트 및 사용법**

## 📋 개요

메인 화면은 시스템 설정이 완료된 후의 메인 대시보드 화면입니다. 현재 상태, 복용 스케줄, 알림 등을 표시하며, 사용자가 시스템을 모니터링하고 제어할 수 있는 중앙 허브 역할을 합니다.

## 🎯 주요 기능

- **시스템 상태** 표시 (Wi-Fi, 시간, 배터리 등)
- **복용 스케줄** 표시 (다음 복용 시간, 남은 시간)
- **알림 관리** (복용 알림, 시스템 알림)
- **빠른 설정** 접근
- **Modern UI 스타일** 적용
- **D버튼 조건부 재부팅** (네트워크/알약 상태에 따른 스마트 재부팅)
- **알약 개수 표시** (디스크별 알약 수량)
- **자동 배출 기능** (시간 기반 자동 알약 배출)
- **실시간 상태 업데이트** (WiFi, 시간, 알약 상태)

## 🚀 테스트 방법

### 1. 개별 화면 테스트
```bash
# 알약 충전 완료 후 자동으로 메인 화면이 표시됩니다
# 별도의 메뉴 선택이 필요하지 않습니다
```

### 2. 테스트 시나리오

1. **상태 정보 확인**
   - Wi-Fi 연결 상태 표시
   - 현재 시간 표시
   - 알약 개수 표시 (예: 13/15)
   - 시스템 상태 표시

2. **D버튼 조건부 재부팅 테스트**
   - **네트워크 연결됨 + 알약 있음**: 시간-분 설정으로 재부팅
   - **네트워크 연결됨 + 알약 없음**: 복용시간선택으로 재부팅
   - **네트워크 연결 안됨 + 알약 없음**: WiFi 스캔으로 재부팅

3. **알약 개수 표시 테스트**
   - 디스크별 알약 수량 표시
   - 선택된 디스크만 표시
   - 실시간 업데이트 확인

4. **자동 배출 기능 테스트**
   - 시간 기반 자동 알약 배출
   - 배출 완료 후 상태 업데이트
   - 알림 표시 확인

## 🔧 화면 구성 요소

### UI 요소
- **제목**: "필박스 메인"
- **상태 표시**: Wi-Fi, 시간, 배터리 상태
- **복용 정보**: 다음 복용 시간, 남은 시간
- **메뉴 옵션**: 빠른 설정, 알림, 시스템 정보
- **버튼 힌트**: "A/B: 선택, D: 실행, C: 설정"

### 상태 정보
- **Wi-Fi 상태**: 연결됨/연결 안됨
- **현재 시간**: 실시간 시간 표시
- **배터리**: 충전 상태 및 잔량
- **시스템**: 정상/오류 상태

## 📱 화면 전환

### 설정 화면으로
- **조건**: C 버튼으로 설정 접근
- **대상**: 설정 화면 (`settings`)
- **방법**: `_go_to_settings()` 호출

### 알림 화면으로
- **조건**: 알림 옵션 선택
- **대상**: 알림 화면 (`notification`)
- **방법**: `_go_to_notifications()` 호출

### 알약 배출 화면으로
- **조건**: 수동 배출 옵션 선택
- **대상**: 알약 배출 화면 (`pill_dispense`)
- **방법**: `_go_to_pill_dispense()` 호출

## 🔧 버튼 조작

### A 버튼
- **기능**: 메뉴 옵션에서 위로 이동
- **동작**: 이전 옵션 선택

### B 버튼
- **기능**: 메뉴 옵션에서 아래로 이동
- **동작**: 다음 옵션 선택

### C 버튼
- **기능**: 설정 화면으로 이동
- **동작**: 설정 화면으로 전환

### D 버튼
- **기능**: 선택한 옵션 실행
- **동작**: 선택한 메뉴 옵션 실행

## 📊 시스템 모니터링

### 실시간 업데이트
- **시간 동기화**: NTP를 통한 정확한 시간
- **Wi-Fi 상태**: 연결 상태 실시간 모니터링
- **배터리 상태**: 충전 상태 및 잔량 확인
- **복용 스케줄**: 다음 복용 시간 계산

### 알림 시스템
- **복용 알림**: 복용 시간 10분 전 알림
- **시스템 알림**: 오류, 경고, 정보 알림
- **배터리 알림**: 배터리 부족 시 알림

### 데이터 관리
- **복용 기록**: 복용 이력 저장
- **설정 저장**: 사용자 설정 영구 저장
- **통계 정보**: 복용 통계 및 분석


## 📊 성능 최적화

### 메모리 관리
- **상태 캐싱**: 자주 사용되는 상태 정보 캐싱
- **UI 요소**: 최소한의 요소만 생성
- **가비지 컬렉션**: 주기적인 메모리 정리

### 배터리 최적화
- **화면 밝기**: 자동 밝기 조절
- **업데이트 주기**: 적절한 업데이트 간격
- **절전 모드**: 사용하지 않을 때 절전

## 🔗 관련 파일

- **`screens/main_screen.py`**: 메인 화면 구현
- **`pillbox_app.py`**: 핵심 비즈니스 로직
- **`screens/settings_screen.py`**: 설정 화면
- **`screens/notification_screen.py`**: 알림 화면
- **`main.py`**: 테스트 시스템
- **`screen_manager.py`**: 화면 전환 관리

## 📝 개발 노트

### 현재 상태
- **Coming Soon**: 아직 구현되지 않은 화면
- **기본 구조**: 화면 기본 구조만 구현
- **테스트 모드**: 테스트를 위한 기본 기능

### 향후 구현 계획
- **실시간 모니터링**: 시스템 상태 실시간 표시
- **복용 스케줄**: 복용 시간 및 알림 관리
- **사용자 인터페이스**: 직관적인 메뉴 시스템
- **데이터 시각화**: 복용 통계 및 차트
